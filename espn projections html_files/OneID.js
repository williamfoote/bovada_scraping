/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={0:e=>{var t={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};e.exports&&(e.exports=t),"function"===typeof window.define&&window.define([],(function(){return t})),t.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var n,o,r,s,i,a=this._tables[0][4],c=this._tables[1],u=e.length,l=1;if(4!==u&&6!==u&&8!==u)throw new t.exception.invalid("invalid aes key size");for(this._key=[s=e.slice(0),i=[]],n=u;n<4*u+28;n++)r=s[n-1],(n%u===0||8===u&&n%u===4)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[255&r],n%u===0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),s[n]=s[n-u]^r;for(o=0;n;o++,n--)r=s[3&o?n:n-4],i[o]=n<=4||o<4?r:c[0][a[r>>>24]]^c[1][a[r>>16&255]]^c[2][a[r>>8&255]]^c[3][a[255&r]]},t.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e,t,n,o,r,s,i,a,c=this._tables[0],u=this._tables[1],l=c[4],d=u[4],E=[],_=[];for(e=0;e<256;e++)_[(E[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!l[t];t^=o||1,n=_[n]||1)for(s=(s=n^n<<1^n<<2^n<<3^n<<4)>>8^255&s^99,l[t]=s,d[s]=t,a=16843009*E[r=E[o=E[t]]]^65537*r^257*o^16843008*t,i=257*E[s]^16843008*s,e=0;e<4;e++)c[e][t]=i=i<<24^i>>>8,u[e][s]=a=a<<24^a>>>8;for(e=0;e<5;e++)c[e]=c[e].slice(0),u[e]=u[e].slice(0)},_crypt:function(e,n){if(4!==e.length)throw new t.exception.invalid("invalid aes block size");var o,r,s,i,a=this._key[n],c=e[0]^a[0],u=e[n?3:1]^a[1],l=e[2]^a[2],d=e[n?1:3]^a[3],E=a.length/4-2,_=4,p=[0,0,0,0],f=this._tables[n],h=f[0],I=f[1],A=f[2],O=f[3],g=f[4];for(i=0;i<E;i++)o=h[c>>>24]^I[u>>16&255]^A[l>>8&255]^O[255&d]^a[_],r=h[u>>>24]^I[l>>16&255]^A[d>>8&255]^O[255&c]^a[_+1],s=h[l>>>24]^I[d>>16&255]^A[c>>8&255]^O[255&u]^a[_+2],d=h[d>>>24]^I[c>>16&255]^A[u>>8&255]^O[255&l]^a[_+3],_+=4,c=o,u=r,l=s;for(i=0;i<4;i++)p[n?3&-i:i]=g[c>>>24]<<24^g[u>>16&255]<<16^g[l>>8&255]<<8^g[255&d]^a[_++],o=c,c=u,u=l,l=d,d=o;return p}},t.bitArray={bitSlice:function(e,n,o){return e=t.bitArray._shiftRight(e.slice(n/32),32-(31&n)).slice(1),void 0===o?e:t.bitArray.clamp(e,o-n)},extract:function(e,t,n){var o=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-o^e[t/32+1|0]>>>o:e[t/32|0]>>>o)&(1<<n)-1},concat:function(e,n){if(0===e.length||0===n.length)return e.concat(n);var o=e[e.length-1],r=t.bitArray.getPartial(o);return 32===r?e.concat(n):t.bitArray._shiftRight(n,r,0|o,e.slice(0,e.length-1))},bitLength:function(e){var n,o=e.length;return 0===o?0:(n=e[o-1],32*(o-1)+t.bitArray.getPartial(n))},clamp:function(e,n){if(32*e.length<n)return e;var o=(e=e.slice(0,Math.ceil(n/32))).length;return n&=31,o>0&&n&&(e[o-1]=t.bitArray.partial(n,e[o-1]&2147483648>>n-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,n){if(t.bitArray.bitLength(e)!==t.bitArray.bitLength(n))return!1;var o,r=0;for(o=0;o<e.length;o++)r|=e[o]^n[o];return 0===r},_shiftRight:function(e,n,o,r){var s,i,a;for(void 0===r&&(r=[]);n>=32;n-=32)r.push(o),o=0;if(0===n)return r.concat(e);for(s=0;s<e.length;s++)r.push(o|e[s]>>>n),o=e[s]<<32-n;return i=e.length?e[e.length-1]:0,a=t.bitArray.getPartial(i),r.push(t.bitArray.partial(n+a&31,n+a>32?o:r.pop(),1)),r},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},t.codec.utf8String={fromBits:function(e){var n,o,r="",s=t.bitArray.bitLength(e);for(n=0;n<s/8;n++)0===(3&n)&&(o=e[n/4]),r+=String.fromCharCode(o>>>24),o<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var n,o=[],r=0;for(n=0;n<e.length;n++)r=r<<8|e.charCodeAt(n),3===(3&n)&&(o.push(r),r=0);return 3&n&&o.push(t.bitArray.partial(8*(3&n),r)),o}},t.codec.hex={fromBits:function(e){var n,o="";for(n=0;n<e.length;n++)o+=(0xf00000000000+(0|e[n])).toString(16).substr(4);return o.substr(0,t.bitArray.bitLength(e)/4)},toBits:function(e){var n,o,r=[];for(o=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",n=0;n<e.length;n+=8)r.push(0^parseInt(e.substr(n,8),16));return t.bitArray.clamp(r,4*o)}},t.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,n,o){var r,s="",i=0,a=t.codec.base64._chars,c=0,u=t.bitArray.bitLength(e);for(o&&(a=a.substr(0,62)+"-_"),r=0;6*s.length<u;)s+=a.charAt((c^e[r]>>>i)>>>26),i<6?(c=e[r]<<6-i,i+=26,r++):(c<<=6,i-=6);for(;3&s.length&&!n;)s+="=";return s},toBits:function(e,n){e=e.replace(/\s|=/g,"");var o,r,s=[],i=0,a=t.codec.base64._chars,c=0;for(n&&(a=a.substr(0,62)+"-_"),o=0;o<e.length;o++){if((r=a.indexOf(e.charAt(o)))<0)throw new t.exception.invalid("this isn't base64!");i>26?(i-=26,s.push(c^r>>>i),c=r<<32-i):c^=r<<32-(i+=6)}return 56&i&&s.push(t.bitArray.partial(56&i,c,1)),s}},t.codec.base64url={fromBits:function(e){return t.codec.base64.fromBits(e,1,1)},toBits:function(e){return t.codec.base64.toBits(e,1)}},t.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},t.hash.sha256.hash=function(e){return(new t.hash.sha256).update(e).finalize()},t.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"===typeof e&&(e=t.codec.utf8String.toBits(e));var n,o=this._buffer=t.bitArray.concat(this._buffer,e),r=this._length,s=this._length=r+t.bitArray.bitLength(e);for(n=512+r&-512;n<=s;n+=512)this._block(o.splice(0,16));return this},finalize:function(){var e,n=this._buffer,o=this._h;for(e=(n=t.bitArray.concat(n,[t.bitArray.partial(1,1)])).length+2;15&e;e++)n.push(0);for(n.push(Math.floor(this._length/4294967296)),n.push(0|this._length);n.length;)this._block(n.splice(0,16));return this.reset(),o},_init:[],_key:[],_precompute:function(){var e,t=0,n=2;function o(e){return 4294967296*(e-Math.floor(e))|0}e:for(;t<64;n++){for(e=2;e*e<=n;e++)if(n%e===0)continue e;t<8&&(this._init[t]=o(Math.pow(n,.5))),this._key[t]=o(Math.pow(n,1/3)),t++}},_block:function(e){var t,n,o,r,s=e.slice(0),i=this._h,a=this._key,c=i[0],u=i[1],l=i[2],d=i[3],E=i[4],_=i[5],p=i[6],f=i[7];for(t=0;t<64;t++)t<16?n=s[t]:(o=s[t+1&15],r=s[t+14&15],n=s[15&t]=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+s[15&t]+s[t+9&15]|0),n=n+f+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(p^E&(_^p))+a[t],f=p,p=_,_=E,E=d+n|0,d=l,l=u,c=n+((u=c)&l^d&(u^l))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;i[0]=i[0]+c|0,i[1]=i[1]+u|0,i[2]=i[2]+l|0,i[3]=i[3]+d|0,i[4]=i[4]+E|0,i[5]=i[5]+_|0,i[6]=i[6]+p|0,i[7]=i[7]+f|0}},t.mode.ccm={name:"ccm",encrypt:function(e,n,o,r,s){var i,a,c=n.slice(0),u=t.bitArray,l=u.bitLength(o)/8,d=u.bitLength(c)/8;if(s=s||64,r=r||[],l<7)throw new t.exception.invalid("ccm: iv must be at least 7 bytes");for(i=2;i<4&&d>>>8*i;i++);return i<15-l&&(i=15-l),o=u.clamp(o,8*(15-i)),a=t.mode.ccm._computeTag(e,n,o,r,s,i),c=t.mode.ccm._ctrMode(e,c,o,a,s,i),u.concat(c.data,c.tag)},decrypt:function(e,n,o,r,s){s=s||64,r=r||[];var i,a,c=t.bitArray,u=c.bitLength(o)/8,l=c.bitLength(n),d=c.clamp(n,l-s),E=c.bitSlice(n,l-s);if(l=(l-s)/8,u<7)throw new t.exception.invalid("ccm: iv must be at least 7 bytes");for(i=2;i<4&&l>>>8*i;i++);if(i<15-u&&(i=15-u),o=c.clamp(o,8*(15-i)),d=t.mode.ccm._ctrMode(e,d,o,E,s,i),a=t.mode.ccm._computeTag(e,d.data,o,r,s,i),!c.equal(d.tag,a))throw new t.exception.corrupt("ccm: tag doesn't match");return d.data},_computeTag:function(e,n,o,r,s,i){var a,c,u,l=[],d=t.bitArray,E=d._xor4;if((s/=8)%2||s<4||s>16)throw new t.exception.invalid("ccm: invalid tag length");if(r.length>4294967295||n.length>4294967295)throw new t.exception.bug("ccm: can't deal with 4GiB or more data");if(a=[d.partial(8,(r.length?64:0)|s-2<<2|i-1)],(a=d.concat(a,o))[3]|=d.bitLength(n)/8,a=e.encrypt(a),r.length)for((c=d.bitLength(r)/8)<=65279?l=[d.partial(16,c)]:c<=4294967295&&(l=d.concat([d.partial(16,65534)],[c])),l=d.concat(l,r),u=0;u<l.length;u+=4)a=e.encrypt(E(a,l.slice(u,u+4).concat([0,0,0])));for(u=0;u<n.length;u+=4)a=e.encrypt(E(a,n.slice(u,u+4).concat([0,0,0])));return d.clamp(a,8*s)},_ctrMode:function(e,n,o,r,s,i){var a,c,u,l=t.bitArray,d=l._xor4,E=n.length,_=l.bitLength(n);if(u=l.concat([l.partial(8,i-1)],o).concat([0,0,0]).slice(0,4),r=l.bitSlice(d(r,e.encrypt(u)),0,s),!E)return{tag:r,data:[]};for(c=0;c<E;c+=4)u[3]++,a=e.encrypt(u),n[c]^=a[0],n[c+1]^=a[1],n[c+2]^=a[2],n[c+3]^=a[3];return{tag:r,data:l.clamp(n,_)}}},t.mode.ocb2={name:"ocb2",encrypt:function(e,n,o,r,s,i){if(128!==t.bitArray.bitLength(o))throw new t.exception.invalid("ocb iv must be 128 bits");var a,c,u,l,d=t.mode.ocb2._times2,E=t.bitArray,_=E._xor4,p=[0,0,0,0],f=d(e.encrypt(o)),h=[];for(r=r||[],s=s||64,a=0;a+4<n.length;a+=4)p=_(p,c=n.slice(a,a+4)),h=h.concat(_(f,e.encrypt(_(f,c)))),f=d(f);return c=n.slice(a),u=E.bitLength(c),l=e.encrypt(_(f,[0,0,0,u])),c=E.clamp(_(c.concat([0,0,0]),l),u),p=_(p,_(c.concat([0,0,0]),l)),p=e.encrypt(_(p,_(f,d(f)))),r.length&&(p=_(p,i?r:t.mode.ocb2.pmac(e,r))),h.concat(E.concat(c,E.clamp(p,s)))},decrypt:function(e,n,o,r,s,i){if(128!==t.bitArray.bitLength(o))throw new t.exception.invalid("ocb iv must be 128 bits");s=s||64;var a,c,u,l,d=t.mode.ocb2._times2,E=t.bitArray,_=E._xor4,p=[0,0,0,0],f=d(e.encrypt(o)),h=t.bitArray.bitLength(n)-s,I=[];for(r=r||[],a=0;a+4<h/32;a+=4)c=_(f,e.decrypt(_(f,n.slice(a,a+4)))),p=_(p,c),I=I.concat(c),f=d(f);if(u=h-32*a,l=e.encrypt(_(f,[0,0,0,u])),c=_(l,E.clamp(n.slice(a),u).concat([0,0,0])),p=_(p,c),p=e.encrypt(_(p,_(f,d(f)))),r.length&&(p=_(p,i?r:t.mode.ocb2.pmac(e,r))),!E.equal(E.clamp(p,s),E.bitSlice(n,h)))throw new t.exception.corrupt("ocb: tag doesn't match");return I.concat(E.clamp(c,u))},pmac:function(e,n){var o,r,s=t.mode.ocb2._times2,i=t.bitArray,a=i._xor4,c=[0,0,0,0],u=e.encrypt([0,0,0,0]);for(u=a(u,s(s(u))),o=0;o+4<n.length;o+=4)u=s(u),c=a(c,e.encrypt(a(u,n.slice(o,o+4))));return r=n.slice(o),i.bitLength(r)<128&&(u=a(u,s(u)),r=i.concat(r,[-2147483648,0,0,0])),c=a(c,r),e.encrypt(a(s(a(u,s(u))),c))},_times2:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},t.mode.gcm={name:"gcm",encrypt:function(e,n,o,r,s){var i,a=n.slice(0),c=t.bitArray;return s=s||128,r=r||[],i=t.mode.gcm._ctrMode(!0,e,a,r,o,s),c.concat(i.data,i.tag)},decrypt:function(e,n,o,r,s){var i,a,c=n.slice(0),u=t.bitArray,l=u.bitLength(c);if(r=r||[],(s=s||128)<=l?(a=u.bitSlice(c,l-s),c=u.bitSlice(c,0,l-s)):(a=c,c=[]),i=t.mode.gcm._ctrMode(!1,e,c,r,o,s),!u.equal(i.tag,a))throw new t.exception.corrupt("gcm: tag doesn't match");return i.data},_galoisMultiply:function(e,n){var o,r,s,i,a,c=t.bitArray._xor4;for(s=[0,0,0,0],i=n.slice(0),o=0;o<128;o++){for(0!==(e[Math.floor(o/32)]&1<<31-o%32)&&(s=c(s,i)),a=0!==(1&i[3]),r=3;r>0;r--)i[r]=i[r]>>>1|(1&i[r-1])<<31;i[0]=i[0]>>>1,a&&(i[0]=i[0]^225<<24)}return s},_ghash:function(e,n,o){var r,s,i=o.length;for(r=n.slice(0),s=0;s<i;s+=4)r[0]^=4294967295&o[s],r[1]^=4294967295&o[s+1],r[2]^=4294967295&o[s+2],r[3]^=4294967295&o[s+3],r=t.mode.gcm._galoisMultiply(r,e);return r},_ctrMode:function(e,n,o,r,s,i){var a,c,u,l,d,E,_,p,f,h,I,A,O=t.bitArray;for(f=o.length,h=O.bitLength(o),I=O.bitLength(r),A=O.bitLength(s),a=n.encrypt([0,0,0,0]),96===A?(c=s.slice(0),c=O.concat(c,[1])):(c=t.mode.gcm._ghash(a,[0,0,0,0],s),c=t.mode.gcm._ghash(a,c,[0,0,Math.floor(A/4294967296),4294967295&A])),u=t.mode.gcm._ghash(a,[0,0,0,0],r),E=c.slice(0),_=u.slice(0),e||(_=t.mode.gcm._ghash(a,u,o)),d=0;d<f;d+=4)E[3]++,l=n.encrypt(E),o[d]^=l[0],o[d+1]^=l[1],o[d+2]^=l[2],o[d+3]^=l[3];return o=O.clamp(o,h),e&&(_=t.mode.gcm._ghash(a,u,o)),p=[Math.floor(I/4294967296),4294967295&I,Math.floor(h/4294967296),4294967295&h],_=t.mode.gcm._ghash(a,_,p),l=n.encrypt(c),_[0]^=l[0],_[1]^=l[1],_[2]^=l[2],_[3]^=l[3],{tag:O.bitSlice(_,0,i),data:o}}},t.misc.hmac=function(e,n){this._hash=n=n||t.hash.sha256;var o,r=[[],[]],s=n.prototype.blockSize/32;for(this._baseHash=[new n,new n],e.length>s&&(e=n.hash(e)),o=0;o<s;o++)r[0][o]=909522486^e[o],r[1][o]=1549556828^e[o];this._baseHash[0].update(r[0]),this._baseHash[1].update(r[1]),this._resultHash=new n(this._baseHash[0])},t.misc.hmac.prototype.encrypt=t.misc.hmac.prototype.mac=function(e){if(this._updated)throw new t.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)},t.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},t.misc.hmac.prototype.update=function(e){this._updated=!0,this._resultHash.update(e)},t.misc.hmac.prototype.digest=function(){var e=this._resultHash.finalize(),t=new this._hash(this._baseHash[1]).update(e).finalize();return this.reset(),t},t.misc.pbkdf2=function(e,n,o,r,s){if(o=o||1e3,r<0||o<0)throw t.exception.invalid("invalid params to pbkdf2");"string"===typeof e&&(e=t.codec.utf8String.toBits(e)),"string"===typeof n&&(n=t.codec.utf8String.toBits(n));var i,a,c,u,l,d=new(s=s||t.misc.hmac)(e),E=[],_=t.bitArray;for(l=1;32*E.length<(r||1);l++){for(i=a=d.encrypt(_.concat(n,[l])),c=1;c<o;c++)for(a=d.encrypt(a),u=0;u<a.length;u++)i[u]^=a[u];E=E.concat(i)}return r&&(E=_.clamp(E,r)),E},t.prng=function(e){this._pools=[new t.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},t.prng.prototype={randomWords:function(e,n){var o,r,s=[],i=this.isReady(n);if(i===this._NOT_READY)throw new t.exception.notReady("generator isn't seeded");for(i&this._REQUIRES_RESEED&&this._reseedFromPools(!(i&this._READY)),o=0;o<e;o+=4)(o+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),r=this._gen4words(),s.push(r[0],r[1],r[2],r[3]);return this._gate(),s.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=e},addEntropy:function(e,n,o){o=o||"user";var r,s,i,a,c=(new Date).valueOf(),u=this._robins[o],l=this.isReady(),d=0;switch(void 0===(r=this._collectorIds[o])&&(r=this._collectorIds[o]=this._collectorIdNext++),void 0===u&&(u=this._robins[o]=0),this._robins[o]=(this._robins[o]+1)%this._pools.length,typeof e){case"number":void 0===n&&(n=1),this._pools[u].update([r,this._eventId++,1,n,c,1,0|e]);break;case"object":if("[object Uint32Array]"===(a=Object.prototype.toString.call(e))){for(i=[],s=0;s<e.length;s++)i.push(e[s]);e=i}else for("[object Array]"!==a&&(d=1),s=0;s<e.length&&!d;s++)"number"!==typeof e[s]&&(d=1);if(!d){if(void 0===n)for(n=0,s=0;s<e.length;s++)for(i=e[s];i>0;)n++,i>>>=1;this._pools[u].update([r,this._eventId++,2,n,c,e.length].concat(e))}break;case"string":void 0===n&&(n=e.length),this._pools[u].update([r,this._eventId++,3,n,c,e.length]),this._pools[u].update(e);break;default:d=1}if(d)throw new t.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[u]+=n,this._poolStrength+=n,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[void 0!==e?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e||this._defaultParanoia];return this._strength>=t||this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new t.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,o,r=this._callbacks[e],s=[];for(o in r)r.hasOwnProperty(o)&&r[o]===t&&s.push(o);for(n=0;n<s.length;n++)delete r[o=s[n]]},_bind:function(e){var t=this;return function(){e.apply(t,arguments)}},_gen4words:function(){for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new t.cipher.aes(this._key)},_reseed:function(e){this._key=t.hash.sha256.hash(this._key.concat(e)),this._cipher=new t.cipher.aes(this._key);for(var n=0;n<4&&(this._counter[n]=this._counter[n]+1|0,!this._counter[n]);n++);},_reseedFromPools:function(e){var n,o=[],r=0;for(this._nextReseed=o[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,n=0;n<16;n++)o.push(4294967296*Math.random()|0);for(n=0;n<this._pools.length&&(o=o.concat(this._pools[n].finalize()),r+=this._poolEntropy[n],this._poolEntropy[n]=0,e||!(this._reseedCount&1<<n));n++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new t.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(o)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(e){var n,o;try{n=e.x||e.clientX||e.offsetX||0,o=e.y||e.clientY||e.offsetY||0}catch(e){n=0,o=0}0!=n&&0!=o&&t.random.addEntropy([n,o],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(e){var n=e.touches[0]||e.changedTouches[0],o=n.pageX||n.clientX,r=n.pageY||n.clientY;t.random.addEntropy([o,r],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(e){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?t.random.addEntropy(window.performance.now(),e,"loadtime"):t.random.addEntropy((new Date).valueOf(),e,"loadtime")},_accelerometerCollector:function(e){var n=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var o=window.orientation;"number"===typeof o&&t.random.addEntropy(o,1,"accelerometer")}n&&t.random.addEntropy(n,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(e,n){var o,r=t.random._callbacks[e],s=[];for(o in r)r.hasOwnProperty(o)&&s.push(r[o]);for(o=0;o<s.length;o++)s[o](n)}},t.random=new t.prng(6),function(){try{var n,o,r;if(e.exports&&(o=null)&&o.randomBytes)n=o.randomBytes(128),n=new Uint32Array(new Uint8Array(n).buffer),t.random.addEntropy(n,1024,"crypto.randomBytes");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){if(r=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(r);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(r)}t.random.addEntropy(r,1024,"crypto.getRandomValues")}}catch(e){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}}(),t.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(e,n,o,r){o=o||{},r=r||{};var s,i,a,c=t.json,u=c._add({iv:t.random.randomWords(4,0)},c.defaults);if(c._add(u,o),a=u.adata,"string"===typeof u.salt&&(u.salt=t.codec.base64.toBits(u.salt)),"string"===typeof u.iv&&(u.iv=t.codec.base64.toBits(u.iv)),!t.mode[u.mode]||!t.cipher[u.cipher]||"string"===typeof e&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||u.iv.length<2||u.iv.length>4)throw new t.exception.invalid("json encrypt: invalid parameters");return"string"===typeof e?(e=(s=t.misc.cachedPbkdf2(e,u)).key.slice(0,u.ks/32),u.salt=s.salt):t.ecc&&e instanceof t.ecc.elGamal.publicKey&&(s=e.kem(),u.kemtag=s.tag,e=s.key.slice(0,u.ks/32)),"string"===typeof n&&(n=t.codec.utf8String.toBits(n)),"string"===typeof a&&(u.adata=a=t.codec.utf8String.toBits(a)),i=new t.cipher[u.cipher](e),c._add(r,u),r.key=e,u.ct=t.mode[u.mode].encrypt(i,n,u.iv,a,u.ts),u},encrypt:function(e,n,o,r){if(e&&n){var s=t.json,i=s._encrypt.apply(s,arguments);return s.encode(i)}},_decrypt:function(e,n,o,r){o=o||{},r=r||{};var s,i,a,c=t.json,u=c._add(c._add(c._add({},c.defaults),n),o,!0),l=u.adata;if("string"===typeof u.salt&&(u.salt=t.codec.base64.toBits(u.salt)),"string"===typeof u.iv&&(u.iv=t.codec.base64.toBits(u.iv)),!t.mode[u.mode]||!t.cipher[u.cipher]||"string"===typeof e&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||!u.iv||u.iv.length<2||u.iv.length>4)throw new t.exception.invalid("json decrypt: invalid parameters");return"string"===typeof e?(e=(i=t.misc.cachedPbkdf2(e,u)).key.slice(0,u.ks/32),u.salt=i.salt):t.ecc&&e instanceof t.ecc.elGamal.secretKey&&(e=e.unkem(t.codec.base64.toBits(u.kemtag)).slice(0,u.ks/32)),"string"===typeof l&&(l=t.codec.utf8String.toBits(l)),a=new t.cipher[u.cipher](e),s=t.mode[u.mode].decrypt(a,u.ct,u.iv,l,u.ts),c._add(r,u),r.key=e,1===o.raw?s:t.codec.utf8String.fromBits(s)},decrypt:function(e,n,o,r){if(e&&n){var s=t.json;return s._decrypt(e,s.decode(n),o,r)}},encode:function(e){var n,o="{",r="";for(n in e)if(e.hasOwnProperty(n)){if(!n.match(/^[a-z0-9]+$/i))throw new t.exception.invalid("json encode: invalid property name");switch(o+=r+'"'+n+'":',r=",",typeof e[n]){case"number":case"boolean":o+=e[n];break;case"string":o+='"'+escape(e[n])+'"';break;case"object":o+='"'+t.codec.base64.fromBits(e[n],0)+'"';break;default:throw new t.exception.bug("json encode: unsupported type")}}return o+"}"},decode:function(e){if(!(e=e.replace(/\s/g,"")).match(/^\{.*\}$/))throw new t.exception.invalid("json decode: this isn't json!");var n,o,r=e.replace(/^\{|\}$/g,"").split(/,/),s={};for(n=0;n<r.length;n++){if(!(o=r[n].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new t.exception.invalid("json decode: this isn't json!");o[3]?s[o[2]]=parseInt(o[3],10):o[4]?s[o[2]]=o[2].match(/^(ct|adata|salt|iv)$/)?t.codec.base64.toBits(o[4]):unescape(o[4]):o[5]&&(s[o[2]]="true"===o[5])}return s},_add:function(e,n,o){if(void 0===e&&(e={}),void 0===n)return e;var r;for(r in n)if(n.hasOwnProperty(r)){if(o&&void 0!==e[r]&&e[r]!==n[r])throw new t.exception.invalid("required parameter overridden");e[r]=n[r]}return e},_subtract:function(e,t){var n,o={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(o[n]=e[n]);return o},_filter:function(e,t){var n,o={};for(n=0;n<t.length;n++)void 0!==e[t[n]]&&(o[t[n]]=e[t[n]]);return o}},t.encrypt=t.json.encrypt,t.decrypt=t.json.decrypt,t.misc._pbkdf2Cache={},t.misc.cachedPbkdf2=function(e,n){var o,r,s,i,a=t.misc._pbkdf2Cache;return i=(n=n||{}).iter||1e3,(o=(r=a[e]=a[e]||{})[i]=r[i]||{firstSalt:n.salt&&n.salt.length?n.salt.slice(0):t.random.randomWords(2,0)})[s=void 0===n.salt?o.firstSalt:n.salt]=o[s]||t.misc.pbkdf2(e,s,n.iter),{key:o[s].slice(0),salt:s.slice(0)}}},698:(e,t,n)=>{"use strict";n.d(t,{tV:()=>I,h$:()=>A,uP:()=>O,d9:()=>l,kn:()=>f,_A:()=>u,U2:()=>d,hK:()=>c,KT:()=>p,kH:()=>g,Cd:()=>T,m8:()=>R,t8:()=>h,Vj:()=>E});var o=n(742);function r(){}function s(){}function i(e,t){let n;t=t||1/0;const{length:o}=e;let r=null;const s=[];let i=0;for(;i<o;i++){if(n=e.charCodeAt(i),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===o){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&((t-=3)>-1&&s.push(239,191,189),r=null);if(n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<2097152))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function a(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function c(e){if("string"===typeof e)return e.replace(/_/g,"-").toLowerCase()}function u(e){return null===e||"object"!==typeof e?e:(Object.keys(e).forEach((t=>{null!==e[t]&&"object"===typeof e[t]&&(e[t]=u(e[t]))})),Object.isFrozen(e)?e:Object.freeze(e))}function l(e){let t;if(null===e||"object"!==typeof e)return e;if("[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());try{t=new e.constructor}catch(e){return}return Object.keys(e).forEach((n=>{t[n]=l(e[n])})),t}function d(e,t,n){const o=t.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:void 0),e);return o&&n?o[n]:o}function E(){return`${_()}${_()}-${_()}-${_("4")}-${_((Math.floor(10*Math.random())%4+8).toString(16))}-${_()}${_()}${_()}`}function _(e){let t=Math.floor(65535*Math.random()).toString(16);for(let e=4-t.length;e>0;e--)t=`0${t}`;return e=`${e}`.substring(0,4),!Number.isNaN(parseInt(e,16))&&e.length?e+t.substr(e.length):t}function p(e=""){const t=e.match(/[^.]+(?:\.com?(?:\.[a-z]{2})?|(?:\.[a-z]+))?$/i);if(t&&t.length)return t[0].replace(/:[0-9]+$/,"")}function f(e=""){if("string"!==typeof e)return 0;let t=-1;const n=function(){const e=new Array(256);for(let t=0;t<e.length;t++){let n=t;for(let e=0;e<8;e++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n>>>0}return e}();for(let o=0;o<e.length;o++)t=t>>>8^n[255&(t^e.charCodeAt(o))];return(-1^t)>>>0}function h(e,t,n){let o,r;for("string"===typeof t&&(t=t.split(".")),o=0,r=t.length-1;o<r;o++)"undefined"!==typeof e[t[o]]&&null!==e[t[o]]||(e[t[o]]={}),e=e[t[o]];return e[t[r]]=n,e}function I(e){const t=o.b$(e);return new s("utf-8").decode(t)}function A(e){const t=new r("utf-8").encode(e);return o.JQ(t)}function O(e){if(null!==e&&"object"===typeof e&&0!==Object.keys(e).length)return btoa(JSON.stringify(e))}function g(e){return("string"===typeof e||e instanceof String)&&/^([a-zA-Z\d]|-|_)+$/.test(e)}function T(e,t){return e.length<=t?e:`...${e.substring(e.length-t)}`}function R(e){return e.reduce(((e,[t,n])=>(e[t]=n,e)),{})}r.prototype.encode=function(e){return"undefined"===typeof Uint8Array?i(e):new Uint8Array(i(e))},s.prototype.decode=function(e){return function(e,t,n){let o="",r="";n=Math.min(e.length,n||1/0);for(let s=t=t||0;s<n;s++)e[s]<=127?(o+=a(r)+String.fromCharCode(e[s]),r=""):r+=`%${e[s].toString(16)}`;return o+a(r)}(e,0,e.length)}},742:(e,t)=>{"use strict";t.b$=function(e){var t,n,s=c(e),i=s[0],a=s[1],u=new r(function(e,t,n){return 3*(t+n)/4-n}(0,i,a)),l=0,d=a>0?i-4:i;for(n=0;n<d;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.JQ=function(e){for(var t,o=e.length,r=o%3,s=[],i=16383,a=0,c=o-r;a<c;a+=i)s.push(u(e,a,a+i>c?c:a+i));1===r?(t=e[o-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[o-2]<<8)+e[o-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],o=[],r="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=s.length;i<a;++i)n[i]=s[i],o[s.charCodeAt(i)]=i;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,o){for(var r,s,i=[],a=t;a<o;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(n[(s=r)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return i.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},961:(e,t,n)=>{var o,r=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function r(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var s={compressToBase64:function(e){if(null==e)return"";var n=s._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:s._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":s._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:s._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=s.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;o<r;o++){var i=t.charCodeAt(o);n[2*o]=i>>>8,n[2*o+1]=i%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return s.decompress(t);for(var n=new Array(t.length/2),o=0,r=n.length;o<r;o++)n[o]=256*t[2*o]+t[2*o+1];var i=[];return n.forEach((function(t){i.push(e(t))})),s.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":s._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),s._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return s._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var o,r,s,i={},a={},c="",u="",l="",d=2,E=3,_=2,p=[],f=0,h=0;for(s=0;s<e.length;s+=1)if(c=e.charAt(s),Object.prototype.hasOwnProperty.call(i,c)||(i[c]=E++,a[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(i,u))l=u;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(o=0;o<_;o++)f<<=1,h==t-1?(h=0,p.push(n(f)),f=0):h++;for(r=l.charCodeAt(0),o=0;o<8;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1}else{for(r=1,o=0;o<_;o++)f=f<<1|r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r=0;for(r=l.charCodeAt(0),o=0;o<16;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1}0==--d&&(d=Math.pow(2,_),_++),delete a[l]}else for(r=i[l],o=0;o<_;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1;0==--d&&(d=Math.pow(2,_),_++),i[u]=E++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(o=0;o<_;o++)f<<=1,h==t-1?(h=0,p.push(n(f)),f=0):h++;for(r=l.charCodeAt(0),o=0;o<8;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1}else{for(r=1,o=0;o<_;o++)f=f<<1|r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r=0;for(r=l.charCodeAt(0),o=0;o<16;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1}0==--d&&(d=Math.pow(2,_),_++),delete a[l]}else for(r=i[l],o=0;o<_;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1;0==--d&&(d=Math.pow(2,_),_++)}for(r=2,o=0;o<_;o++)f=f<<1|1&r,h==t-1?(h=0,p.push(n(f)),f=0):h++,r>>=1;for(;;){if(f<<=1,h==t-1){p.push(n(f));break}h++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:s._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,o){var r,s,i,a,c,u,l,d=[],E=4,_=4,p=3,f="",h=[],I={val:o(0),position:n,index:1};for(r=0;r<3;r+=1)d[r]=r;for(i=0,c=Math.pow(2,2),u=1;u!=c;)a=I.val&I.position,I.position>>=1,0==I.position&&(I.position=n,I.val=o(I.index++)),i|=(a>0?1:0)*u,u<<=1;switch(i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)a=I.val&I.position,I.position>>=1,0==I.position&&(I.position=n,I.val=o(I.index++)),i|=(a>0?1:0)*u,u<<=1;l=e(i);break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)a=I.val&I.position,I.position>>=1,0==I.position&&(I.position=n,I.val=o(I.index++)),i|=(a>0?1:0)*u,u<<=1;l=e(i);break;case 2:return""}for(d[3]=l,s=l,h.push(l);;){if(I.index>t)return"";for(i=0,c=Math.pow(2,p),u=1;u!=c;)a=I.val&I.position,I.position>>=1,0==I.position&&(I.position=n,I.val=o(I.index++)),i|=(a>0?1:0)*u,u<<=1;switch(l=i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)a=I.val&I.position,I.position>>=1,0==I.position&&(I.position=n,I.val=o(I.index++)),i|=(a>0?1:0)*u,u<<=1;d[_++]=e(i),l=_-1,E--;break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)a=I.val&I.position,I.position>>=1,0==I.position&&(I.position=n,I.val=o(I.index++)),i|=(a>0?1:0)*u,u<<=1;d[_++]=e(i),l=_-1,E--;break;case 2:return h.join("")}if(0==E&&(E=Math.pow(2,p),p++),d[l])f=d[l];else{if(l!==_)return null;f=s+s.charAt(0)}h.push(f),d[_++]=s+f.charAt(0),s=f,0==--E&&(E=Math.pow(2,p),p++)}}};return s}();void 0===(o=function(){return r}.call(t,n,t,e))||(e.exports=o)},486:e=>{!function(t){"use strict";"function"===typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(t){e=!!t.stack}var t,n=T(),o=function(){},r=function(){var e={task:void 0,next:null},t=e,n=!1,o=void 0,s=!1,i=[];function a(){for(var t,o;e.next;)t=(e=e.next).task,e.task=void 0,(o=e.domain)&&(e.domain=void 0,o.enter()),c(t,o);for(;i.length;)c(t=i.pop());n=!1}function c(e,t){try{e()}catch(e){if(s)throw t&&t.exit(),setTimeout(a,0),t&&t.enter(),e;setTimeout((function(){throw e}),0)}t&&t.exit()}if(r=function(e){t=t.next={task:e,domain:s&&process.domain,next:null},n||(n=!0,o())},"object"===typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,o=function(){process.nextTick(a)};else if("function"===typeof setImmediate)o="undefined"!==typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!==typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){o=l,u.port1.onmessage=a,a()};var l=function(){u.port2.postMessage(0)};o=function(){setTimeout(a,0),l()}}else o=function(){setTimeout(a,0)};return r.runAfter=function(e){i.push(e),n||(n=!0,o())},r}(),s=Function.call;function i(e){return function(){return s.apply(e,arguments)}}var a,c=i(Array.prototype.slice),u=i(Array.prototype.reduce||function(e,t){var n=0,o=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=o)throw new TypeError}for(;n<o;n++)n in this&&(t=e(t,this[n],n));return t}),l=i(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),d=i(Array.prototype.map||function(e,t){var n=this,o=[];return u(n,(function(r,s,i){o.push(e.call(t,s,i,n))}),void 0),o}),E=Object.create||function(e){function t(){}return t.prototype=e,new t},_=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},p=i(Object.prototype.hasOwnProperty),f=Object.keys||function(e){var t=[];for(var n in e)p(e,n)&&t.push(n);return t},h=i(Object.prototype.toString);a="undefined"!==typeof ReturnValue?ReturnValue:function(e){this.value=e};function I(t,n){if(e&&n.stack&&"object"===typeof t&&null!==t&&t.stack){for(var o=[],r=n;r;r=r.source)r.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>r.stackCounter)&&(_(t,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),o.unshift(r.stack));o.unshift(t.stack);var s=function(e){for(var t=e.split("\n"),n=[],o=0;o<t.length;++o){var r=t[o];g(r)||A(r)||!r||n.push(r)}return n.join("\n")}(o.join("\nFrom previous event:\n"));_(t,"stack",{value:s,configurable:!0})}}function A(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function O(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var o=/.*@(.+):(\d+)$/.exec(e);return o?[o[1],Number(o[2])]:void 0}function g(e){var o=O(e);if(!o)return!1;var r=o[0],s=o[1];return r===t&&s>=n&&s<=q}function T(){if(e)try{throw new Error}catch(e){var n=e.stack.split("\n"),o=O(n[0].indexOf("@")>0?n[1]:n[2]);if(!o)return;return t=o[0],o[1]}}function R(e){return e instanceof C?e:D(e)?function(e){var t=m();return R.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}})),t.promise}(e):B(e)}R.resolve=R,R.nextTick=r,R.longStackSupport=!1;var N=1;function m(){var t,n=[],o=[],r=E(m.prototype),s=E(C.prototype);if(s.promiseDispatch=function(e,r,s){var i=c(arguments);n?(n.push(i),"when"===r&&s[1]&&o.push(s[1])):R.nextTick((function(){t.promiseDispatch.apply(t,i)}))},s.valueOf=function(){if(n)return s;var e=w(t);return P(e)&&(t=e),e},s.inspect=function(){return t?t.inspect():{state:"pending"}},R.longStackSupport&&e)try{throw new Error}catch(e){s.stack=e.stack.substring(e.stack.indexOf("\n")+1),s.stackCounter=N++}function i(r){t=r,R.longStackSupport&&e&&(s.source=r),u(n,(function(e,t){R.nextTick((function(){r.promiseDispatch.apply(r,t)}))}),void 0),n=void 0,o=void 0}return r.promise=s,r.resolve=function(e){t||i(R(e))},r.fulfill=function(e){t||i(B(e))},r.reject=function(e){t||i(x(e))},r.notify=function(e){t||u(o,(function(t,n){R.nextTick((function(){n(e)}))}),void 0)},r}function S(e){if("function"!==typeof e)throw new TypeError("resolver must be a function.");var t=m();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function y(e){return S((function(t,n){for(var o=0,r=e.length;o<r;o++)R(e[o]).then(t,n)}))}function C(e,t,n){void 0===t&&(t=function(e){return x(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var o=E(C.prototype);if(o.promiseDispatch=function(n,r,s){var i;try{i=e[r]?e[r].apply(o,s):t.call(o,r,s)}catch(e){i=x(e)}n&&n(i)},o.inspect=n,n){var r=n();"rejected"===r.state&&(o.exception=r.reason),o.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?o:e.value}}return o}function L(e,t,n,o){return R(e).then(t,n,o)}function w(e){if(P(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function P(e){return e instanceof C}function D(e){return(t=e)===Object(t)&&"function"===typeof e.then;var t}"object"===typeof process&&process&&process.env&&process.env.Q_DEBUG&&(R.longStackSupport=!0),R.defer=m,m.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(c(arguments,1)):e.resolve(n)}},R.Promise=S,R.promise=S,S.race=y,S.all=K,S.reject=x,S.resolve=R,R.passByCopy=function(e){return e},C.prototype.passByCopy=function(){return this},R.join=function(e,t){return R(e).join(t)},C.prototype.join=function(e){return R([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)}))},R.race=y,C.prototype.race=function(){return this.then(R.race)},R.makePromise=C,C.prototype.toString=function(){return"[object Promise]"},C.prototype.then=function(e,t,n){var o=this,r=m(),s=!1;return R.nextTick((function(){o.promiseDispatch((function(t){s||(s=!0,r.resolve(function(t){try{return"function"===typeof e?e(t):t}catch(e){return x(e)}}(t)))}),"when",[function(e){s||(s=!0,r.resolve(function(e){if("function"===typeof t){I(e,o);try{return t(e)}catch(e){return x(e)}}return x(e)}(e)))}])})),o.promiseDispatch(void 0,"when",[void 0,function(e){var t,o=!1;try{t=function(e){return"function"===typeof n?n(e):e}(e)}catch(e){if(o=!0,!R.onerror)throw e;R.onerror(e)}o||r.notify(t)}]),r.promise},R.tap=function(e,t){return R(e).tap(t)},C.prototype.tap=function(e){return e=R(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},R.when=L,C.prototype.thenResolve=function(e){return this.then((function(){return e}))},R.thenResolve=function(e,t){return R(e).thenResolve(t)},C.prototype.thenReject=function(e){return this.then((function(){throw e}))},R.thenReject=function(e,t){return R(e).thenReject(t)},R.nearer=w,R.isPromise=P,R.isPromiseAlike=D,R.isPending=function(e){return P(e)&&"pending"===e.inspect().state},C.prototype.isPending=function(){return"pending"===this.inspect().state},R.isFulfilled=function(e){return!P(e)||"fulfilled"===e.inspect().state},C.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},R.isRejected=function(e){return P(e)&&"rejected"===e.inspect().state},C.prototype.isRejected=function(){return"rejected"===this.inspect().state};var v,U,k,b=[],G=[],M=[],V=!0;function F(){b.length=0,G.length=0,V||(V=!0)}function x(e){var t=C({when:function(t){return t&&function(e){if(V){var t=l(G,e);-1!==t&&("object"===typeof process&&"function"===typeof process.emit&&R.nextTick.runAfter((function(){var n=l(M,e);-1!==n&&(process.emit("rejectionHandled",b[t],e),M.splice(n,1))})),G.splice(t,1),b.splice(t,1))}}(this),t?t(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,t){V&&("object"===typeof process&&"function"===typeof process.emit&&R.nextTick.runAfter((function(){-1!==l(G,e)&&(process.emit("unhandledRejection",t,e),M.push(e))})),G.push(e),t&&"undefined"!==typeof t.stack?b.push(t.stack):b.push("(no stack) "+t))}(t,e),t}function B(e){return C({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return f(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function $(e,t,n){return R(e).spread(t,n)}function j(e,t,n){return R(e).dispatch(t,n)}function K(e){return L(e,(function(e){var t=0,n=m();return u(e,(function(o,r,s){var i;P(r)&&"fulfilled"===(i=r.inspect()).state?e[s]=i.value:(++t,L(r,(function(o){e[s]=o,0===--t&&n.resolve(e)}),n.reject,(function(e){n.notify({index:s,value:e})})))}),void 0),0===t&&n.resolve(e),n.promise}))}function H(e){if(0===e.length)return R.resolve();var t=R.defer(),n=0;return u(e,(function(o,r,s){var i=e[s];n++,L(i,(function(e){t.resolve(e)}),(function(e){if(0===--n){var o=e||new Error(""+e);o.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+o.message,t.reject(o)}}),(function(e){t.notify({index:s,value:e})}))}),void 0),t.promise}function W(e){return L(e,(function(e){return e=d(e,R),L(K(d(e,(function(e){return L(e,o,o)}))),(function(){return e}))}))}R.resetUnhandledRejections=F,R.getUnhandledReasons=function(){return b.slice()},R.stopUnhandledRejectionTracking=function(){F(),V=!1},F(),R.reject=x,R.fulfill=B,R.master=function(e){return C({isDef:function(){}},(function(t,n){return j(e,t,n)}),(function(){return R(e).inspect()}))},R.spread=$,C.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},R.async=function(e){return function(){function t(e,t){var s;if("undefined"===typeof StopIteration){try{s=n[e](t)}catch(e){return x(e)}return s.done?R(s.value):L(s.value,o,r)}try{s=n[e](t)}catch(e){return function(e){return"[object StopIteration]"===h(e)||e instanceof a}(e)?R(e.value):x(e)}return L(s,o,r)}var n=e.apply(this,arguments),o=t.bind(t,"next"),r=t.bind(t,"throw");return o()}},R.spawn=function(e){R.done(R.async(e)())},R.return=function(e){throw new a(e)},R.promised=function(e){return function(){return $([this,K(arguments)],(function(t,n){return e.apply(t,n)}))}},R.dispatch=j,C.prototype.dispatch=function(e,t){var n=this,o=m();return R.nextTick((function(){n.promiseDispatch(o.resolve,e,t)})),o.promise},R.get=function(e,t){return R(e).dispatch("get",[t])},C.prototype.get=function(e){return this.dispatch("get",[e])},R.set=function(e,t,n){return R(e).dispatch("set",[t,n])},C.prototype.set=function(e,t){return this.dispatch("set",[e,t])},R.del=R.delete=function(e,t){return R(e).dispatch("delete",[t])},C.prototype.del=C.prototype.delete=function(e){return this.dispatch("delete",[e])},R.mapply=R.post=function(e,t,n){return R(e).dispatch("post",[t,n])},C.prototype.mapply=C.prototype.post=function(e,t){return this.dispatch("post",[e,t])},R.send=R.mcall=R.invoke=function(e,t){return R(e).dispatch("post",[t,c(arguments,2)])},C.prototype.send=C.prototype.mcall=C.prototype.invoke=function(e){return this.dispatch("post",[e,c(arguments,1)])},R.fapply=function(e,t){return R(e).dispatch("apply",[void 0,t])},C.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},R.try=R.fcall=function(e){return R(e).dispatch("apply",[void 0,c(arguments,1)])},C.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},R.fbind=function(e){var t=R(e),n=c(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(c(arguments))])}},C.prototype.fbind=function(){var e=this,t=c(arguments);return function(){return e.dispatch("apply",[this,t.concat(c(arguments))])}},R.keys=function(e){return R(e).dispatch("keys",[])},C.prototype.keys=function(){return this.dispatch("keys",[])},R.all=K,C.prototype.all=function(){return K(this)},R.any=H,C.prototype.any=function(){return H(this)},R.allResolved=(v=W,U="allResolved",k="allSettled",function(){return"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(U+" is deprecated, use "+k+" instead.",new Error("").stack),v.apply(v,arguments)}),C.prototype.allResolved=function(){return W(this)},R.allSettled=function(e){return R(e).allSettled()},C.prototype.allSettled=function(){return this.then((function(e){return K(d(e,(function(e){function t(){return e.inspect()}return(e=R(e)).then(t,t)})))}))},R.fail=R.catch=function(e,t){return R(e).then(void 0,t)},C.prototype.fail=C.prototype.catch=function(e){return this.then(void 0,e)},R.progress=function(e,t){return R(e).then(void 0,void 0,t)},C.prototype.progress=function(e){return this.then(void 0,void 0,e)},R.fin=R.finally=function(e,t){return R(e).finally(t)},C.prototype.fin=C.prototype.finally=function(e){if(!e||"function"!==typeof e.apply)throw new Error("Q can't apply finally callback");return e=R(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},R.done=function(e,t,n,o){return R(e).done(t,n,o)},C.prototype.done=function(e,t,n){var o=function(e){R.nextTick((function(){if(I(e,r),!R.onerror)throw e;R.onerror(e)}))},r=e||t||n?this.then(e,t,n):this;"object"===typeof process&&process&&process.domain&&(o=process.domain.bind(o)),r.then(void 0,o)},R.timeout=function(e,t,n){return R(e).timeout(t,n)},C.prototype.timeout=function(e,t){var n=m(),o=setTimeout((function(){t&&"string"!==typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),n.reject(t)}),e);return this.then((function(e){clearTimeout(o),n.resolve(e)}),(function(e){clearTimeout(o),n.reject(e)}),n.notify),n.promise},R.delay=function(e,t){return void 0===t&&(t=e,e=void 0),R(e).delay(t)},C.prototype.delay=function(e){return this.then((function(t){var n=m();return setTimeout((function(){n.resolve(t)}),e),n.promise}))},R.nfapply=function(e,t){return R(e).nfapply(t)},C.prototype.nfapply=function(e){var t=m(),n=c(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},R.nfcall=function(e){var t=c(arguments,1);return R(e).nfapply(t)},C.prototype.nfcall=function(){var e=c(arguments),t=m();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},R.nfbind=R.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=c(arguments,1);return function(){var n=t.concat(c(arguments)),o=m();return n.push(o.makeNodeResolver()),R(e).fapply(n).fail(o.reject),o.promise}},C.prototype.nfbind=C.prototype.denodeify=function(){var e=c(arguments);return e.unshift(this),R.denodeify.apply(void 0,e)},R.nbind=function(e,t){var n=c(arguments,2);return function(){var o=n.concat(c(arguments)),r=m();return o.push(r.makeNodeResolver()),R((function(){return e.apply(t,arguments)})).fapply(o).fail(r.reject),r.promise}},C.prototype.nbind=function(){var e=c(arguments,0);return e.unshift(this),R.nbind.apply(void 0,e)},R.nmapply=R.npost=function(e,t,n){return R(e).npost(t,n)},C.prototype.nmapply=C.prototype.npost=function(e,t){var n=c(t||[]),o=m();return n.push(o.makeNodeResolver()),this.dispatch("post",[e,n]).fail(o.reject),o.promise},R.nsend=R.nmcall=R.ninvoke=function(e,t){var n=c(arguments,2),o=m();return n.push(o.makeNodeResolver()),R(e).dispatch("post",[t,n]).fail(o.reject),o.promise},C.prototype.nsend=C.prototype.nmcall=C.prototype.ninvoke=function(e){var t=c(arguments,1),n=m();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},R.nodeify=function(e,t){return R(e).nodeify(t)},C.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){R.nextTick((function(){e(null,t)}))}),(function(t){R.nextTick((function(){e(t)}))}))},R.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var q=T();return R}))}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(698);if(!!!window.Promise){const e="This browser is not supported by OneID because it does not honor Promise.";throw console.warn(e),new Error(e)}Object.fromEntries=Object.fromEntries||e.m8})(),(()=>{"use strict";const e={ERROR:5,WARN:4,INFO:3,DEBUG:2,LOG:1,OFF:100};let t=e.INFO,o=!1;const r={ERROR:"color:#FC0C1B;background-color:#FFEFEF",WARN:"color:#5B3A06;background-color:#FFFBE6",INFO:"color:#363F47;background-color:#e1e9ff",DEBUG:"color:#444;background-color:#eee",LOG:"color:#000;background-color:transparent",DEFAULT:"color:#000;background-color:transparent;font-weight:",ONEID:"color:#2887b4;background-color:transparent;font-weight:bold"};let s=c();function i(e){"number"===typeof e&&(t=e,s=c())}function a(n){return t>e[n]?(e="",t={})=>{}:o?function(e){const t=["%c[OneID]%c %c[%s]%c: ",r.ONEID,r.DEFAULT,r[e],e,r.DEFAULT];return window.console[e.toLowerCase()].bind(window.console,...t)}(n):function(e){return window.console[e.toLowerCase()].bind(window.console,"[OneID] [%s]: ",e)}(n)}function c(){return{error:a("ERROR"),warn:a("WARN"),info:a("INFO"),debug:a("DEBUG"),log:a("LOG")}}var u=n(698);const l=/^\.?www/,d=/^\.?www\./,E=/^(.+)@([a-z0-9-]+)(\.([a-z]+))+$/i,_=/^[a-z]{2}-[A-Z]{2}$/,p=/LOGIN_FLOW|RECOVERY_FLOW|CONTACT_CSR_FLOW/i,f=/-(DEV|VALID|VAL|QA|STAGE|PROD)$/,h=/^{?[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}}?$/,I={LOG_LEVEL:"oid_loglevel",FEATURE_FLAGS:"oid_feature"};function A(e){return e&&document.cookie.replace(new RegExp(`(?:(?:^|.*;\\s*)${e}\\s*\\=\\s*([^;]*).*$)|^.*$`),"$1")||null}function O(e,t,n){if(document.cookie=`${encodeURIComponent(e)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT${t?`; domain=${t}`:""}${n?`; path=${n}`:""}`,t&&!l.test(t)){const o=`www${/^\./.test(t)?"":"."}${t}`;s.debug(`also deleting cookie from ${o}`),O(e,o,n)}return!0}function g(e,t,n,o,r,i){let a,c=!1;if(d.test(n)&&(n=n.replace(l,""),c=!0),!e||/^(?:expires|max-age|path|domain|secure)$/i.test(e))return!1;if(a=`${e}=${t}`,r&&r instanceof Date&&(a+=`; expires=${r.toUTCString()}`),n&&(a+=`; domain=${n}`),o&&(a+=`; path=${o}`),i&&(a+="; secure"),document.cookie=a,c){const t=`www${/^\./.test(n)?"":"."}${n}`;s.debug(`calling delete on domain ${t}`),O(e,t,o||"")}return!0}const T={getCookieDomain:function(){const e=(0,u.KT)(window.location.hostname);return e?`.${e}`:".go.com"}};function R(){let e=window.location.hostname;return"localhost"===e?e:(e=e.replace(d,""),`.${e}`)}const N={};function m(){return N}function S(e,t){Array.isArray(N[e])||(N[e]=[]),N[e].push(t)}function y(e,t){if(Array.isArray(N[e]))if("undefined"!==typeof t)for(let n=0;n<N[e].length;n++)N[e][n]===t&&N[e].splice(n,1);else N[e]=[]}function C(e,t){const n=m();Array.isArray(n[e])&&n[e].forEach((e=>{try{e(t)}catch(e){}}))}function L(e,t,n,o,r){return{status:e,response:t,statusText:o,headers:(s=n,(s||"").split("\n").map((e=>{const t=e.indexOf(":")||0;return[e.substr(0,t).trim(),e.substr(t+1).trim()]})).filter((e=>!!e[0])).reduce(((e,t)=>{const[n,o]=t;return{[n]:o,...e}}),{})),debug:{xhrFailureReason:r}};var s}function w(e,t,n,o,r){return new Promise((s=>{const i=new XMLHttpRequest;let a;i.open(e,t,!0),Object.keys(o||{}).forEach((e=>{const t=o[e];"undefined"!==typeof t&&i.setRequestHeader((e||"").toLowerCase(),t)})),i.onload=()=>{clearTimeout(a),s(function(e){const t=e.statusText||"",n="response"in e?e.response:e.responseText,o=e.getAllResponseHeaders();let{status:r}=e;return 0===r&&(r=n?200:0),L(r,n,o,t)}(i))},i.onabort=()=>{clearTimeout(a),s(L(-1,null,null,"","onabort"))},i.onerror=()=>{clearTimeout(a),s(L(-1,null,null,"","onerror"))},i.send("undefined"!==n?n:null),"number"===typeof r&&r>0&&(a=setTimeout((()=>{s(L(-1,null,null,"","setTimeout"))}),r))}))}function P(e){const t=e||{},{responseData:n,headers:o,status:r}=function(e){let t;try{t={...JSON.parse(e.response)}}catch(e){t={}}return{responseData:t,headers:e.headers||{},status:e.status||-1}}(e),s=n.data||n||null,i=n.error||null,a=-1===r,c=!a&&!!i,u=a||c,{debug:l}=t,d={status:r,data:s,error:i,headers:o,isError:u,isNetworkError:a,isAppError:c,debug:l};if(a)throw d;return d}function D(e){let{url:t}=e.request;const{method:n,body:o,headers:r,query:s,timeoutMs:i}=e.request,a=function(e={}){const t=[];return Object.keys(e).forEach((n=>{Array.isArray(e[n])?e[n].forEach((e=>{t.push([n,e])})):t.push([n,e[n]])})),t.map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(s);return a&&(t+=`?${a}`),w(n,t,JSON.stringify(o),r,i).then((t=>Object.assign(e,{response:P(t)})))}function v(e,t){const n=this[e];if("function"!==typeof t)throw new Error("Mutator must be a function");-1===n.indexOf(t)&&n.push(t)}function U(e){return async t=>{const n=await e(t);return void 0===n?t:n}}function k(e,...t){const n=e(...t),o=this.request,r=this.response;let s=Promise.resolve({request:n,response:null});o.forEach((e=>{s=s.then(U(e))}));let i=s.then(D);return r.forEach((e=>{i=i.then(U(e))})),i.then((e=>e.response))}function b(e){const t={request:[],response:[]},n={};return Object.keys(e).forEach((o=>{n[o]=k.bind(t,e[o])})),n.addRequestMutator=v.bind(t,"request"),n.addResponseMutator=v.bind(t,"response"),n}let G;const M={langPref:"en-US",cssOverride:""};function V(){return G}const F={AGEBAND_COUNTRY:"ac",AGEBAND_GATING:"ab2",AGEBAND_DOB:"abdob",API:"api",IDENTIFIER:"idn",MUTEX:"mtx",OBO:"obo",RECOVERY_TOKEN:"rt",S2:"s2",SWID:"SWID",LOWERCASE_SWID:"swid",SWID_NT:"SWID_NT",TOKEN:"token",TRUST_STATE:"ts"};function x(e,t=!1){if(!e)return;const n=new Date(Date.now());n.setFullYear(n.getFullYear()+1),g(F.SWID,e,T.getCookieDomain(),"/",n),t&&g(F.SWID_NT,1,T.getCookieDomain(),"/",n)}function B(){return A(F.SWID)}const $={TOP:"|",VERSION:"=",DOUBLE_CHAR:"#",TRIPLE_CHAR:"$",NEGATIVE:"-"},j={STRING:"string",DATE:"date",INT:"int",BOOLEAN:"boolean",UUID:"uuid",UNKNOWN:"unknown",JSON:"json",STRING_RAW:"string_raw"},K={currentVersion:"5",versions:{4:[{key:"token.access_token",type:j.STRING},{key:"token.swid",type:j.UUID},{key:"token.refresh_token",type:j.STRING},{key:"token.ttl",type:j.INT},{key:"token.refresh_ttl",type:j.INT},{key:"token.sso",type:j.UUID},{key:"token.created",type:j.STRING},{key:"token.lastChecked",type:j.STRING},{key:"token.expires",type:j.STRING},{key:"token.refresh_expires",type:j.STRING},{key:"token.authenticator",type:j.STRING},{key:"token.blue_cookie",type:j.STRING},{key:"token.high_trust_expires_in",type:j.INT},{key:"token.initial_grant_in_chain_time",type:j.INT},{key:"token.id_token",type:j.STRING},{key:"token.sessionTransferKey",type:j.STRING}],5:[{key:"token",type:j.JSON},{key:"id_token",type:j.STRING_RAW}]},vals:{4:" !\"'()+./?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{}~",5:" !\"'()+./?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{}~"}};function H(e,t=K.currentVersion){const n=K.versions[t];if(!n)return;const o={token:(0,u.d9)(e.token),id_token:e.token.id_token};return delete o.token.id_token,delete o.token.scope,t+$.VERSION+function(e,t){return t.map((t=>function(e,t){let n;const o=K.vals[K.currentVersion];if(!e||!t||!t.key||!t.type)return;if(n=(0,u.U2)(e,t.key),"undefined"===typeof n||null===n)return;switch(t.type){case j.STRING:n=a(n);break;case j.DATE:n=c(n);break;case j.INT:n=s(n);break;case j.BOOLEAN:n=d(n);break;case j.UUID:n=l(n);break;case j.STRING_RAW:break;case j.JSON:n=r(n);break;default:n=a(n)}return n;function r(e){return"object"!==typeof e?e:(0,u.h$)(JSON.stringify(e))}function s(e){let t="";if(e=parseInt(e,10),!Number.isNaN(e)){if(0===e)return o.charAt(0);for(e<0&&(t=$.NEGATIVE,e*=-1);e>0;){const n=Math.floor(e/o.length),r=e-n*o.length;t+=o.charAt(r),e=n}return t}}function i(e,t){for(let n=0;n<t;n++)e+=o.charAt(0);return e}function a(e){let t,n="";if("undefined"!==typeof e&&null!==e)return`${e}`.split("").forEach((e=>{t=s(e.charCodeAt()-32),2===t.length?t=$.DOUBLE_CHAR+t:3===t.length&&(t=$.TRIPLE_CHAR+t),n+=t})),n}function c(e){return"[object Date]"!==Object.prototype.toString.call(e)&&(e=new Date(e)),s(e.getTime())}function l(e){let t="",n="";const r=8;if("[object String]"!==Object.prototype.toString.call(e)||!h.test(e))return a(e);n+=/^{[^}]*}$/.test(e)?"1":"0",n+=/[A-F]/.test(e)?"1":"0",e=e.replace(/[{\-}]/g,"");const c=Math.floor(e.length/r);for(let n=0;n<c;n++){const o=e.substr(n*r,r),a=s(parseInt(o,16));t+=i(a,6-a.length)}return`${o.charAt(parseInt(n,2))}${t}`}function d(e){if("true"===e||"1"===e||!0===e||1===e)e=1;else{if("false"!==e&&"0"!==e&&!1!==e&&0!==e)return;e=0}return s(e)}}(e,t))).join($.TOP)}(o,n)}function W(e){if(!e)return;const t=e.substring(e.indexOf($.VERSION)+1),n=e.substring(0,e.indexOf($.VERSION)),o=K.versions[n];if(!o)return;const r=function(e,t,n){const o={};return e.split("|").forEach(((e,r)=>{(0,u.t8)(o,t[r].key,function(e,t,n){if(""===e)return null;const o=K.vals[n]||K.vals[K.currentVersion];switch(t.type){case j.STRING:e=i(e);break;case j.DATE:e=a(e);break;case j.INT:e=s(e);break;case j.BOOLEAN:e=l(e);break;case j.UUID:e=c(e);break;case j.STRING_RAW:break;case j.JSON:e=r(e)}return e;function r(e){let t;try{const n=(0,u.tV)(e);t=JSON.parse(n)}catch(t){return e}return t}function s(e){let t=0,n=1,r=1;if(0!==(e=(e||"").split("")).length)return e[0]===$.NEGATIVE&&(n=-1,e.splice(0,1)),e.forEach((e=>{t+=o.indexOf(e)*r,r*=o.length})),t*n}function i(e){let t=0;const n=e.length;let o,r="";if(0!==n){for(;t<n;){switch(e[t]){case $.DOUBLE_CHAR:o=2,t+=1;break;case $.TRIPLE_CHAR:o=3,t+=1;break;default:o=1}r+=String.fromCharCode(s(e.substr(t,o))+32),t+=o}return r}}function a(e){if(e=s(e))return new Date(e)}function c(e){let t=parseInt(o.indexOf(e[0]),10),n=!1,r=!1,a="";const c=6,u=e;Number.isNaN(t)||(t=t.toString(2),t.length<2&&(t=`0${t}`),n="1"===t[0],r="1"===t[1],e=e.substring(1));const l=Math.floor(e.length/c);for(let t=0;t<l;t++){let n=s(e.substr(t*c,c)).toString(16);for(;n.length<8;)n=`0${n}`;a+=n}a=r?a.toUpperCase():a.toLowerCase();const d=`${(n?"{":"")+a.substring(0,8)}-${a.substring(8,12)}-${a.substring(12,16)}-${a.substring(16,20)}-${a.substring(20)}${n?"}":""}`;return h.test(d)?d:i(u)}function l(e){return 1===s(e)}}(e,t[r],n))})),o}(t,o,n),{token:s}=r;return s.id_token=r.id_token,s.isExpired=q(s),s}function q(e){return!(Y(e)&&Date.now()<e.exp)}function Y(e){if(!e)return!1;return"string"===typeof e.swid&&"number"===typeof e.iat&&"string"===typeof e.access_token&&"number"===typeof e.exp&&(!e.refresh_token||"number"===typeof e.refresh_exp)}function Z(e){const{exp:t,iat:n}=e,o=n+.8*(t-n);return Date.now()>o}function z(e,t=3e4){const n=Object.keys(e.frames).reduce(((t,n)=>({...t,[n]:{name:n,window:e.frames[n].window,ports:{},origin:e.frames[n].origin}})),{}),o=[];return Object.keys(e.frames).forEach((t=>{const o=n[t];e.frames[t].channels.forEach((e=>{const r=n[e];if(!o.ports[e]){const n=new MessageChannel;o.ports[e]=n.port1,r.ports[t]=n.port2}}))})),Object.keys(n).forEach((e=>{var r;o.push(function(e,t){return new Promise(((n,o)=>{const r=Date.now(),s=setInterval(i,100);function i(){if(Date.now()-r>t)return c(),void o(new Error("Bootstrap timed out"));e.window.postMessage({event:"comm-bootstrap-start",targetName:e.name},e.origin)}function a(t){const o=t.data&&t.data.targetName;t.source===e.window&&o&&o===e.name&&t.data&&"comm-bootstrap-ack"===t.data.event&&(c(),n())}function c(){clearInterval(s),window.removeEventListener("message",a)}window.addEventListener("message",a),i()}))}(n[e],t).then((r=n[e],()=>{const e=Object.keys(r.ports);for(const t of e)r.window.postMessage({event:"comm-bootstrap-data",targetName:r.name,ports:e,port:t},r.origin,[r.ports[t]])})))})),Promise.all(o)}const Q=["CALL","CALL_DONE","EVENT"];function X(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_=+";let t="";for(let n=0;n<24;n+=1){t+=e[Math.floor(Math.random()*e.length)]}return t}function J(e,t="DEFAULT"){const n=`PatchBay[${t}]`,o={},r={},i={};return Object.keys(e).forEach((t=>{e[t].onmessage=function(e){return t=>{if(!t||!t.data||"object"!==typeof t.data)return;const{data:n}=t;-1!==Q.indexOf(n.type)&&(a(n.name,e,n),setTimeout(c.bind(null,n.name)))}}(t)})),{addHandler:function(e,t){if("function"!==typeof t)return;o[e]=t,c(e)},message:l,broadcast:function(t,n){const o={id:X(),type:"EVENT",data:n,name:t};a(t,null,o),setTimeout(c.bind(null,t)),Object.keys(e).forEach((e=>{l(e,t,n)}))},call:function(e,t,o){return new Promise(((r,a)=>{const c=X();s.debug(`${n}: call() invoked, target=${e}, name=${t}, id=${c}`),i[c]={resolve:r,reject:a},d(e,t,"CALL",o,c)}))}};function a(e,t,o){s.debug(`${n}: queueMessage(name=${e}, source=${t})`),r[e]||(r[e]=[]),r[e].push({source:t,data:o})}function c(e){if(s.debug(`${n}: flushQueue(name=${e})`),!Array.isArray(r[e])||r[e].length<1)return void s.debug(`${n}: Nothing in queue for '${e}', exit early`);const t=[];for(;r[e].length;){const{source:a,data:c}=r[e].pop(),l=c&&c.type||void 0,d=c&&c.id||void 0,E=`${n} - ${d||"NO_ID"}`;if(s.debug(`${E}: flushQueue loop, source=${a}, type=${l}`),"CALL"===l||"EVENT"===l){let n;if(!o[e]){s.debug(`${E}: flushQueue loop, NO HANDLER FOR name=${e}, deferring`),t.push({source:a,data:c});continue}s.debug(`${E}: flushQueue loop, about to call handler for name=${e}`),n=o[e](c&&c.data),s.debug(`${E}: flushQueue loop, obtained return value from name=${e}`),"CALL"===l&&(n&&n.then||(s.debug(`${E}: flushQueue loop, handler for name=${e} returned plain value`),n=Promise.resolve(n)),n.then((t=>{s.debug(`${E}: flushQueue, promise resolved for name=${e}, messaging back`),u(a,e,t,d,"resolved")})).catch((t=>{s.debug(`${E}: flushQueue, promise caught error for name=${e}, messaging back`),u(a,e,t,d,"rejected")})))}if("CALL_DONE"===l){const{status:e}=c;if(!i[d]){s.debug(`${E}: flushQueue loop, pendingCalls EMPTY FOR id=${d}!!!`);continue}"resolved"===e?(s.debug(`${E}: flushQueue loop, resolving promise for id=${d}`),i[d].resolve(c.data)):(s.debug(`${E}: flushQueue loop, rejecting promise for id=${d}`),i[d].reject(c.data)),delete i[d]}}for(const o of t)s.debug(`${n}: flushQueue, pushing deferred item back into queue, name=${e}`),r[e].push(o)}function u(e,t,n,o,r){d(e,t,"CALL_DONE",n,o,r)}function l(e,t,n){d(e,t,"EVENT",n)}function d(o,r,i,u,l,d){if(l=l||X(),o===t)return s.debug(`${n}: Target is self...`),a(r,o,{id:l,type:i,name:r,data:u,status:d}),void setTimeout(c.bind(null,r));e[o]?e[o].postMessage({id:l,type:i,name:r,data:u,status:d}):s.debug(`${n}: Target '${o}' has not been registered!!!`)}}const ee=(te="outer",new Promise((e=>{const t={};window.addEventListener("message",(function n(o){o.data&&o.data.targetName===te&&("comm-bootstrap-start"===o.data.event&&o.source.postMessage({event:"comm-bootstrap-ack",targetName:te},"*"),"comm-bootstrap-data"===o.data.event&&(t[o.data.port]=o.ports[0],Object.keys(t).length>=o.data.ports.length&&(window.removeEventListener("message",n),e(t))))}))}))).then((e=>new J(e,"outer")));var te;const ne=/^stg-|-stg\.|^stg\.cdn/,oe=/^qa-|-qa\.|:3001$|^qa\.cdn|^edna\.cdn/,re=/^val-|-val\.|^val\.cdn/,se={QA:"QA",STG:"STAGE",PROD:"PROD",VAL:"VALID"};let ie=se.PROD,ae="";function ce(){return ie}const ue={AGEBAND_TIMEOUT:18e5,GUEST_TOKEN_TIMEOUT:216e5,LAUNCH_METHOD_TIMEOUT:3e4,LONG_COOKIE_YEAR_TIMEOUT:33,MAX_MUTEX_ATTEMPTS:5,MUTEX_WAIT_INTERVAL:5e3,MUTEX_TIMEOUT:2e4,OTP_RECOVERY_TIMEOUT:9e5,PULSE_TIMEOUT:700,SESSION_TIMER_POLL_INTERVAL:1e4,SHOW_SENT_MESSAGE_TIMEOUT:3e3,SUCCESS_ANIMATION_TIMEOUT:2e3,TRUST_TIMEOUT:18e5};function le(){const e=V(),t=ce();return ee.then((n=>n.call("responder","get.cookie",`${e&&e.clientId}-${t}.${F.TOKEN}`).then((e=>W(e))).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`)}))))}var de=n(961);const Ee=[];function _e(){if(!Ee.length)return"";let e=Ee.join("|");return e.length>600&&(e=e.slice(-600)),`0|${(0,de.compressToBase64)(e)}`}function pe(e,t,n,o){let r;const i=`WorkflowManager[${e}]: `;return{runWorkflow:function(){s.debug(`${i}WorkflowManager.runWorkflow`),s.debug(`${i}name :`,e),r=n||Object.keys(t[0])[0],s.debug(`${i}step :`,r),c()}};function a(){const e=t.find((e=>Object.keys(e)[0]===r));return e&&e[r]}function c(){var t;s.debug(`${i}Executing step ${r}`),t=`${e.toUpperCase()}>${r}`,Ee.push(t);const n=a(),o=Object.keys(n.results);try{n.stepExecution(u,o)}catch(e){throw s.error(e),e}}function u(t){s.debug(`${i}Step complete, result ${t}`);const{results:n}=a()||{};if(r=n&&n[t],r)return c();s.debug(`${i}Workflow complete:`,e),o&&o(t)}}const fe={ACTION_NAME:"action_name",ERROR_CATEGORY:"error_category",ERROR_CODES:"error_codes",FLOW:"flow",SUBFLOW:"subflow",INFO:"info",NEW_RELIC:"newRelic",PAGE_VIEW:"pageView",PROBLEM:"problem",STACK_TRACE:"stack_trace",TRANSACTION_ID:"transaction_id",API_FORCE_TOKEN_REFRESH:"api:force:tokenrefresh",API_GET_ACTIVITY_STATUS:"api:get:activitystatus",API_GET_GUEST_DATA:"api:get:guest",API_GET_GUEST_NEWSLETTERS:"api:get:guestnewsletters",API_GET_INLINE_NEWSLETTERS:"api:get:inlinenewsletters",API_GET_LICENSE_PLATE_DATA_BAG:"api:get:licenseplate:databag",API_GET_LOGGED_IN_STATUS:"api:get:loggedinstatus",API_GET_TRUST_STATE_STATUS:"api:get:truststatestatus",API_INIT:"api:init",API_LAUNCH_EMAILVERIFICATION:"api:launch:emailverification",API_LAUNCH_GUESTFLOW:"api:launch:guestflow",API_LAUNCH_IDENTITYFLOW:"api:launch:identityflow",API_LAUNCH_LICENSE_PLATE:"api:launch:licenseplate",API_LAUNCH_LOGIN:"api:launch:login",API_LAUNCH_OTP_ONDEMAND:"api:launch:otp:ondemand",API_LAUNCH_NEWSLETTERS:"api:launch:newsletters",API_LAUNCH_PROFILE:"api:launch:profile",API_LAUNCH_REAUTH:"api:launch:reauth",API_LAUNCH_REGISTRATION:"api:launch:registration",API_LAUNCH_SOCIAL_REGISTRATION:"api:launch:socialregistration",API_LOGOUT:"api:logout",API_REDEEM_LICENSE_PLATE_CODE:"api:redeem:licenseplate:code",API_REDEEM_SESSION_TRANSFER:"api:redeem:sessiontransfer",API_SET_DO_NOT_DISTURB:"api:set:donotdisturb",API_SET_INLINE_NEWSLETTERS:"api:set:inlinenewsletters",API_GET_PPC:"api:get:ppc",API_SET_PPC:"api:set:ppc",EVENT_CLOSE:"event:ui:close",EVENT_LOGOUT:"event:logout",EVENT_AGE_GATED:"event:agegated",EVENT_CREATE:"event:create",EVENT_ERROR:"event:error",EVENT_EXPIRED_SESSION:"event:expiredsession",EVENT_EXTERNAL_LINK_EPC:"event:externallink:epc",EVENT_EXTERNAL_LINK_MYACCOUNT:"event:externallink:myaccount",EVENT_INIT:"event:init",EVENT_LOGIN:"event:login",EVENT_LOGIN_OBO:"event:login:obo",EVENT_LOW_TRUST:"event:lowtrust",EVENT_OPT_IN:"event:optin",EVENT_REAUTH:"event:reauth",EVENT_REGISTRATION_OTP_CLOSE:"event:registration:otp:close",EVENT_REFRESH:"event:refresh",EVENT_UPDATE:"event:update",BU_EVENT_TO_ACTION_NAME:{"age-gated":"EVENT_AGE_GATED",close:"EVENT_CLOSE",create:"EVENT_CREATE",error:"EVENT_ERROR",init:"EVENT_INIT",login:"EVENT_LOGIN",logout:"EVENT_LOGOUT","low-trust":"EVENT_LOW_TRUST","opt-in":"EVENT_OPT_IN",reauth:"EVENT_REAUTH",refresh:"EVENT_REFRESH",update:"EVENT_UPDATE"},CLICK_PASSWORD_CHECK_RESET_PASSWORD:"click:passwordcheck:resetpassword",CLICK_PASSWORD_CHECK_SKIP_RESET:"click:passwordcheck:skipreset",CLICK_REGISTER_BUTTON_ON_LOGIN:"click:button:login:createaccount",CLICK_LOGIN_LINK_ON_REGISTER:"click:link:register:signin",LOG_APPLICATION_ERROR:"log:application:error",LOG_INVALID_DISPLAY_OPTION:"log:invalid:displayoption",LOG_INVALID_LEGAL_CONFIG:"log:invalid:legalconfig",LOG_INVALID_MARKETING_CONFIG:"log:invalid:marketingconfig",LOG_INVALID_OID_CONFIG:"log:invalid:oidconfig",LOG_MISSING_GUEST_DATA_ON_LOGOUT:"log:missing:guestdata:on:logout",LOG_MISSING_L10N:"log:missing:l10n",LOG_PATCHBAY_ERROR:"log:patchbay:error",LOG_PPU:"log:ppu",LOG_RECAPTCHA_ERROR:"log:recaptcha:error",LOG_UNEXPECTED_ERROR:"log:unexpected:error",LOG_VERSION_MISMATCH:"log:version:mismatch",LOG_MOBILE_DATA_MISMATCH:"log:mobile:data:mismatch",LOG_PHONE_FORMATTING_ERROR:"log:application:phone:formatting:error",SERVICE_CHECK_AUTHORIZATION:"service:checkauthorization",SERVICE_CREATE:"service:register",SERVICE_DATE_OF_BIRTH_VALIDATE:"service:dob:validate",SERVICE_DISPLAY_NAME_VALIDATE:"service:displayname:validate",SERVICE_DOWNLOAD_CONFIG:"service:download:config",SERVICE_EMAIL_VALIDATE:"service:email:validate",SERVICE_GUEST_FLOW:"service:guestflow",SERVICE_LICENSE_PLATE_PEEK:"service:licenseplate:peek",SERVICE_LICENSE_PLATE_REDEEM:"service:licenseplate:redeem",SERVICE_LOGIN:"service:login",SERVICE_LOGIN_RECOVERY:"service:login:recovery",SERVICE_LOGOUT:"service:logout",SERVICE_NEWSLETTERS_GALC:"service:newsletters:galc",SERVICE_NEWSLETTERS_GEOGATED:"service:newsletters:geogated",SERVICE_OTP_EMAIL_VERIFICATION:"service:otprequest:emailverification",SERVICE_OTP_EMAIL_VERIFICATION_REDEEM:"service:otpredeem:emailverification",SERVICE_OTP_EMAIL_VERIFICATION_RESEND:"service:otprequest:emailverification:resend",SERVICE_OTP_EMAIL_UPDATE:"service:otprequest:update:email",SERVICE_OTP_EMAIL_UPDATE_REDEEM:"service:otpredeem:update:email",SERVICE_OTP_EMAIL_UPDATE_RESEND:"service:otprequest:update:email:resend",SERVICE_OTP_LOGIN_RECOVERY_METHODS:"service:otplogin:recovery:methods",SERVICE_OTP_LOGIN_REDEEM:"service:otpredeem",SERVICE_OTP_LOGIN_REQUEST_OTP:"service:otprecovery",SERVICE_OTP_LOGIN_RESEND_EMAIL:"service:otplogin:resend:email",SERVICE_OTP_LOGIN_RESEND_SMS:"service:otplogin:resend:sms",SERVICE_OTP_LOGIN_RESET_PASSWORD:"service:otplogin:resetpassword",SERVICE_OTP_LOGIN_UPGRADE_NRT:"service:otplogin:upgradenrt",SERVICE_OTP_ONDEMAND_REQUEST:"service:otp:ondemand:request",SERVICE_OTP_ONDEMAND_REDEEM:"service:otp:ondemand:redeem",SERVICE_OTP_ONDEMAND_RECOVERY_METHODS:"service:otp.ondemand:recovery:methods",SERVICE_OTP_SECURITY_FLAG_LOGIN_REQUEST:"service:otprequest:securityflag:login",SERVICE_OTP_SECURITY_FLAG_LOGIN_REDEEM:"service:otpredeem:securityflag:login",SERVICE_OTP_SECURITY_FLAG_RECOVERY_REQUEST:"service:otprequest:securityflag:recovery",SERVICE_OTP_SECURITY_FLAG_RECOVERY_REDEEM:"service:otpredeem:securityflag:recovery",SERVICE_OTP_PASSWORD_UPDATE:"service:otprequest:update:password",SERVICE_OTP_PASSWORD_UPDATE_REDEEM:"service:otpredeem:update:password",SERVICE_OTP_PASSWORD_UPDATE_RESEND:"service:otprequest:update:password:resend",SERVICE_OTP_PHONE_VERIFICATION:"service:otprequest:phoneverification",SERVICE_OTP_PHONE_VERIFICATION_REDEEM:"service:otpredeem:phoneverification",SERVICE_OTP_PHONE_VERIFICATION_RESEND:"service:otprequest:phoneverification:resend",SERVICE_PASSWORD_VALIDATE:"service:password:validate",SERVICE_PPU_PROFILE:"service:update:ppu:profile",SERVICE_PPU_PASSWORD:"service:update:ppu:password",SERVICE_REAUTH:"service:reauth",SERVICE_RECAPTCHA_CHECKBOX:"service:recaptchacheckbox",SERVICE_REFRESH_GUEST:"service:refresh:guest",SERVICE_REFRESH_TOKEN:"service:refresh:token",SERVICE_REGISTRATION_AGEGATED:"service:registration:agegated",SERVICE_REGISTRATION_GALC:"service:registration:galc",SERVICE_REGISTRATION_PIL2_NOTIFY:"service:registration:pil2:notify",SERVICE_SESSION_TRANSFER_ACTIVATE:"service:sessiontransfer:activate",SERVICE_REGISTRATION_OTP_SENT:"service:registration:otp:sent",SERVICE_REGISTRATION_OTP_RESEND:"service:registration:otp:resend",SERVICE_UPDATE_GUEST:"service:update:guest",SERVICE_UPDATE_GUEST_CREDENTIALS:"service:update:guestcredentials",SERVICE_UPDATE_MARKETING:"service:update:marketing",SERVICE_USERNAME_VALIDATE:"service:username:validate",ID_TOKEN_MASK_LENGTH:6},he={action_name:"string",alternateConfig:"string",anon:"string",appid:"string",browser:"string - added by Log.go service",client_id:"string",connection_type:"string",context:"string",conversation_id:"string",error_category:"string",error_codes:"string",experience:"string",flow:"string",id_token:"string",info:"string",lightbox_version:"string",os:"string - added by Log.go service",platform:"string - added by Log.go service",problem:"string",process_time:"string",referrer_host:"string - added by Log.go service",reporting:"string",sdk_version:"string",source:"string",stack_trace:"string",subflow:"string",swid:"string",timestamp:"string",trace:"string",transaction_id:"string",user_agent:"string - added by Log.go service"};const Ie={appid:"DTCI-ONEID-UI"};let Ae;let Oe=!1,ge={},Te={},Re=!0;function Ne(){const{clientId:e,langPref:t,debug:n}=V()||{};Ie.client_id=`${e}-${ce()}`,Ie.locale=t,Ie.sdk_version=`web ${window.ONEID_WEB_SDK_VERSION}`,function(){const e="https://feet-qa.segds.engsvc.go.com/",t="https://feet-stg.segds.engsvc.go.com/",n="https://log.go.com/",o=ce();Ae=o!==se.QA?o!==se.STG?n:t:e}(),n&&n.experimentalFeatures&&(window.newRelicRequests=[],Re=!1),Oe=!0}function me(e={}){let t=(0,u.U2)(e,"optionalConfigs.reporting"),n=(0,u.U2)(e,"optionalConfigs.experience");t&&!we(t)&&(t=null),n&&!Pe(n)&&(s.warn("optionalConfigs.experience does not pass validation, values will be ignored"),n=null),Te=t||n?{reporting:t,...n&&{experience:n}}:{},Te.conversationId=(0,u.Vj)()}function Se(){let e={...ge.reporting,...Te.reporting};return we(e)||(s.warn("Combined reporting config does not pass validation, values will be ignored"),e={...ge.reporting}),e.experience=Te.experience||ge.experience,e.conversationId=Te.conversationId,{optionalConfigs:{reporting:e}}}function ye(e){Oe||Ne();const t=Date.now(),n={action_name:e};return{send:(e={})=>Le({...n,...e,process_time:Date.now()-t||1})}}const Ce={[fe.API_GET_ACTIVITY_STATUS]:2,[fe.API_GET_GUEST_DATA]:2,[fe.API_GET_GUEST_NEWSLETTERS]:2,[fe.API_GET_LOGGED_IN_STATUS]:2,[fe.API_GET_TRUST_STATE_STATUS]:2,[fe.API_INIT]:2,[fe.API_SET_DO_NOT_DISTURB]:2,[fe.EVENT_CLOSE]:2,[fe.EVENT_INIT]:2,[fe.EVENT_LOW_TRUST]:2};function Le(e){s.debug("metricsNewRelic.sendNewRelicLog"),Oe||Ne(),e={...Ie,timestamp:Date.now(),...e};const{context:t,source:n,experience:o,conversationId:r,mid:i,...a}=(e.hasOwnProperty("reporting")?e.reporting:(0,u.U2)(Se(),"optionalConfigs.reporting"))||{};t&&(e.context=t),n&&(e.source=n),e.conversation_id=r||(0,u.Vj)(),o&&(e.experience=o),e.reporting=function(e,t){const n=[];Object.keys(t).forEach((e=>{n.push(`${e}(${t[e]})`)})),e&&n.push(`m-id(${e})`);return n.join(",")}(i,a),e.reporting||delete e.reporting,window.ONEID_WEB_SDK_MIGRATION&&(e[fe.INFO]=e[fe.INFO]?`${e[fe.INFO]},isV4Migration(true)`:"isV4Migration(true)");const c=("string"===typeof e.action_name?e.action_name:"").toLowerCase(),l=Ce[c];if(Re&&"number"===typeof l&&Math.random()>l/100)return void s.debug("not sending log - coin toss was tails.");const d=_e();var E;!e.trace&&d.length&&(e.trace=d),E=e,Object.keys(E).forEach((e=>{he[e]&&(E[e]||!1===E[e])||(s.debug(`analyticsUtils.removeInvalidNewRelicField: Removing key/value pair ${e}/${E[e]}`),delete E[e])}));const _=B();e.swid=_,e.anon=/{.+}/.test(_)?"false":"true";const p=le().then((t=>{const n=(0,u.U2)(t,"id_token");n&&(e.id_token=(0,u.Cd)(n,fe.ID_TOKEN_MASK_LENGTH));const o=new b({sendLog:e=>({method:"GET",url:`${Ae}log`,body:{},headers:{},query:e})});return o.sendLog(e)}));if(window.newRelicRequests){const e=new Promise((e=>{p.finally(e)})).then((()=>{window.newRelicRequests=window.newRelicRequests.filter((t=>t!==e)),s.debug(`Removed resolved promise from 'newRelicRequests', ${window.newRelicRequests.length} remain`)}));window.newRelicRequests=[...window.newRelicRequests,e],s.debug(`Added promise to 'newRelicRequests', ${window.newRelicRequests.length} are now currently outstanding`)}return p}function we(e){let t=0;for(const n in e){if(!/^[a-zA-Z0-9_]{1,30}$/.test(n))return!1;if(e[n].length>100)return!1;if(t+=1,t>10)return!1}return!0}function Pe(e){return!(!e||"string"!==typeof e)&&!!/^[A-Z0-9\.\-\_]+\.EXP$/g.test(e)}function De(e,t,n){let o=`payload-included(${!!t})`;(e&&"error"===e.toLowerCase()||!1)&&t&&(o=`${o},event-payload(${t})`),n&&(o=`${o},${n}`),Le({[fe.ACTION_NAME]:fe[fe.BU_EVENT_TO_ACTION_NAME[e]]||e,[fe.INFO]:o}),C(e,t)}function ve(){return ee.then((e=>e.call("inner","config.getSiteConfig"))).then(u._A)}const Ue={getGuest:"getGuest",guestLogin:"guestLogin",guestMarketingOptIn:"guestMarketingOptIn",guestRecoveryMethods:"guestRecoveryMethods",guestRegister:"guestRegister",guestUpdateBySWID:"guestUpdateBySWID",loginWithRecoveryToken:"loginWithRecoveryToken",requestOTPCodePhoneVerification:"requestOTPCodePhoneVerification",notificationOTPRecovery:"notificationOTPRecovery",notificationOTPUpdateCredentials:"notificationOTPUpdateCredentials",loginWithRecoveryTokenForSecurityFlagResolutionUpdateCredentialsBySWID:"loginWithRecoveryToken",otpRedeem:"otpRedeem",otpRedeemEmailVerification:"otpRedeemEmailVerification",otpRedeemUpdateCredentials:"otpRedeemUpdateCredentials",otpChangePassword:"otpChangePassword",otpUpgradeNRT:"otpUpgradeNRT",parentNotification:"parentNotification",validateDateOfBirth:"validateDateOfBirth",validateEmail:"validateEmail",validatePassword:"validatePassword",validateDisplayName:"validateDisplayName",activateSessionTransfer:"activateSessionTransfer"},ke={checkAuthorization:function({accessToken:e,swid:t}){const n={method:"",url:"",body:{},headers:{},query:{}},o=`/guest/check-authorization/${t}`;return n.headers.authorization=`BEARER ${e}`,{...n,method:"GET",url:o,eventName:fe.SERVICE_CHECK_AUTHORIZATION}},getGuest:function({accessToken:e,swid:t}){const n={method:"",url:"",body:{},headers:{},query:{}},o=`/guest/${t}`;return n.query.feature="always-get-entitlements",n.query.expand=["profile","displayname","linkedaccounts","marketing","entitlements","s2"],n.headers.authorization=`BEARER ${e}`,{...n,method:"GET",url:o,eventName:fe.SERVICE_REFRESH_GUEST,storeResponseKey:Ue.getGuest}},guestFlow:function(e,t=fe.SERVICE_GUEST_FLOW){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest-flow",body:{email:e},eventName:t}},guestLogin:function({deviceId:e,loginValue:t,password:n,recaptchaToken:o}){const r={method:"",url:"",body:{},headers:{},query:{}};e&&(r.headers["device-id"]=e);o&&(r.headers["g-recaptcha-token"]=o);return{...r,method:"POST",url:"/guest/login",body:{loginValue:t,password:n},eventName:fe.SERVICE_LOGIN,storeResponseKey:Ue.guestLogin}},guestReauth:function({deviceId:e,loginValue:t,password:n,recaptchaToken:o,accessToken:r}){const s={method:"",url:"",body:{},headers:{},query:{}};s.headers.authorization=`BEARER ${r}`,e&&(s.headers["device-id"]=e);o&&(s.headers["g-recaptcha-token"]=o);return{...s,method:"POST",url:"/guest/reauth",body:{loginValue:t,password:n},eventName:fe.SERVICE_REAUTH,storeResponseKey:Ue.guestLogin}},guestMarketingOptIn:function(e={}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/marketing",body:e,eventName:fe.SERVICE_UPDATE_MARKETING,storeResponseKey:Ue.guestMarketingOptIn}},guestRecoveryMethods:function({loginValue:e,eventName:t=fe.SERVICE_OTP_LOGIN_RECOVERY_METHODS}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/recovery-methods",body:{loginValue:e},eventName:t,storeResponseKey:Ue.guestRecoveryMethods}},guestRegister:function(e={}){const{password:t,profile:{username:n}={}}=e,o={autogeneratePassword:!t,autogenerateUsername:!n},r={method:"",url:"",body:{},headers:{},query:{}};e.recaptchaToken&&(r.headers["g-recaptcha-token"]=e.recaptchaToken);return{...r,method:"POST",url:"/guest/register",body:e,query:o,eventName:fe.SERVICE_CREATE,storeResponseKey:Ue.guestRegister}},guestUpdateBySWID:function({guest:e,swid:t,accessToken:n,eventName:o}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${n}`},query:{feature:"no-password-reuse"},method:"POST",url:`/guest/${t}`,body:(0,u.d9)(e),eventName:o,storeResponseKey:Ue.guestUpdateBySWID}},guestValidate:function({body:e,eventName:t,storeResponseKey:n}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/validate",body:e,eventName:t,storeResponseKey:n}},licensePlatePeek:function(e){return{method:"",url:"",body:{},headers:{},query:{},method:"GET",url:`/license-plate/code/${e}`,eventName:fe.SERVICE_LICENSE_PLATE_PEEK}},licensePlateRedeem:function(e,t){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/license-plate/code/${e}/activate`,body:{refreshToken:t},eventName:fe.SERVICE_LICENSE_PLATE_REDEEM}},loginWithRecoveryToken:function({swid:e,recoveryToken:t,deviceId:n}){const o={method:"",url:"",body:{},headers:{},query:{}};n&&(o.headers["device-id"]=n);return o.query.expand=["profile","displayname","linkedaccounts","marketing","entitlements","s2"],{...o,method:"POST",url:"/guest/login/recoveryToken",body:{swid:e,recoveryToken:t},eventName:fe.SERVICE_LOGIN_RECOVERY,storeResponseKey:Ue.loginWithRecoveryToken}},logout:function({swid:e,tokenAndClientIds:t=[]}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/guest/${e}/logout`,body:{tokenAndClientIds:t},eventName:fe.SERVICE_LOGOUT}},notificationOTPEmailVerification:function({accessToken:e,eventName:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/notification/otp/email-verification",headers:{authorization:`BEARER ${e}`},eventName:t}},notificationOTPRecovery:function({recoveryPayload:e,eventName:t,intent:n}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/notification/otp/recovery",body:e,query:{intent:n},eventName:t,storeResponseKey:Ue.notificationOTPRecovery}},notificationOTPUpdateCredentials:function({accessToken:e,eventName:t,body:n=null}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/notification/otp/update-credentials",eventName:t,body:n,storeResponseKey:Ue.notificationOTPUpdateCredentials}},notificationOTPRegistration:function({email:e,accessToken:t,eventName:n=fe.SERVICE_REGISTRATION_OTP_SENT}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${t}`},method:"POST",url:"/notification/otp/registration",body:{email:e},eventName:n}},oboLogin:function({oboToken:e,swid:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/login/on-behalf-of",body:{swid:t},headers:{Authorization:`BEARER ${e}`}}},otpRedeem:function({otpCode:e,sessionIds:t,eventName:n,assessmentId:o}){const r={passcode:e,sessionIds:t};o&&(r.assessmentId=o);return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/otp/redeem",body:r,eventName:n,storeResponseKey:Ue.otpRedeem}},otpRedeemEmailVerification:function({accessToken:e,otpCode:t,sessionIds:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/otp/verify-email",body:{passcode:t,sessionIds:n},eventName:fe.SERVICE_OTP_EMAIL_VERIFICATION_REDEEM,storeResponseKey:Ue.otpRedeemEmailVerification}},otpRedeemUpdateCredentials:function({accessToken:e,otpCode:t,sessionIds:n,eventName:o}){const r={passcode:t,sessionIds:n};return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/otp/redeem-update-credentials",body:r,eventName:o,storeResponseKey:Ue.otpRedeemUpdateCredentials}},otpChangeEmail:function({recoveryToken:e,swid:t,newEmail:n}){const o=`/guest/${t}/update-credentials`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:o,headers:{authorization:`BEARER ${e}`},body:{email:n},eventName:fe.SERVICE_UPDATE_GUEST_CREDENTIALS}},otpChangePassword:function({recaptchaToken:e,recoveryToken:t,swid:n,newPassword:o,loginValue:r}){const s=`/clickback-token/change-password/${n}`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:s,headers:{"g-recaptcha-token":e,authorization:`BEARER ${t}`},body:{newPassword:o,loginValue:r},eventName:fe.SERVICE_OTP_LOGIN_RESET_PASSWORD,storeResponseKey:Ue.otpChangePassword}},updateCredentialsBySWID:function({recoveryToken:e,swid:t,newPassword:n,eventName:o}){const r=`/guest/${t}/update-credentials`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:r,storeResponseKey:Ue.loginWithRecoveryTokenForSecurityFlagResolutionUpdateCredentialsBySWID,headers:{authorization:`BEARER ${e}`},body:{password:n},eventName:o}},otpUpgradeNRT:function({recaptchaToken:e,recoveryToken:t,swid:n,password:o,username:r}){const s=`/clickback-token/upgrade-nrt/${n}`;return{method:"",url:"",body:{},headers:{},query:{},method:"PUT",url:s,headers:{"g-recaptcha-token":e,authorization:`BEARER ${t}`},body:{password:o,username:r},eventName:fe.SERVICE_OTP_LOGIN_UPGRADE_NRT,storeResponseKey:Ue.otpUpgradeNRT}},refreshAuthorization:function(e){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/refresh-auth",body:{refreshToken:e},eventName:fe.SERVICE_REFRESH_TOKEN}},redeemOTPCodePhoneVerification:function({otpCode:e,sessionIds:t,swid:n,accessToken:o,eventName:r}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${o}`},method:"POST",url:`/guest/${n}/verify/otp`,body:{passcode:e,sessionIds:t},eventName:r,storeResponseKey:Ue.redeemOTPCodePhoneVerification}},requestOTPCodePhoneVerification:function({phoneGuid:e,accessToken:t,eventName:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${t}`},method:"POST",url:"/notification/otp/verification",body:{phoneGuid:e},eventName:n,storeResponseKey:Ue.requestOTPCodePhoneVerification}},sendParentNotification:function({swid:e,accessToken:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/notification/parental-approval/${e}`,headers:{authorization:`BEARER ${t}`},eventName:fe.EVENT_REGISTRATION_PIL2_NOTIFY,storeResponseKey:Ue.parentNotification}},deleteAccount:function({guest:e,swid:t,accessToken:n,eventName:o}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${n}`},method:"DELETE",url:`/guest/${t}`,body:{},eventName:o,storeResponseKey:Ue.deleteAccount}},activateSessionTransfer:function({accessToken:e,refreshToken:t,sessionTransferKey:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`,"Content-Type":"application/json"},method:"POST",url:"/session/transfer/activate",body:{refreshToken:t,sessionTransferKey:n},storeResponseKey:Ue.activateSessionTransfer,eventName:fe.SERVICE_SESSION_TRANSFER_ACTIVATE}},authenticateViaSessionTransferKey:function({sessionTransferKey:e,eventName:t=fe.API_REDEEM_SESSION_TRANSFER}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/session/transfer/redeem",body:{sessionTransferKey:e},eventName:t}}};const be={ACCOUNT_FOUND:"ACCOUNT_FOUND",ACCOUNT_INACTIVE_VERIFICATION_REQUIRED:"ACCOUNT_INACTIVE_VERIFICATION_REQUIRED",ACCOUNT_IS_CHILDED:"ACCOUNT_IS_CHILDED",ACCOUNT_MAPPING_NOT_FOUND:"ACCOUNT_MAPPING_NOT_FOUND",ACCOUNT_MAPPING_NOT_FOUND_AND_EMAIL_NOT_FOUND:"ACCOUNT_MAPPING_NOT_FOUND_AND_EMAIL_NOT_FOUND",ACCOUNT_MAPPING_NOT_FOUND_BUT_EMAIL_FOUND:"ACCOUNT_MAPPING_NOT_FOUND_BUT_EMAIL_FOUND",ACCOUNT_MAPPING_NOT_MAPPED_PROFILE_DELETE_REQUESTED:"ACCOUNT_MAPPING_NOT_MAPPED_PROFILE_DELETE_REQUESTED",AUTHORIZATION_ACCOUNT_LOCKED_OUT:"AUTHORIZATION_ACCOUNT_LOCKED_OUT",AUTHORIZATION_ACCOUNT_SECURITY_LOCKED_OUT:"AUTHORIZATION_ACCOUNT_SECURITY_LOCKED_OUT",AUTHORIZATION_BAD_EXTERNAL_TOKEN:"AUTHORIZATION_BAD_EXTERNAL_TOKEN",AUTHORIZATION_CREDENTIALS:"AUTHORIZATION_CREDENTIALS",AUTHORIZATION_EXTERNAL_ID_MISMATCH:"AUTHORIZATION_EXTERNAL_ID_MISMATCH",AUTHORIZATION_INVALID_NETWORK:"AUTHORIZATION_INVALID_NETWORK",AUTHORIZATION_INVALID_OR_EXPIRED_TOKEN:"AUTHORIZATION_INVALID_OR_EXPIRED_TOKEN",AUTHORIZATION_INVALID_REFRESH_TOKEN:"AUTHORIZATION_INVALID_REFRESH_TOKEN",AUTHORIZATION_MASE_ERROR:"AUTHORIZATION_MASE_ERROR",AUTHORIZATION_PARENTAL_CONSENT_REQUIRED:"AUTHORIZATION_PARENTAL_CONSENT_REQUIRED",AUTHORIZATION_OTP_VERIFICATION_REQUIRED:"AUTHORIZATION_OTP_VERIFICATION_REQUIRED",CLIENT_CONFIG_ERROR:"CLIENT_CONFIG_ERROR",CONTACT_CSR:"CONTACT_CSR",DEVICE_LINK_INVALID_OTP_CODE:"DEVICE_LINK_INVALID_OTP_CODE",DEVICE_LINK_LOCKOUT_REACHED:"DEVICE_LINK_LOCKOUT_REACHED",DISALLOWED_VALUE:"DISALLOWED_VALUE",GUEST_GATED_AGEBAND:"GUEST_GATED_AGEBAND",GUEST_GATED_BOTH_EMAIL_VERIFICATION:"GUEST_GATED_BOTH_EMAIL_VERIFICATION",GUEST_GATED_EMAIL:"GUEST_GATED_EMAIL",GUEST_GATED_EMAIL_VERIFICATION:"GUEST_GATED_EMAIL_VERIFICATION",GUEST_GATED_EMBARGOED:"GUEST_GATED_EMBARGOED",GUEST_GATED_LOCATION:"GUEST_GATED_LOCATION",GUEST_GATED_PARENT_EMAIL_VERIFICATION:"GUEST_GATED_PARENT_EMAIL_VERIFICATION",GUEST_GATED_UNKNOWN:"GUEST_GATED_UNKNOWN",INUSE_VALUE:"INUSE_VALUE",INVALID_SESSION_TRANSFER_KEY:"INVALID_SESSION_TRANSFER_KEY",INVALID_PASSWORD_USING_PROFILE_INFORMATION:"INVALID_PASSWORD_USING_PROFILE_INFORMATION",INVALID_PASSWORD_PASSWORD_SAME_AS_USERNAME:"INVALID_PASSWORD_PASSWORD_SAME_AS_USERNAME",INVALID_PASSWORD_PASSWORD_SAME_AS_FIRSTNAME:"INVALID_PASSWORD_PASSWORD_SAME_AS_FIRSTNAME",INVALID_PASSWORD_PASSWORD_SAME_AS_LASTNAME:"INVALID_PASSWORD_PASSWORD_SAME_AS_LASTNAME",INVALID_VALUE:"INVALID_VALUE",INVALID_VALUE_LIKE_EMAIL:"INVALID_VALUE_LIKE_EMAIL",INVALID_VALUE_PASSWORD_SIZE:"INVALID_VALUE_PASSWORD_SIZE",INVALID_VALUE_PASSWORD_CREDITCARD:"INVALID_VALUE_PASSWORD_CREDITCARD",INVALID_VALUE_PASSWORD_PHONE_NUMBER:"INVALID_VALUE_PASSWORD_PHONE_NUMBER",INVALID_VALUE_PASSWORD_LIKE_PHONE_NUMBER:"INVALID_VALUE_PASSWORD_LIKE_PHONE_NUMBER",INVALID_VALUE_PASSWORD_TOO_COMMON:"INVALID_VALUE_PASSWORD_TOO_COMMON",INVALID_VALUE_PASSWORD_TOO_SHORT:"INVALID_VALUE_PASSWORD_TOO_SHORT",INVALID_VALUE_PASSWORD_TOO_LONG:"INVALID_VALUE_PASSWORD_TOO_LONG",INVALID_VALUE_PASSWORD_MISSING_EXPECTED_CHARS:"INVALID_VALUE_PASSWORD_MISSING_EXPECTED_CHARS",INVALID_VALUE_PASSWORD_TRIM:"INVALID_VALUE_PASSWORD_TRIM",INVALID_SIZE:"INVALID_SIZE",LOGIN_VALUE_INVALID:"LOGIN_VALUE_INVALID",MARKETING_LONG_FORM_ENABLED:"MARKETING_LONG_FORM_ENABLED",MISSING_VALUE:"MISSING_VALUE",NRT_ACCOUNT:"NRT_ACCOUNT",PASSWORDS_DONT_MATCH:"PASSWORDS_DONT_MATCH",PHONE_NOT_FOUND:"PHONE_NOT_FOUND",PHONE_NOT_VERIFIED:"PHONE_NOT_VERIFIED",PHONE_VERIFICATION_NOT_ALLOWED:"PHONE_VERIFICATION_NOT_ALLOWED",PPU_LEGAL:"PPU_LEGAL",PPU_MARKETING:"PPU_MARKETING",PPU_SECURITY:"PPU_SECURITY",PROFILE_DISABLED:"PROFILE_DISABLED",PROFILE_NOT_FOUND:"PROFILE_NOT_FOUND",PROFILE_USER_BANNED:"PROFILE_USER_BANNED",RATE_LIMITED:"RATE_LIMITED",RATE_LIMITED_API:"RATE_LIMITED_API",SERVICE_ERROR:"SERVICE_ERROR",SYSTEM_UNAVAILABLE:"SYSTEM_UNAVAILABLE",TOKEN_TOO_SHORT:"TOKEN_TOO_SHORT",UNKNOWN_ACCOUNT_STATUS:"UNKNOWN_ACCOUNT_STATUS",UNKNOWN_ERROR:"UNKNOWN_ERROR",VALID_ETAG_REQUIRED:"VALID_ETAG_REQUIRED"},Ge={isPPU:[be.PPU_MARKETING,be.PPU_LEGAL],isMarketingPPU:[be.PPU_MARKETING],isGating:[be.GUEST_GATED_AGEBAND,be.GUEST_GATED_UNKNOWN,be.GUEST_GATED_EMBARGOED,be.GUEST_GATED_EMAIL,be.GUEST_GATED_LOCATION,be.GUEST_GATED_BOTH_EMAIL_VERIFICATION,be.GUEST_GATED_EMAIL_VERIFICATION,be.GUEST_GATED_PARENT_EMAIL_VERIFICATION,be.AUTHORIZATION_ACCOUNT_LOCKED_OUT,be.ACCOUNT_MAPPING_NOT_MAPPED_PROFILE_DELETE_REQUESTED,be.PROFILE_DISABLED,be.ACCOUNT_IS_CHILDED,be.PROFILE_USER_BANNED],isGeoGated:[be.GUEST_GATED_LOCATION],isVerifyEmailGated:[be.GUEST_GATED_BOTH_EMAIL_VERIFICATION,be.GUEST_GATED_EMAIL_VERIFICATION,be.GUEST_GATED_PARENT_EMAIL_VERIFICATION],isAgebandGated:[be.GUEST_GATED_AGEBAND],isBanned:[be.PROFILE_USER_BANNED],isDisabled:[be.PROFILE_DISABLED,be.ACCOUNT_MAPPING_NOT_MAPPED_PROFILE_DELETE_REQUESTED],isSecurityFlagged:[be.AUTHORIZATION_ACCOUNT_SECURITY_LOCKED_OUT],isPil2:[be.AUTHORIZATION_PARENTAL_CONSENT_REQUIRED],isAccountMappingError:[be.ACCOUNT_MAPPING_NOT_FOUND_BUT_EMAIL_FOUND,be.NRT_ACCOUNT,be.DISALLOWED_VALUE,be.UNKNOWN_ACCOUNT_STATUS],isActionableInputError:[be.MISSING_VALUE,be.INVALID_VALUE,be.INUSE_VALUE,be.DISALLOWED_VALUE],isAccountMappingNotFoundError:[be.ACCOUNT_MAPPING_NOT_FOUND,be.ACCOUNT_MAPPING_NOT_FOUND_AND_EMAIL_NOT_FOUND],isAuthorizationError:[be.AUTHORIZATION_CREDENTIALS,be.AUTHORIZATION_BAD_EXTERNAL_TOKEN,be.AUTHORIZATION_EXTERNAL_ID_MISMATCH],isMarketingLongform:[be.MARKETING_LONG_FORM_ENABLED],isEtagMismatch:[be.VALID_ETAG_REQUIRED],isServiceError:[be.SERVICE_ERROR,be.UNKNOWN_ERROR,be.SYSTEM_UNAVAILABLE],isLockedOut:[be.AUTHORIZATION_ACCOUNT_LOCKED_OUT],isMase:[be.AUTHORIZATION_MASE_ERROR],isOtpAuthError:[be.PHONE_NOT_FOUND,be.PHONE_NOT_VERIFIED,be.PHONE_VERIFICATION_NOT_ALLOWED],isOtpCodeLockedOut:[be.DEVICE_LINK_LOCKOUT_REACHED],isOtpRequired:[be.AUTHORIZATION_INVALID_NETWORK,be.ACCOUNT_INACTIVE_VERIFICATION_REQUIRED],isInvalidLoginValue:[be.LOGIN_VALUE_INVALID,be.PROFILE_NOT_FOUND],isInvalidOtpCode:[be.DEVICE_LINK_INVALID_OTP_CODE],isInvalidAccessToken:[be.AUTHORIZATION_INVALID_OR_EXPIRED_TOKEN],isInvalidRefreshToken:[be.AUTHORIZATION_INVALID_REFRESH_TOKEN],isInvalidRecaptchaToken:[be.TOKEN_TOO_SHORT],isInvalidSessionTransferKeyError:[be.INVALID_SESSION_TRANSFER_KEY],isRateLimited:[be.RATE_LIMITED,be.RATE_LIMITED_API]},Me={ACTIONABLE_INPUT:"ACTIONABLE_INPUT",AC_OR_CONFIG_ERROR:"AC_OR_CONFIG_ERROR",ADVISORY:"ADVISORY",AUTHORIZATION_OTP_VERIFICATION_REQUIRED:"AUTHORIZATION_OTP_VERIFICATION_REQUIRED",FAILURE_BY_DESIGN:"FAILURE_BY_DESIGN",FAILURE_CONTACT_CSR:"FAILURE_CONTACT_CSR",GC_CODE_OR_CONFIG_ERROR:"GC_CODE_OR_CONFIG_ERROR",GUEST_BLOCKED:"GUEST_BLOCKED",INVALID_INPUT:"INVALID_INPUT",PPU_ACTIONABLE_INPUT:"PPU_ACTIONABLE_INPUT",SYSTEM_UNAVAILABLE:"SYSTEM_UNAVAILABLE",UNAUTHORIZED:"UNAUTHORIZED",UNKNOWN_ERROR:"UNKNOWN_ERROR"},Ve={CHILD:"CHILD",TEEN:"TEEN",ADULT:"ADULT"},Fe="reduced",xe={MACHINE_GENERATED:"MACHINE_GENERATED",GUEST_GENERATED:"GUEST_GENERATED"};function Be(e){const t=(0,u.U2)(e,"error.errors"),n=(0,u.U2)(e,"error.keyCategory");return!t||!n||!(0,u.U2)(t,"length")?[]:t.filter((function(e){return e.category===n}))}function $e(e){const t={[be.MISSING_VALUE]:e=>e.inputName,[be.PPU_LEGAL]:e=>{var t;return((null===(t=e.data)||void 0===t?void 0:t.disclosures)||[]).map((e=>e.disclosureCode)).join()},[be.PPU_MARKETING]:e=>{var t;return((null===(t=e.data)||void 0===t?void 0:t.entities)||[]).map((e=>e.code)).join()}};return e.map((e=>{const n=t[e.code]&&t[e.code](e);return n?`${e.code}:${n}`:e.code})).join(";")}function je(e,t){return function(e,t,n=null){if(!Array.isArray(e))return[];Array.isArray(t)||(t=[t]);n&&!Array.isArray(n)&&(n=[n]);return(e||[]).filter((e=>-1!==t.indexOf(e.code)&&(!n||-1!==n.indexOf(e.inputName))))}(e,t)[0]}const Ke={};function He(e,t){Ke[e]=t}function We(e){return Ke[e]}function qe(e){delete Ke[e]}function Ye(){for(const e in Ke)delete Ke[e]}function Ze(e){if(e)return ze().then((t=>{const{s2CookieName:n,s2Domain:o}=t,r=T.getCookieDomain(),s=new Date(Date.now());s.setFullYear(s.getFullYear()+ue.LONG_COOKIE_YEAR_TIMEOUT),g(n,e,o,"/",s),A(n)!==e&&r&&g(n,e,r,"/",s)}))}function ze(){return ve().then((e=>{const{clientInfo:t={}}=e,n=t["s2-domain"]||window.location.hostname,o=t["s2-namespace"];return{s2CookieName:o?`${o}_${F.S2}`:F.S2,s2Domain:n,s2Namespace:o}}))}let Qe={language:null,featureFlags:["no-password-reuse"],endpoint:null,clientId:null};const Xe=new b(ke),Je=Xe;function et(e){e.response.parsedErrors=function(e){if(!e)return null;const t=Be(e),n=(0,u.U2)(e,"error.keyCategory");let o={};switch(Object.keys(Ge).forEach((e=>{je(t,Ge[e])&&(o[e]=!0)})),n){case Me.PPU_ACTIONABLE_INPUT:o.isPPU=!0;break;case Me.ADVISORY:o.isAdvisoryError=!0;break;case Me.ACTIONABLE_INPUT:o.isActionableInputError=!0;const e=t.reduce(((e,t)=>{if(!t||!t.inputName)return e;const n=`${t.inputName}`,o=n.startsWith("profile.addresses"),r=(0,u.U2)(t,"data.type");if(o&&r){const o=`addresses.${r}.${n.replace(/.*\./,"")}`;return Object.assign(e,{[o]:t.code})}if(!o){const o=n.replace(/.*\./,"");return Object.assign(e,{[o]:t.code})}return e}),{});o.clientErrors=Object.keys(e).length?e:null,o.clientErrorsRawInputNames=t.filter((e=>e.inputName)).map((e=>e.inputName))}const r=(0,u.U2)(je(t,be.AUTHORIZATION_CREDENTIALS),"data")||{};o.isAuthorizationError&&r.passwordOrigin===xe.MACHINE_GENERATED&&(o.isLoginSetPassword=!0);const s=e.isValid&&!e.isValid(),i=500===e.status;return(s||i||n===be.SYSTEM_UNAVAILABLE)&&(o.isServiceError=!0),t.forEach((e=>{e.code===be.INVALID_VALUE&&"profile.region"===e.inputName&&(o.isInvalidRegionError=!0)})),0===Object.keys(o).length&&(o=null),o&&!o.clientErrors&&(o.clientErrors=null,o.clientErrorsRawInputNames=null),o}(e.response),(0,u.U2)(e.response.parsedErrors,"isPPU")&&He("ppuErrors",(0,u.U2)(e.response,"error.errors"))}let tt;Je.addRequestMutator((e=>{e.request.headers={...e.request.headers,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache",Expires:"-1"};const t=(0,u.U2)(V(),"debug.geoIP");t&&(e.request.headers["x-forwarded-for"]=t)})),Je.addRequestMutator((e=>{e.request.query.langPref=Qe.language})),Je.addRequestMutator((e=>{e.request.query.feature=Qe.featureFlags})),Je.addRequestMutator((e=>{e.request.url=`${Qe.endpoint}/client/${Qe.clientId}${e.request.url}`})),Je.addRequestMutator((e=>{tt=(0,u.Vj)();const t=We("workflowOptions"),n=(0,u.U2)(t,"options.optionalConfigs.reporting.conversationId")||(0,u.Vj)();e.request.headers={...e.request.headers,"conversation-id":n,"correlation-id":tt}})),Je.addRequestMutator((e=>{if(!e.request.headers.authorization)return new Promise((t=>{ee.then((n=>{n.call("responder","get.cookie",`${Qe.clientId}.${F.API}`).then((n=>{n&&(e.request.headers.authorization=`APIKEY ${n}`),t()})).catch((()=>t()))}))}))})),Je.addRequestMutator((e=>{const t=We("workflowOptions");if(t){const n=(0,u.U2)(t,"options.optionalConfigs.reporting");e.request.headers={...e.request.headers,"oneid-reporting":(0,u.uP)(n)}}})),Je.addRequestMutator((e=>{e.newRelicLog=ye(e.request.eventName||"missing_action_name")})),Je.addResponseMutator((e=>{const{errorCodes:t,keyCategory:n,statusCode:o}=function(e){const t=(0,u.U2)(e,"error.keyCategory")||"";return{errorCodes:((0,u.U2)(e,"error.errors")||[]).map((e=>{let t=e.code;e.inputName&&(t+=`:${e.inputName}`);const n=(0,u.U2)(e,"data.disclosures");return n&&n.forEach((e=>{t+=`:${e.disclosureCode}`})),t}))||[],keyCategory:t,statusCode:(0,u.U2)(e,"status")||null}}(e.response),r=We("logoutType"),i={[fe.ERROR_CATEGORY]:n,[fe.ERROR_CODES]:t.join(","),[fe.TRANSACTION_ID]:tt};r&&(i[fe.INFO]=`logoutType(${r})`,qe("logoutType")),!o||o>=400&&o<500||o>=200&&o<300||(i[fe.PROBLEM]=!0),s.debug("sending log : ",JSON.stringify(i,null,2)),e.newRelicLog.send(i),e.request.storeResponseKey&&He(e.request.storeResponseKey,e.response)})),Je.addResponseMutator((e=>{const t=e.response&&e.response.headers["api-key"];if(t){const e=new Date;e.setDate(e.getDate()+1),ee.then((n=>n.message("responder","set.cookie",{key:`${Qe.clientId}.${F.API}`,value:t,expires:e})))}})),Je.addResponseMutator((e=>{const t=(0,u.U2)(e.response,"data.s2");t&&Ze(t)})),Je.addResponseMutator((e=>{et(e)}));const nt={ALREADY_INITIALIZED:"Already initialized",CALLBACK_MISMATCH:"Network Connect Callback URI does not match origin",CONFIG_SET:"Configuration options have already been set",CROSS_FRAME_COMMUNICATION_TIMEOUT:"Could not initialize cross frame communication",DISNEYID_DEPRECATED:"`DisneyID` global object is soon to be deprecated. Use `OneID` instead.",INNER_APP_TIMEOUT:"OneID app timed out",INVALID_ARGUMENT:"Invalid argument",INVALID_COOKIE_DOMAIN:"Provided cookieDomain is invalid",INVALID_PAIRING_CODE:"INVALID_PAIRING_CODE",MISSING_PAIRING_CODE:"MISSING_PAIRING_CODE",MISSING_REFRESH_TOKEN:"MISSING_REFRESH_TOKEN",NO_CALLBACK:"No Network Connect Callback URI passed",NO_CLIENT_ID:"clientId not provided",NO_CONFIG_OPTIONS:"No configuration options provided",NO_DATA:"NO_DATA",NO_PROFILE:"Could not read guest profile data",NO_RESPONDER_PAGE:"responderPage not provided",NO_SITE_CONFIG:"Could not get site config",NO_VALID_CAMPAIGN:"NO_VALID_CAMPAIGN",NOT_ENABLED:"Not enabled",NOT_IMPLEMENTED:"Not implemented",NOT_INITIALIZED:"Not initialized",PROFILE_UPDATE_INVALID:"PROFILE_UPDATE_INVALID",SESSION_ESTABLISHED:"Session already established",SESSION_NOT_ESTABLISHED:"Session not established",UNKNOWN_ERROR:"An unknown error occurred",UNSUPPORTED_LOCALE:"Unsupported locale"},ot={FAILURE_BY_DESIGN:"FAILURE_BY_DESIGN",UNKNOWN_ERROR:"UNKNOWN_ERROR"};function rt(e){return new Promise(((t,n)=>{Xe.licensePlatePeek(e).then((e=>{if((0,u.U2)(e,"parsedErrors.isActionableInputError"))return n({errorCodes:nt.INVALID_PAIRING_CODE});t(e)})).catch((()=>n({errorCodes:ot.UNKNOWN_ERROR})))}))}function st(){const{clientId:e,langPref:t,cssOverride:n,debug:o={}}=V(),{country:r,disableSetFocus:s,dynamicConfigOverride:i,siteConfigOverride:a,geoIP:c,iOSAutomation:u,testProfileFlag:l,disableFocusLock:d,showL10nKeys:E,gcEndpoint:_}=o,p=window.ONEID_WEB_SDK_MIGRATION?"bundleMigration":"bundle",f=A(I.LOG_LEVEL)||"INFO",h=A(I.FEATURE_FLAGS),O=ae.replace("https://ui-qa.registerdisney","https://uiv4-qa.registerdisney"),g=new URL(O);return g.pathname=`${g.pathname}/${p}/web/${e}/${t}`,n&&g.searchParams.append("cssOverride",n),r&&g.searchParams.append("countryCode",r),i&&g.searchParams.append("dynamicConfigOverride",JSON.stringify(i)),a&&g.searchParams.append("siteConfigOverride",JSON.stringify(a)),f&&g.searchParams.append("logLevel",f),u&&g.searchParams.append("iOSAutomation","true"),l&&g.searchParams.append("testProfileFlag","Y"),c&&g.searchParams.append("geoIP",c),h&&g.searchParams.append("featureFlags",h),s&&g.searchParams.append("disableSetFocus","true"),d&&g.searchParams.append("disableFocusLock","true"),E&&g.searchParams.append("showL10nKeys","true"),_&&g.searchParams.append("gcEndpoint",_),g.href}function it(){const{clientId:e,responderPage:t}=V(),n=ce(),o=new URL(t);return o.searchParams.append("clientId",e),o.searchParams.append("environment",n),o.href}const at=function(){const e=document.querySelector("html"),t=document.createElement("style");let n;return{showLightbox:function(){e&&e.classList.add("oneid-lightbox-open"),n.style.display="block",n.style.width="100%",n.style.height="100%",n.classList.add("state-active"),n.querySelector("#oneid-iframe").focus()},hideLightbox:function(){e&&e.classList.remove("oneid-lightbox-open"),n.style.display="none",n.classList.remove("state-active"),document.getElementById("oneid-iframe").blur()},createInner:function(){const e=/(ipad|iphone|ipod)/gi.test(navigator.userAgent);t.setAttribute("id","oneid-style"),t.setAttribute("type","text/css"),t.innerHTML=`\n    div#oneid-wrapper {\n      position: ${e?"absolute":"fixed"};\n      top: 0;\n      left: 0;\n      /* This is here to render the images before showing the iframe */\n      width: 1px;\n      height: 1px;\n    }\n    div#oneid-wrapper.state-active {\n      z-index: 9999999;\n      opacity: 1;\n      transition: opacity 300ms;\n      -webkit-transition: opacity 300ms;\n    }\n    iframe#oneid-iframe {\n      width: 100%;\n      height: 100%;\n    }\n\n    ${e?"body {min-height: 100% !important;}":""}\n\n    html.oneid-lightbox-open {\n      overflow: hidden;\n      ${e?"height: 100%;":""}       \n    }\n\n    html.oneid-lightbox-open body {\n      overflow: hidden;\n      ${e?"height: 100%;":""}\n    }\n    `;const r=o({name:"oneid-iframe",title:"Account",documentURL:st()});return n=document.createElement("div"),n.setAttribute("id","oneid-wrapper"),n.appendChild(r),ct().then((()=>{document.head.appendChild(t),document.body.appendChild(n),n.style.display="none"})),r},createResponder:function(){const e=o({name:"oneid-secure-responder",documentURL:it()});return e.style.display="none",ct().then((()=>{document.body.appendChild(e)})),e}};function o({name:e,title:t="",documentURL:n}){const o=document.createElement("iframe");return o.setAttribute("id",e),o.setAttribute("name",e),o.setAttribute("frameborder","0"),o.setAttribute("title",t),o.setAttribute("src",n),o}}();function ct(){return new Promise((e=>{const{readyState:t}=document;if("complete"===t||"loaded"===t||"interactive"===t)return e();document.addEventListener("DOMContentLoaded",(()=>e()),{once:!0})}))}function ut(){return Et(ue.LAUNCH_METHOD_TIMEOUT)}function lt(e,t){if(!t)return!1;const n=e.newsletters;s.debug("newslettersConfig :",n);for(const e of Object.values(n))if(Object.keys(e||{}).includes(t))return!0;return!1}function dt(){return ve().then((e=>e?Promise.resolve():Promise.reject({errorCodes:nt.NO_SITE_CONFIG})))}function Et(e=3e4,t=nt.INNER_APP_TIMEOUT){let n;const o=Object.assign(new Promise(((r,s)=>{n=setTimeout((()=>{s({errorCodes:t}),o.wasRejected=!0}),e)})),{cancel:()=>(clearTimeout(n),this)});return o}function _t(e,t={}){var n,o;const r=V(),s=(0,u.U2)(e,"optionalConfigs.displayOptions.cssContext"),i=null!==(n=null!==(o=(0,u.U2)(e,"optionalConfigs.displayOptions.darkMode"))&&void 0!==o?o:(0,u.U2)(r,"optionalConfigs.displayOptions.darkMode"))&&void 0!==n?n:(0,u.U2)(window.BrandingConfig,"branding.brand.darkMode"),a=(0,u.U2)(e,"optionalConfigs.displayOptions.suppressCreateAccountOpt"),c=(0,u.U2)(e,"optionalConfigs.displayOptions.hideCloseButtonEverywhere");if(void 0!==s)if((0,u.kH)(s))t.displayOptions={...t.displayOptions,cssContext:s};else{ye(fe.LOG_INVALID_DISPLAY_OPTION).send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:"cssContext",[fe.INFO]:`cssContext(${s})`})}if(void 0!==i)if("boolean"===typeof i)t.displayOptions={...t.displayOptions,darkMode:i};else{ye(fe.LOG_INVALID_DISPLAY_OPTION).send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:"darkMode",[fe.INFO]:`darkMode(${i})`})}return void 0!==c&&"boolean"===typeof c&&(t.displayOptions={...t.displayOptions,hideCloseButtonEverywhere:c}),void 0!==a&&"boolean"===typeof a&&(t.displayOptions={...t.displayOptions,suppressCreateAccountOpt:a}),t.options=Se(),t.allowSkip=!!(0,u.U2)(e,"allowSkip"),t}function pt(){return A(F.OBO)}function ft(){return s.debug("[OBO Cookie] - delete obo cookie",F.OBO,R()),O(F.OBO,R(),"/")}var ht=n(0),It=n.n(ht);const At={ADULT:"X",TEEN:"Y",CHILD:"Z"};function Ot(e){if(!e)return Promise.resolve();const{clientId:t}=V(),n=`${t}-${ce()}.${F.IDENTIFIER}`;return ee.then((t=>t.call("responder","set.cookie",{key:n,value:e,expires:0,secure:!0}).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-lib-cookies-identity)",[fe.STACK_TRACE]:t})}))))}const gt="00";function Tt(){const{clientId:e}=V(),t=ce();try{localStorage.removeItem(`${e}-${t}.guest`)}catch(e){}}function Rt(){return We("tokenData")?Nt():le().then((e=>{if(e&&!q(e))return He("tokenData",e),Nt()}))}function Nt(){const{clientId:e}=V(),t=ce();return function(){const{clientId:e}=V(),t=`${e}-${ce()}.${F.IDENTIFIER}`;return ee.then((e=>e.call("responder","get.cookie",t).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-lib-cookies-identity)",[fe.STACK_TRACE]:t})}))))}().then((n=>{const o=We("tokenData"),r=(0,u.U2)(o,"access_token");if(!r||!n)return;const s=function(e,t,n,o){let r=null;try{r=localStorage.getItem(`${n}-${o}.guest`)}catch(e){}return function(e,t,n){let o=null;try{o=JSON.parse(It().decrypt(e.substring(gt.length)+t,n))}catch(e){}return o}(`${e}`,t,r)}(n,r,e,t);if(!s)return mt();return(0,u.t8)(s,"guest.token",o)}))}function mt(){const{clientId:e}=V(),t=ce(),n=We("tokenData"),o=(0,u.U2)(n,"access_token"),r=(0,u.U2)(n,"swid");return Xe.getGuest({accessToken:o,swid:r}).then((r=>{if(200!==r.status)return null;const s=(0,u.U2)(r.data,"token")||n,i={...r.data,token:s};He("getGuestResponse",r),He("guest",i);return Ot(yt({guest:i,token:s},o,e,t)),i}))}function St(e,t){return new Promise((n=>{const o=(0,u.U2)(e,"guest");if(!o)return;let r;r=t?function(e){if(!e)return Promise.resolve();const{clientId:t}=V(),n=ce(),o=new Date(Date.now());o.setFullYear(o.getFullYear()+ue.LONG_COOKIE_YEAR_TIMEOUT);const r=H({token:e});return ee.then((e=>e.call("responder","set.cookie",{key:`${t}-${n}.${F.TOKEN}`,value:r,expires:o,secure:!0}).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`)}))))}(e.token):Promise.resolve();const{clientId:i}=V(),a=ce();let c;c=(0,u.U2)(e,"token.access_token")?Promise.resolve(e):le();const l=function(e){const t=At[(0,u.U2)(e,"profile.ageBand")||""],n=(0,u.U2)(e,"profile.region")||(0,u.U2)(e,"profile.countryCodeDetected"),o=t+n,{clientId:r}=V(),i=ce();if(!t||!n||!e)return Promise.resolve();const a=new Date(Date.now());return a.setFullYear(a.getFullYear()+ue.LONG_COOKIE_YEAR_TIMEOUT),ee.then((e=>e.call("responder","set.cookie",{key:`${r}-${i}-${F.AGEBAND_COUNTRY}`,value:o,expires:a}).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-lib-cookies-ageBandCountry)",[fe.STACK_TRACE]:t})}))))}(o);Promise.all([c,r,l]).then((t=>{Ot(yt(e,(0,u.U2)(t[0],"token.access_token"),i,a)).then(n),He("wasLoggedIn",!0),He("guest",o)}))}))}function yt(e,t,n,o){const r=function(e,t){const n=(0,u.d9)(e),o=JSON.stringify(n),r=(0,u.kn)(JSON.stringify({guest:e.guest})).toString(16);return{data:It().encrypt(r+t,o),checksum:gt+r}}({guest:e.guest,created:(new Date).toISOString()},t);try{localStorage.setItem(`${n}-${o}.guest`,r.data)}catch(e){}return r.checksum}const Ct={API:"api",INVALID_ACCESS_TOKEN:"invalid_access_token",INVALID_REFRESH:"invalid_refresh",LOGGED_OUT_IN_OTHER_TAB:"logged_out_in_other_tab",REAUTH_CHANGE_ACCOUNT:"reauth_change_account",OBO:"obo_logout",GET_GUEST_GC_ERROR:"get_guest_gc_error",GET_GUEST_SESSION_ERROR:"get_guest_session_error",GET_GUEST_MISSING_SESSION_DATA:"get_guest_missing_session_data",GULC:"gulc",UNKNOWN:"unknown"};function Lt(e,t={}){const{clientId:n}=V(),o=ce(),r=t.refresh_token,s=[];return r&&s.push({clientId:`${n}-${o}`,token:r}),e&&s.length?Xe.logout({swid:e,tokenAndClientIds:s}):Promise.resolve()}const wt={AGE_GATED:"age-gated",CLOSE:"close",CREATE:"create",EMAIL_VERIFICATION:"email-verification",ERROR:"error",INIT:"init",LOGIN:"login",LOGOUT:"logout",LOW_TRUST:"low-trust",OPT_IN:"opt-in",REAUTH:"reauth",REFRESH:"refresh",UPDATE:"update"};function Pt(e){const t=e||Ct.UNKNOWN,n=`reason(${t})`;De(wt.LOGOUT,t,n)}function Dt(e){const{clientId:t}=V(),n=ce(),o=We("logoutReason");return He("loggedIn",!1),Rt().then((r=>(Tt(),Lt((0,u.U2)(r,"profile.swid"),(0,u.U2)(r,"token")).then((()=>ee.then((r=>(r.message("inner","guest.logout"),x((0,u.Vj)()),r.call("responder","guest.logout",`${t}-${n}`).finally((()=>(Pt(o),e("done"))))))))))))}const vt=[{readToken:{stepExecution:function(e){return le().then((t=>t?(He("tokenData",t),(0,u.U2)(t,"access_token")&&!q(t)?e("readGuestFromLocalStorage"):(He("logoutType","norefresh"),He("logoutReason",Ct.GET_GUEST_SESSION_ERROR),void e("forceLogout"))):e())).catch((()=>e()))},results:{readGuestFromLocalStorage:"readGuestFromLocalStorage",forceLogout:"forceLogout"}}},{readGuestFromLocalStorage:{stepExecution:function(e){const t=We("workflowOptions"),n=(0,u.U2)(t,"forceRefresh"),o=(0,u.U2)(t,"fullPayloadRequested");Nt().then((t=>{if(!t)return e("getGuestFromGuestController");t&&He("guest",t);const r=(0,u.U2)(t,"token.created"),s=!!r&&new Date(r).getTime()+ue.GUEST_TOKEN_TIMEOUT<Date.now(),i=(0,u.U2)(t,"payload")===Fe;if(s||n||i&&o)return e("getGuestFromGuestController");e()}))},results:{getGuestFromGuestController:"getGuestFromGuestController"}}},{getGuestFromGuestController:{stepExecution:function(e){const t=We("tokenData"),n=We("guest")||{token:t},o=(0,u.U2)(n,"token.access_token"),r=(0,u.U2)(n,"token.swid")||(0,u.U2)(n,"profile.swid");return o&&r?Xe.getGuest({accessToken:o,swid:r}).then((t=>{He("getGuestResponse",t);const o=(0,u.U2)(t.data,"token")||n.token;if(200===t.status)return He("guest",{...t.data,token:o}),e("saveSession");const r=(0,u.U2)(t,"parsedErrors")||{};return r.isSecurityFlagged||r.isDisabled||r.isInvalidAccessToken?(He("logoutType","getGuest"),He("logoutReason",Ct.GET_GUEST_GC_ERROR),e("forceLogout")):e()})):(He("logoutType","getGuest"),He("logoutReason",Ct.GET_GUEST_MISSING_SESSION_DATA),e("forceLogout"))},results:{forceLogout:"forceLogout",saveSession:"saveSession"}}},{forceLogout:{stepExecution:Dt,results:{}}},{saveSession:{stepExecution:function(e){const t=We("guest")||{};return t&&t.token?St({guest:t,token:t.token}).then(e):e()},results:{}}}];const Ut="/";function kt(){const{clientId:e}=V(),t=`${e}-${ce()}`;return`${F.MUTEX}${(0,u.kn)(t).toString(16)}`}function bt(){return A(kt())}function Gt(){return new Promise((e=>{if(bt())return s.debug("Mutex#cookie already present"),e(!1);setTimeout((()=>{if(bt())return s.debug("Mutex#cookie already present"),e(!1);s.debug("Mutex#setting cookie");const t=new Date(Date.now()+ue.MUTEX_TIMEOUT);return g(kt(),"0",T.getCookieDomain(),Ut,t),e(!0)}),Math.floor(1e3*Math.random()+1e3))}))}let Mt=!1;function Vt(){return Mt}function Ft(e){Mt=!!e}function xt(e,t){const n=new Date(Date.now());return e.token=t,e.token.created=n.toISOString(),e.token.lastChecked=e.token.created,e.token.expires=new Date(e.token.exp).toISOString(),e.token.refresh_expires=new Date(e.token.refresh_exp).toISOString(),St({guest:e,token:e.token},!0)}const Bt=[{readToken:{stepExecution:function(e){return le().then((n=>n?(He("tokenData",n),Z(n)?(0,u.U2)(n,"refresh_token")?e("acquireMutex"):(He("logoutType","norefresh"),t(),void e("ensureLoggedOut")):(t(),e("emitRefreshEvent"))):e())).catch((()=>e()));function t(){He("mutexAttempt",0)}},results:{ensureLoggedOut:"ensureLoggedOut",acquireMutex:"acquireMutex",emitRefreshEvent:"emitRefreshEvent"}}},{ensureLoggedOut:{stepExecution:Dt,results:{done:"releaseMutex"}}},{acquireMutex:{stepExecution:function(e){const t=We("mutexAttempts")+1||1;return He("mutexAttempts",t),t>ue.MAX_MUTEX_ATTEMPTS?(s.debug("acquireMutex#max attempts reached"),n(),e("ensureGuestLoggedOut")):Gt().then((t=>{if(!t)return s.debug("acquireMutex#could not acquire"),setTimeout((()=>{e("readToken")}),ue.MUTEX_WAIT_INTERVAL);n(),e("refreshToken")}));function n(){He("mutexAttempts",0)}},results:{readToken:"readToken",ensureGuestLoggedOut:"ensureLoggedOut",refreshToken:"refreshToken"}}},{refreshToken:{stepExecution:function(e){const t=We("tokenData")||{},n=Vt();return Xe.refreshAuthorization(t.refresh_token).then((t=>{He("tokenRefreshResponse",t);const o=(0,u.U2)(t,"data.token")||{},r=(0,u.U2)(t,"parsedErrors")||{},s=200===t.status&&o.access_token&&o.refresh_token,i=n&&o.access_token&&o.refresh_token;return s||i?Nt().then((t=>(He("tokenData",o),t?xt(t,o).then((()=>e("emitRefreshEvent"))):mt().then((e=>xt(e,o))).then((()=>e("emitRefreshEvent")))))):r.isInvalidRefreshToken?(He("logoutType","norefresh"),He("logoutReason",Ct.INVALID_REFRESH),e("ensureGuestLoggedOut")):r.isSecurityFlagged?(He("logoutType","securityFlagged"),e("ensureGuestLoggedOut")):r.isGating?n?e("ensureGuestLoggedOut"):ee.then((t=>t.call("inner","runWorkflow",{name:"GATING",workflowData:{parsedErrors:r}}).then((()=>(at.showLightbox(),e("ensureGuestLoggedOut")))))):r.isPPU?n?e("ensureGuestLoggedOut"):Promise.all([Rt(),ee]).then((([n,o])=>o.call("inner","runWorkflow",{guest:n,name:"LOGIN",step:"ppuSubflow",workflowData:{parsedErrors:r,ppu:{errors:t.error.errors}}}).then((()=>{at.showLightbox(),e()})))):void 0})).catch((()=>e("releaseMutex")))},results:{ensureGuestLoggedOut:"ensureLoggedOut",releaseMutex:"releaseMutex",emitRefreshEvent:"emitRefreshEvent"}}},{forceRefresh:{stepExecution:function(e){return le().then((t=>{if(!t)return e();He("tokenData",t),e("refreshToken")}))},results:{refreshToken:"refreshToken"}}},{emitRefreshEvent:{stepExecution:function(e){const t=We("tokenData");return De(wt.REFRESH,t),ee.then((n=>{n.message("inner","setGuest",{token:t}),e()})).catch(e)},results:{releaseMutex:"releaseMutex"}}},{releaseMutex:{stepExecution:function(e){O(kt(),T.getCookieDomain(),Ut),qe("tokenData"),e()},results:{}}}];function $t(e){new pe("tokenRefresh",Bt,void 0,(()=>e())).runWorkflow()}const jt={low:0,high:1};function Kt(){return new Promise((e=>{const{clientId:t}=V(),n=ce();ee.then((o=>o.call("responder","get.cookie",`${t}-${n}.${F.TRUST_STATE}`).then((t=>{if(null===t)return e({state:!1});const n=Date.parse(t)-Date.now(),o=n<1?jt.low:jt.high;e({state:o,timeLeft:n})})).catch((e=>{const{message:t}=e||{};s.error(`Error in PatchBay call: ${t}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-lib-cookies-trustState)",[fe.STACK_TRACE]:t})}))))}))}function Ht(e=ue.TRUST_TIMEOUT){const{clientId:t}=V(),n=ce(),o=new Date(Date.now()+e);return ee.then((e=>e.call("responder","set.cookie",{key:`${t}-${n}.${F.TRUST_STATE}`,value:o.toISOString(),expires:o}).catch((e=>{const{message:t}=e||{};s.error(`Error in PatchBay call: ${t}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-lib-cookies-trustState)",[fe.STACK_TRACE]:t})}))))}function Wt(){const{clientId:e}=V(),t=ce();return ee.then((n=>n.call("responder","delete.cookie",{key:`${e}-${t}.${F.TRUST_STATE}`}).catch((e=>{const{message:t}=e||{};s.error(`Error in PatchBay call: ${t}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-lib-cookies-trustState)",[fe.STACK_TRACE]:t})}))))}const qt=e=>St({guest:e,token:e.token},!0);function Yt(e){return function({guest:e,writeSWIDCookie:t,writeGuest:n,writeTrustStateCookie:o}){const r=new Date(Date.now()),s={...e,token:{...e.token,created:r.toISOString(),lastChecked:r.toISOString(),expires:new Date(e.token.exp).toISOString(),refresh_expires:new Date(e.token.refresh_exp).toISOString()}},i=(0,u.U2)(s,"profile.swid"),a=(0,u.U2)(s,"profile.ageBand")===Ve.CHILD;return Promise.all([t(i,a),n(s),o(1e3*s.token.high_trust_expires_in||void 0)])}({guest:e,writeSWIDCookie:x,writeGuest:qt,writeTrustStateCookie:Ht})}function Zt(e,t){s.error(e),Le({[fe.ACTION_NAME]:fe.EVENT_LOGIN_OBO,[fe.ERROR_CATEGORY]:"Unknown",[fe.INFO]:`substep(${t}),message(${(null===e||void 0===e?void 0:e.message)||""})`})}const zt={CHANGE_EMAIL:"CHANGE_EMAIL",CHANGE_PASSWORD:"CHANGE_PASSWORD",DATE_OF_BIRTH_INTERSTITIAL:"DATE_OF_BIRTH_INTERSTITIAL",EMAIL_VERIFICATION:"EMAIL_VERIFICATION",EXPIRED_SESSION:"EXPIRED_SESSION",GALC:"GALC",GATING:"GATING",IDENTITY_FLOW:"IDENTITY_FLOW",LICENSE_PLATE:"LICENSE_PLATE",LOGIN:"LOGIN",MOBILE_VERIFICATION:"MOBILE_VERIFICATION",NEWSLETTERS:"NEWSLETTERS",OTP_LOGIN_RECOVERY:"OTP_LOGIN_RECOVERY",OTP_REQUEST_AND_REDEEM:"OTP_REQUEST_AND_REDEEM",PPU_ADDRESS:"PPU_ADDRESS",PPU_DATE_OF_BIRTH:"PPU_DATE_OF_BIRTH",PPU_MARKETING:"PPU_MARKETING",PPU_PASSWORD:"PPU_PASSWORD",PPU_PROFILE_LEGAL:"PPU_PROFILE_LEGAL",PPU:"PPU",REAUTH:"REAUTH",REGISTRATION:"REGISTRATION",RELOAD_GUEST:"RELOAD_GUEST",SENT_GATING_PIL2:"SENT_GATING_PIL2",SERVICE_ERROR:"SERVICE_ERROR",SET_PPC:"SET_PPC",UPDATE_PROFILE:"UPDATE_PROFILE",REDEEM_SESSION_TRANSFER:"REDEEM_SESSION_TRANSFER",LAUNCH_OTP:"LAUNCH_OTP"};const Qt=[{cleanUpSession:{stepExecution:function(e){le().then((t=>{t&&(!function(){s.debug("[SESSION TOKEN] - Cookie deletion");const e=V(),t=ce();O(`${e&&e.clientId}-${t}.${F.TOKEN}`,R(),"/")}(),Le({[fe.ACTION_NAME]:fe.EVENT_LOGOUT,[fe.INFO]:`reason(${Ct.OBO})`})),e("done")}))},results:{done:"attemptOBOLogin"}}},{attemptOBOLogin:{stepExecution:function(e){const t=A(F.LOWERCASE_SWID),n=pt();s.debug("[OBO Login Attempt]: started obo: ",n," swid: ",t);const o=ye(fe.EVENT_LOGIN_OBO);return Xe.oboLogin({swid:t,oboToken:n}).then((t=>(s.debug("[OBO Login Attempt]: response ",t),ft(),t.status>=400&&t.status<500||(e=>{var t;return((null===(t=e.error)||void 0===t?void 0:t.errors)||[]).some((e=>e.code===be.PPU_MARKETING))})(t)?(He("oboResponse",t),function(e){var t;Le({[fe.ACTION_NAME]:fe.EVENT_LOGIN_OBO,[fe.ERROR_CATEGORY]:(null===(t=e.error)||void 0===t?void 0:t.keyCategory)||"Unknown",[fe.ERROR_CODES]:$e(Be(e))})}(t),void e("failed")):Yt(t.data).then((()=>{s.debug("[OBO Attempt] - Success create session"),o.send({[fe.INFO]:"login_obo_success"}),e("success")})).catch((t=>{Zt(t,"createSession"),e("failed")}))))).catch((t=>{Zt(t,"oboLogin"),ft(),e("failed")}))},results:{failed:"parseErrors"}}},{parseErrors:{stepExecution:function(e){var t,n;const o=We("oboResponse")||{};return(null===o||void 0===o||null===(t=o.parsedErrors)||void 0===t?void 0:t.isPPU)?e("ppu"):(null===o||void 0===o||null===(n=o.parsedErrors)||void 0===n?void 0:n.isGating)?e("gating"):void e()},results:{ppu:"launchPPU",gating:"launchGating"}}},{launchPPU:{stepExecution:function(e){const t=We("oboResponse")||{};return ee.then((n=>n.call("inner","runWorkflow",{guest:t.data,name:zt.LOGIN,step:"ppuSubflow",workflowData:{parsedErrors:t.parsedErrors,ppu:{errors:t.error.errors}}}).then((()=>{at.showLightbox(),e()}))))},results:{}}},{launchGating:{stepExecution:function(e){const t=We("oboResponse")||{};return ee.then((n=>n.call("inner","runWorkflow",{name:zt.GATING,workflowData:{parsedErrors:t.parsedErrors}}).then((()=>{at.showLightbox(),e()}))))},results:{}}},{windowReload:{stepExecution:function(e){s.debug("[OBO Reload] - this app will be reloaded in 2 seconds...");const t=window.location.reload.bind(window.location);setTimeout(t,2e3)},results:{}}}];function Xt(e){const t={data:{email:null,legal:[]},error_codes:null},n=We("workflowOptions")||{};t.data.campaignId=We("promotionID"),He("workflowOptions",{...n,fullPayloadRequested:!0});new pe("getGuest",vt,null,(()=>{const n=We("guest");return n?(t.data.email=n.profile.email,He("responsePayload",t),e("guestIsLoggedIn")):(He("responsePayload",t),e("guestIsNotLoggedIn"))})).runWorkflow()}const Jt={AGE_GATED:"AGE_GATED",ALREADY_OPT_IN:"ALREADY_OPT_IN",INVALID_EMAIL:"INVALID_EMAIL",INVALID_LOCATION:"INVALID_LOCATION",MISSING_OPT_IN:"MISSING_OPT_IN",NO_DATA:"NO_DATA",NO_VALID_CAMPAIGN:"NO_VALID_CAMPAIGN",SERVICE_ERROR:"SERVICE_ERROR"};function en(e){const t=e.errors[0];if("MISSING_VALUE"===t.code){const e=t.inputName.toUpperCase();return`${t.code}_${e}`}return t.code}function tn(e){const t=We("responsePayload");ve().then((n=>{const o=(0,u.U2)(n,"compliance.ageBands.ADULT.country");if("US"!==o)return t.data={},t.error_codes=Jt.INVALID_LOCATION,He("responsePayload",t),e();He("defaultLegalCountry",o),e("getLegalData")}))}const nn=(e,t=!1)=>({code:e.name,content:e.text,subscribed:t,preselected:e.checked});function on(e){ve().then((t=>{const n=We("guest"),o=(0,u.U2)(n,"profile.region"),r=(0,u.U2)(n,"profile.countryCodeDetected"),s=(0,u.U2)(t,"compliance.defaultCountryCode");He("guestLocation",o||r||s||"US"),e("checkProfile")}))}function rn(e){const t=We("responsePayload"),n=We("guest"),o=We("workflowOptions"),r=function(e,t){if("CHILD"===(0,u.U2)(e,"profile.ageBand"))return Jt.AGE_GATED;if("US"!==We("guestLocation"))return Jt.INVALID_LOCATION;if(null!==t&&t!==(0,u.U2)(e,"profile.email"))return Jt.INVALID_EMAIL;return!1}(n,(0,u.U2)(o,"buData.email")||null)||!1;if(r)return t.error_codes=r,t.data={},He("responsePayload",t),e();e("hasOptedIntoAnything")}const sn=["firstName","gender","lastName","middleName","prefix","suffix","languagePreference","pronunciationName","address.billing","address.home","address.school","address.shipping","address.work","phone.day","phone.mobile","phone.night","proposedDisplayName"],an=["email","username","address.other","phone.fax","dateOfBirth","password","displayName","region"],cn=["line1","line2","line3","city","stateProvince","postalCode","country","preferred"],un=["number","internationalPrefix","countryCode","extension","preferred"];function ln(e,t){const n=Object.keys(e).filter((function(e){return 0===e.indexOf(`${t}.`)})).map((function(t){const n=t.split(".");return{type:n[1].toUpperCase(),field:n[2],value:e[t]}})).reduce((function(e,t){return(0,u.t8)(e,[t.type,t.field].join("."),t.value),e}),{});return Object.keys(n).map((function(e){return Object.assign(n[e],{type:e})}),[])}function dn(e){e.forEach((e=>{Object.keys(e).forEach((function(t){null===e[t]&&delete e[t]}))}))}function En(e,t,n){t.map((function(t){const o=(r=e,s=t.type,r.filter((e=>e.type===s)));var r,s;return o.length&&(t[n]=o[0][n]),t}))}function _n(e){let t=!1;for(const n in e)"addressGuid"!==n&&"type"!==n&&"preferred"!==n&&(t=!0);return t}function pn(e){if("string"===typeof e)return e.trim();if("object"===typeof e)for(const t in e)e[t]=pn(e[t]);return e}function fn(e,t){const n={};for(const o in t)if(t.hasOwnProperty(o)){null!==e&&"object"===typeof e&&e.hasOwnProperty(o)||(n[o]=t[o]);if(null!==t[o]&&null!==e[o]&&!Array.isArray(t[o])&&!Array.isArray(e[o])&&"object"===typeof t[o]&&"object"===typeof e[o]){const r=fn(e[o],t[o]);Object.keys(r).length>0&&(n[o]=r)}else(e[o]!==t[o]||Array.isArray(t[o]))&&(n[o]=t[o]);null===e[o]&&""===t[o]&&delete n[o]}return n}function hn(e,t){return t=(0,u.d9)(t),Object.keys(t||{}).forEach((function(n){null===(0,u.U2)(t,n)&&(0,u.U2)(e,n)&&(0,u.t8)(t,n,e[n])})),(0,u.t8)(e,"etag",(0,u.U2)(t,"etag")),e.profile=In(e.profile,t.profile),e.displayName=In(e.displayName,t.displayName),e.marketing=In(e.marketing,t.marketing),e}function In(e,t){if(null===t||"object"!==typeof t||Array.isArray(t))return t;for(const n in t)t.hasOwnProperty(n)&&((e=e||{})[n]=In(e[n],t[n]));return e}const An=[{runGetGuestWorkflow:{stepExecution:Xt,results:{guestIsLoggedIn:"parseInput",guestIsNotLoggedIn:{}}}},{parseInput:{stepExecution:function(e){const t=We("workflowData"),n=function(e){return Object.keys(e).filter((function(t){return!("string"!==typeof e[t]||!e[t].trim())})).filter((function(e){for(let t=0;t<an.length;t++)if(e.startsWith(an[t]))return;return!0})).reduce((function(t,n){return t[n]=e[n].trim(),t}),{})}((0,u.U2)(t,"guestData")||{}),o=function(e){return Object.keys(e).filter((function(e){return!e.includes("address.")&&!e.includes("phone.")&&"proposedDisplayName"!==e})).reduce((function(t,n){return t.profile[n]=e[n],t}),{profile:{}})}(n);o.profile.addresses=ln(n,"address"),o.profile.phones=ln(n,"phone"),n.proposedDisplayName&&(o.displayName={proposedDisplayName:n.proposedDisplayName}),(0,u.t8)(t,"parsedGuest",o),He("workflowData",t),e("success")},results:{success:"prepareUpdate",error:"close"}}},{prepareUpdate:{stepExecution:function(e){const t=We("workflowData"),n=(0,u.U2)(t,"parsedGuest"),o=(0,u.d9)(n),r=(0,u.U2)(t,"guest"),s=(0,u.U2)(r,"profile.addresses"),i=(0,u.U2)(r,"profile.phones"),a=(0,u.U2)(o,"profile.addresses"),c=(0,u.U2)(o,"profile.phones");Array.isArray(s)&&Array.isArray(a)&&En(s,a,"addressGuid"),Array.isArray(i)&&Array.isArray(c)&&En(i,c,"phoneGuid");const l=function(e,t){if("undefined"===typeof e||"undefined"===typeof t)return{};const n=pn((0,u.d9)({profile:fn(e.profile||{},t.profile||{})||{},displayName:fn(e.displayName||{},t.displayName||{})||{}}));Object.keys(n.profile).forEach((function(e){""===n.profile[e]&&(n.profile[e]=null)})),Object.keys(n.displayName).forEach((function(e){""===n.displayName[e]&&(n.displayName[e]=null)})),(0,u.U2)(n.profile,"dateLastModified")&&delete n.profile.dateLastModified;(0,u.U2)(n.profile,"segmentDeletes")&&delete n.profile.segmentDeletes;return function(e,t,n){const o=["line1","line2","line3","postalCode","stateProvince","country","city","type"],r=(0,u.d9)((0,u.U2)(t,"profile.addresses")||[]),s=[],i={};((0,u.U2)(e,"profile.addresses")||[]).forEach((function(e){i[e.addressGuid]=e})),(0,u.U2)(n,"profile.addresses")&&delete n.profile.addresses;Array.isArray(r)&&r.length&&(r.forEach((function(e){const t=e.addressGuid,n={};o.forEach((function(t){n[t]=e[t]?e[t]:null})),"undefined"!==typeof(0,u.U2)(i,[t,"addressGuid"].join("."))&&(n.addressGuid=t,a(n).forEach((function(o){i[t][o]===e[o]&&delete n[o]}))),a(n).length&&s.push(n)})),s.length&&(0,u.t8)(n,"profile.addresses",s));function a(e){return Object.keys(e).filter((function(e){return-1===["preferred","addressGuid","type"].indexOf(e)}))}}(e,t,n),function(e,t,n){if(!(0,u.U2)(n,"profile"))return;"undefined"!==typeof(0,u.U2)(n,"profile.phones")&&delete n.profile.phones;if(Array.isArray((0,u.U2)(t,"profile.phones"))){const s=[];t.profile.phones.forEach((function(t){let n,i;t.phoneGuid&&!t.number?s.push({phoneGuid:t.phoneGuid}):t.number&&t.type&&(n=r(e,t),n?(i=fn(n,t),Object.keys(i).length>0&&(i.phoneGuid=t.phoneGuid,i.type=t.type,s.push(i))):s.push(o({number:t.number,type:t.type,internationalPrefix:t.internationalPrefix,countryCode:t.countryCode})))})),s.length&&(n.profile.phones=s)}function o(e){const t={};return Object.keys(e).forEach((function(n){let r;"object"===typeof e[n]?(r=o(e[n]),Object.keys(r).length>0&&(t[n]=r)):null!=e[n]&&(t[n]=e[n])})),t}function r(e,t){let n;const o=(0,u.U2)(e,"profile.phones");return t.phoneGuid&&o&&(n=o.filter((function(e){return e.phoneGuid===t.phoneGuid}))[0]),n}}(e,t,n),function(e,t,n){const o=(0,u.U2)(e,"marketing");let r=(0,u.U2)(t,"marketing");const s={};if((o||[]).forEach((function(e){s[e.code]=e})),Array.isArray(r)&&r.length&&(r=r.filter((function(e){return e.subscribed!==(0,u.U2)(s,[e.code,"subscribed"].join("."))})),r.length))return n.marketing=r,n.marketing}(e,t,n),function(e,t,n){const o=e.legalAssertions||[],r=[];(t.legalAssertions||[]).forEach((function(e){-1===o.indexOf(e)&&r.push(e)})),r.length>0&&(n.legalAssertions=r)}(e,t,n),Object.keys(n).forEach((function(e){"object"!==typeof n[e]||n[e]&&0!==Object.keys(n[e]).length||delete n[e]})),n}(r,o);if(Array.isArray((0,u.U2)(l,"profile.addresses"))){dn(l.profile.addresses);const e=l.profile.addresses.filter(_n);e.length>0?l.profile.addresses=e:delete l.profile.addresses}Array.isArray((0,u.U2)(l,"profile.phones"))&&dn(l.profile.phones),(0,u.t8)(t,"modifiedGuest",l),He("workflowData",t),e("success")},results:{success:"execute"}}},{execute:{stepExecution:function(e){const t=We("workflowData"),n=(0,u.U2)(t,"guest"),o=(0,u.U2)(n,"etag"),r={...(0,u.U2)(t,"modifiedGuest"),etag:o},s=(0,u.U2)(n,"profile.swid"),i=(0,u.U2)(n,"token.access_token");return Xe.guestUpdateBySWID({guest:r,swid:s,accessToken:i,etag:o,eventName:fe.API_SET_PPC}).then((t=>{const o=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==o||He("workflowData",{...We("workflowData"),guest:hn(n,t.data)}),He("workflowErrors",(0,u.U2)(t,"error.errors")),e()}),(t=>{He("workflowErrors",(0,u.U2)(t,"error.errors")),e()}))},results:{}}}];function On(e,t){return(e=e||[]).reduce(((e,n)=>("undefined"===typeof e[n[t]]&&(e[n[t]]=n),e)),{})}function gn(e){if((e=e||{})&&"EDITABLE"===e.editable){const t=e.type||{};return Object.keys(t).reduce(((e,n)=>{const o=t[n]||{};return e[n]=Object.keys(o).reduce(((e,t)=>("EDITABLE"===o[t].editable&&"type"!==t&&(e[t]=null),e)),{}),e}),{})}return null}function Tn(e){const t=e.existingProfile[e.type]||e.template[e.type]||e.template.DEFAULT||null,n=e.config[e.type]||e.config.DEFAULT||null;return t&&n&&Object.keys(t).forEach((o=>{if(e.allowedFields.indexOf(o)>-1){const r=e.fieldName.split(".");r.push(o);const s=r.join(".");e.editableProfile.data[s]=t[o]||null,e.editableProfile.required[s]=(n[o]||{}).required||!1}})),e.editableProfile}let Rn;function Nn(){return s.log("TrustState#watch"),Kt().then((e=>{if(mn(),(0,u.U2)(e,"state")===jt.low)return s.info("In low trust"),Sn(),void Wt();!function(e=ue.TRUST_TIMEOUT){Rn=setTimeout((()=>{Sn(),Wt()}),e)}((0,u.U2)(e,"timeLeft"))})).catch((()=>{Sn(),mn()}))}function mn(){clearTimeout(Rn),Rn=void 0}function Sn(){De(wt.LOW_TRUST)}const yn={CANCEL_BY_USER:"CANCEL_BY_USER",CODE_LOCKOUT:"CODE_LOCKOUT",EMAIL_VERIFICATION_CALLBACK:"EMAIL_VERIFICATION_CALLBACK",GUEST_LOGOUT:"GUEST_LOGOUT",LAUNCH_OTP_CALLBACK:"LAUNCH_OTP_CALLBACK",LICENSE_PLATE_CALLBACK:"LICENSE_PLATE_CALLBACK",PAGE_VIEW:"PAGE_VIEW",REAUTH_CALLBACK:"REAUTH_CALLBACK",REDEEM_SESSION_TRANSFER_CALLBACK:"REDEEM_SESSION_TRANSFER_CALLBACK",RUN_WORKFLOW:"runWorkflow"};const Cn={INITIALIZATION:[{anonymize:{stepExecution:function(e){B()||x((0,u.Vj)()),e("done")},results:{done:"checkForOBOToken"}}},{checkForOBOToken:{stepExecution:function(e){s.debug("[checkForOBOToken]: init");const t=pt();if(!t)return s.debug("[checkForOBOToken]: no OBO Token"),e("notFound");s.debug("[checkForOBOToken]: OBO Token Found: ",t,t.isExpired),e("found")},results:{found:"oboSubflow",notFound:"readSession"}}},{readSession:{stepExecution:function(e){return le().then((t=>t?(He("tokenData",t),q(t)?(s.info("Starting token refresh"),e("tokenRefresh")):void e("getGuestSubflow")):e()))},results:{getGuestSubflow:"getGuestSubflow",tokenRefresh:"tokenRefreshSubflow"}}},{getGuestSubflow:{stepExecution:function(e){new pe("getGuest",vt,"readGuestFromLocalStorage",(()=>{const t=We("guest");if(t)return ee.then((e=>e.message("inner","setGuest",t))).finally(e);e()})).runWorkflow()},results:{}}},{tokenRefreshSubflow:{stepExecution:$t,results:{}}},{oboSubflow:{stepExecution:function(e){new pe("oboSubflow",Qt,void 0,(()=>e("done"))).runWorkflow()},results:{done:"readSession"}}}],GET_GUEST:vt,GUEST_FLOW:[{validate:{stepExecution:function(e){const t=We("workflowOptions");let n=(0,u.U2)(t,"guestFlowEmail"),o=!1;if("string"===typeof n&&(n=n.trim().replace(/<|>/gim,""),o=E.test(n)),o)return He("guestFlowEmail",n),e("checkForAccount");qe("guestFlowEmail"),e("launchRegistration")},results:{checkForAccount:"checkForAccount",launchRegistration:"launchRegistration"}}},{checkForAccount:{stepExecution:function(e){const t=We("guestFlowEmail");return t?Xe.guestFlow(t).then((t=>{const n=(0,u.U2)(t,"data.guestFlow")||"",o=n.match(p)?"launchLogin":"launchRegistration";He("guestFlowCode",n),e(o)})).catch((()=>e("launchRegistration"))):e("launchRegistration")},results:{launchLogin:"launchLogin",launchRegistration:"launchRegistration"}}},{launchRegistration:{stepExecution:function(e){He("guestFlowName","REGISTRATION_FLOW");const t=We("workflowOptions"),n=We("guestFlowEmail")||"",o=We("guestFlowCode"),r={profile:{email:n}};return ee.then((n=>n.call("inner","runWorkflow",{name:"REGISTRATION",workflowOptions:t,guestChanges:r,persistentTealiumData:{flow_name:"Guest Flow Registration",guest_flow:o}}).then((()=>{at.showLightbox(),e()})).catch((t=>{const n=(0,u.U2)(t,"message");s.error(`Error in PatchBay call: ${n}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-workflows-guestFlow-launchRegistration)",[fe.STACK_TRACE]:n}),e()}))))},results:{}}},{launchLogin:{stepExecution:function(e){He("guestFlowName","LOGIN_FLOW");const t=We("workflowOptions"),n=We("guestFlowCode");return ee.then((o=>o.call("inner","runWorkflow",{name:"LOGIN",workflowData:{loginValue:We("guestFlowEmail")},workflowOptions:t,persistentTealiumData:{flow_name:"Guest Flow Login",guest_flow:n}}).then((()=>{at.showLightbox(),e()})).catch((t=>{const n=(0,u.U2)(t,"message");s.error(`Error in PatchBay call: ${n}`),Le({[fe.ACTION_NAME]:fe.LOG_PATCHBAY_ERROR,[fe.INFO]:"location(outer-workflows-guestFlow-launchLogin)",[fe.STACK_TRACE]:n}),e()}))))},results:{}}}],GET_INLINE_NEWSLETTERS:[{runGetGuestWorkflow:{stepExecution:Xt,results:{guestIsLoggedIn:"getGuestLegalCountry",guestIsNotLoggedIn:"getDefaultLegalCountry"}}},{getDefaultLegalCountry:{stepExecution:tn,results:{getLegalData:"getLegalData"}}},{getLegalData:{stepExecution:function(e){const t=We("responsePayload");return Promise.all([ve(),ee.then((e=>e.call("inner","config.getL10n"))).then(u._A)]).then((([n,o])=>{const r=(0,u.U2)(n,"legal.ADULT.disclosures"),s=[];r.forEach((e=>{s.push({code:e.disclosureCode,requiresActiveConsent:e.requiresActiveConsent,accepted:!e.requiresActiveConsent,content:o[`legal.${e.disclosureCode}_create`]})})),t.data.legal=s,He("responsePayload",t),e("getMarketingData")}))},results:{getMarketingData:"getMarketingData"}}},{getMarketingData:{stepExecution:function(e){const t=We("responsePayload"),n=We("promotionID");return ve().then((o=>{const r=(0,u.U2)(We("guest"),"profile.ageBand")||"ADULT",s=(0,u.U2)(o,`newsletters.${r}.${n}`),i=new Set,a=[];s.forEach((e=>{i.has(e.name)||(i.add(e.name),a.push(nn(e)))})),t.data.marketing=a,He("responsePayload",t),e()}))},results:{}}},{getGuestLegalCountry:{stepExecution:on,results:{checkProfile:"checkProfile"}}},{checkProfile:{stepExecution:rn,results:{hasOptedIntoAnything:"hasOptedIntoAnything"}}},{hasOptedIntoAnything:{stepExecution:function(e){const t=We("guest");e((0,u.U2)(t,"marketing")?"filterOptedInMarketingLists":"getMarketingData")},results:{getMarketingData:"getMarketingData",filterOptedInMarketingLists:"filterOptedInMarketingLists"}}},{filterOptedInMarketingLists:{stepExecution:function(e){ve().then((t=>{const n=We("guest"),o=(0,u.U2)(n,"marketing"),r=(0,u.U2)(n,"profile.ageBand"),s=We("promotionID"),i=(0,u.U2)(t,`newsletters.${r}.${s}`),a=[];for(const e of i)a.push(...e.lists);const c=new Set(o.filter((e=>e.subscribed)).map((e=>e.code))),l=a.filter((e=>!c.has(e.name))),d=We("responsePayload");l.length?d.data.marketing=l.map((e=>nn(e))):(d.error_codes=Jt.ALREADY_OPT_IN,d.data={}),He("responsePayload",d),e()}))},results:{}}}],SET_INLINE_NEWSLETTERS:[{runGetGuestWorkflow:{stepExecution:Xt,results:{guestIsLoggedIn:"getGuestLegalCountry",guestIsNotLoggedIn:"getDefaultLegalCountry"}}},{getDefaultLegalCountry:{stepExecution:tn,results:{getLegalData:"prepareRequest"}}},{getGuestLegalCountry:{stepExecution:on,results:{checkProfile:"checkProfile"}}},{checkProfile:{stepExecution:rn,results:{hasOptedIntoAnything:"prepareRequest"}}},{prepareRequest:{stepExecution:function(e){const t=(0,u.U2)(We("workflowOptions"),"buData"),n=(0,u.U2)(t,"legal"),o=(0,u.U2)(t,"marketing");if(!n||!o)return e();He("marketingParams",o);const r=(0,u.U2)(t,"campaignId"),s=We("guestLocation")||We("defaultLegalCountry");He("requestPayload",{profile:{email:t.email,countryCodeDetected:s,region:s},legalAssertions:n.filter((e=>e.accepted)).map((e=>e.code)),campaign:r}),e("prepareMarketingPayload")},results:{prepareMarketingPayload:"prepareMarketingPayload"}}},{prepareMarketingPayload:{stepExecution:function(e){const t=We("requestPayload"),{campaign:n}=t,o=We("marketingParams"),r=We("guest"),s=r&&r.marketing;s&&o.push(...r.marketing);const i=function(e){const t=e.filter((e=>e.subscribed)),n=new Set,o=[];return t.forEach((e=>{n.has(e.code)||(o.push(e),n.add(e.code))})),o}(o);ve().then((o=>{const a=(0,u.U2)(o,"newsletters.ADULT",n);let c=!1;const l=[];if(s){const e=[];a.forEach((t=>e.push(...t.lists)));const t={};e.forEach((e=>t[e.name]=e));for(const e of i){const n=t[e.code];if(!n){c=!0;break}l.push({code:n.name,subscribed:!0,textId:n.textId})}}else{const t={};a.forEach((e=>t[e.name]=e));for(const e of i){const n=t[e.code];if(!n){c=!0;break}{const e=n.lists.map((e=>({code:e.name,subscribed:!0,textId:n.textId})));l.push(...e)}}if(c)return He("responsePayload",{data:{},error_codes:"NO_VALID_CAMPAIGN"}),e()}t.marketing=l,He("requestPayload",t),e(r?"executeUpdate":"executeRequest")}))},results:{executeUpdate:"executeUpdate",executeRequest:"executeRequest"}}},{executeRequest:{stepExecution:function(e){const t=We("requestPayload");return Xe.guestMarketingOptIn(t).then((t=>{const n=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==n?He("responsePayload",{data:{},error_codes:en(t.error)}):He("responsePayload",{data:"SUCCESS",error_codes:null}),e()})).catch((()=>{He("responsePayload",{data:{},error_codes:Jt.SERVICE_ERROR}),e()}))},results:{}}},{executeUpdate:{stepExecution:function(e){const t=We("requestPayload"),{marketing:n}=t,o=We("guest"),r=(0,u.U2)(o,"profile.swid"),s=(0,u.U2)(o,"token.access_token"),i=fe.SERVICE_UPDATE_GUEST,a={marketing:n};return Xe.guestUpdateBySWID({guest:a,swid:r,accessToken:s,eventName:i}).then((t=>{const n=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==n?(He("responsePayload",{data:{},error_codes:en(t.error)}),e()):(He("responsePayload",{data:"SUCCESS",error_codes:null}),e("reloadGuest"))})).catch((()=>{He("responsePayload",{data:{},error_codes:Jt.SERVICE_ERROR}),e()}))},results:{reloadGuest:"reloadGuest"}}},{reloadGuest:{stepExecution:function(e){const t=We("workflowOptions")||{};t.fullPayloadRequested=!0,t.forceRefresh=!0,He("workflowOptions",t),new pe("getGuest",vt,null,(()=>e())).runWorkflow()},results:{}}}],GET_EDITABLE_AND_REQUIRED_FIELDS:[{runGetGuestWorkflow:{stepExecution:Xt,results:{guestIsLoggedIn:"getEditableAndRequiredFields",guestIsNotLoggedIn:{}}}},{getEditableAndRequiredFields:{stepExecution:function(e){const t=We("guest");let n={data:{},required:{}};try{ve().then((o=>{const r=sn,s=`compliance.ageBands.${t.profile.ageBand}.UPDATE`,i=(0,u.U2)(o,s),a=On(t.profile.addresses,"type"),c=On(t.profile.phones,"type"),l=gn((0,u.U2)(o,`${s}.addresses`)),d=gn((0,u.U2)(o,`${s}.phones`)),E=(0,u.U2)(o,"displayName"),_=(0,u.U2)(E,"enabled");for(const e of r){const o=(e.split(".")[1]||"").toUpperCase();e.includes("address")&&i.addresses?n=Tn({existingProfile:a,template:l,config:i.addresses.type,allowedFields:cn,fieldName:e,editableProfile:n,type:o}):e.includes("phone")&&i.phones?n=Tn({existingProfile:c,template:d,config:i.phones.type,allowedFields:un,fieldName:e,editableProfile:n,type:o}):e.toLowerCase().includes("displayname")&&_?n.data[e]=(0,u.U2)(t,`displayName.${e}`):i[e]&&(n.data[e]=(0,u.U2)(t,`profile.${e}`),n.required[e]=(0,u.U2)(i,e).required||!1)}return He("editableFields",n),Promise.resolve(e())}))}catch(e){He("editableFields",{error_codes:be.UNKNOWN_ERROR,data:{}})}},results:{}}}],SESSION_STATE_TASKS:[{checkState:{stepExecution:function(e){const t=()=>{if(!0===We("wasLoggedIn"))return e("syncLoggedOut");e()};return le().then((n=>n?(He("loggedIn",!0),!1===We("wasLoggedIn")?e("syncLoggedIn"):!Y(n)||Z(n)?e("tokenRefresh"):void e()):t())).catch(t)},results:{syncLoggedIn:"syncLoggedIn",syncLoggedOut:"syncLoggedOut",tokenRefresh:"tokenRefreshSubflow"}}},{tokenRefreshSubflow:{stepExecution:$t,results:{}}},{syncLoggedIn:{stepExecution:function(e){return Promise.all([Rt(),ee]).then((([t,n])=>n.call("inner","setGuest",t).then((()=>{n.call("inner","reloadConfigFromBundlerIfChanged");const o=(0,u.U2)(t,"profile.ageBand")===Ve.CHILD;x((0,u.U2)(t,"profile.swid"),o),De(wt.LOGIN,t),Nn(),He("loggedIn",!0),e()})))).catch(e)},results:{}}},{syncLoggedOut:{stepExecution:function(e){const t=B();return ee.then((n=>n.call("inner","guest.logout").then((()=>{mn(),t&&t.startsWith("{")&&x((0,u.Vj)()),Pt(Ct.LOGGED_OUT_IN_OTHER_TAB),Ye(),He("loggedIn",!1),e()})).catch(e)))},results:{}}}],SET_PPC:An,TOKEN_REFRESH:Bt,REDEEM_SESSION_TRANSFER:[{redeemSessionTransfer:{stepExecution:function(e){const t=We("workflowData"),n=(0,u.U2)(t,"sessionTransferKey")||"";return Xe.authenticateViaSessionTransferKey({sessionTransferKey:n}).then((t=>{t&&He("redeemResponse",{...t});if(((0,u.U2)(t,"error.errors")||[]).length)return e("parseErrors");e("createSession")})).catch(e)},results:{createSession:"createSession",parseErrors:"parseErrors"}}},{parseErrors:{stepExecution:function(e){const t=We("redeemResponse")||{},n=t.parsedErrors||{};return n.isInvalidSessionTransferKeyError?e():n.isPPU&&200===t.status||200===t.status||n.isAdvisoryError?e("createSession"):n.isPPU&&400===t.status?e("ppu"):n.isGating?e("gatingSubflow"):void e()},results:{ppu:"ppuSubflow",createSession:"createSession",gatingSubflow:"gatingSubflow"}}},{ppuSubflow:{stepExecution:function(e){const t=We("redeemResponse")||{};return S(yn.REDEEM_SESSION_TRANSFER_CALLBACK,(()=>{y(yn.REDEEM_SESSION_TRANSFER_CALLBACK),e()})),ee.then((e=>{e.call("inner","runWorkflow",{apiCallback:{name:yn.REDEEM_SESSION_TRANSFER_CALLBACK},name:zt.LOGIN,step:"ppuSubflow",guest:t.data,workflowData:{parsedErrors:t.parsedErrors,ppu:{errors:t.error.errors}}}).then((()=>{at.showLightbox()}))}))},results:{}}},{createSession:{stepExecution:function(e){const t=We("redeemResponse").data;if(t)return Yt(t).then((()=>{He("redeemSuccess",!0),e()})).catch((t=>{const n=(0,u.U2)(t,"message")||"";s.error(`Error in session-transfer create session call: ${n}`),e("error")}))},results:{error:"parseErrors"}}},{gatingSubflow:{stepExecution:function(e){const t=We("redeemResponse")||{};return S(yn.REDEEM_SESSION_TRANSFER_CALLBACK,(()=>{y(yn.REDEEM_SESSION_TRANSFER_CALLBACK),e()})),ee.then((e=>{e.call("inner","runWorkflow",{apiCallback:{name:yn.REDEEM_SESSION_TRANSFER_CALLBACK},name:zt.LOGIN,step:"gatingSubflow",guest:t.data,workflowData:{parsedErrors:t.parsedErrors,ppu:{errors:t.error.errors}}}).then((()=>{at.showLightbox()}))}))},results:{}}}]};function Ln({name:e,step:t=null,workflowOptions:n=null,onComplete:o=null,persistWorkflowOptions:r=!1}){n&&He("workflowOptions",n);new pe(e,Cn[e],t,(()=>{r||qe("workflowOptions"),o&&o()})).runWorkflow()}const wn={LOCAL:"https://qa.registerdisney.go.com/jgc/v8",DEV:"https://qa.registerdisney.go.com/jgc/v8",QA:"https://qa.registerdisney.go.com/jgc/v8",STAGE:"https://stg.registerdisney.go.com/jgc/v8",VALID:"https://val.registerdisney.go.com/jgc/v8",PROD:"https://registerdisney.go.com/jgc/v8"};let Pn;function Dn(){He("sessionTimerPaused",!0),clearTimeout(Pn)}function vn(e){He("sessionTimerPaused",!1),He("loggedIn",e),Un()}function Un(){clearTimeout(Pn),He("wasLoggedIn",We("loggedIn")||!1),Ln({name:"SESSION_STATE_TASKS",onComplete:()=>{Pn=setTimeout(Un,ue.SESSION_TIMER_POLL_INTERVAL)},persistWorkflowOptions:!0})}var kn=n(486),bn=n.n(kn);const Gn=9e4;let Mn,Vn,Fn;function xn(e=""){s.debug(`api/init: innerVersion "${e}"`),s.debug(`api/init: window.ONEID_WEB_SDK_VERSION "${window.ONEID_WEB_SDK_VERSION}"`),Ie.lightbox_version=e,e!==window.ONEID_WEB_SDK_VERSION&&Le({[fe.ACTION_NAME]:fe.LOG_VERSION_MISMATCH,[fe.INFO]:`outer(${window.ONEID_WEB_SDK_VERSION}),inner(${e})`}),Fn=!0,Vn()}function Bn(){return Fn}function $n(){if(Fn){if(De(wt.ERROR,nt.ALREADY_INITIALIZED),window.ONEID_WEB_SDK_MIGRATION){const e=bn().defer();return e.reject(nt.ALREADY_INITIALIZED),e.promise}return Promise.reject(nt.ALREADY_INITIALIZED)}me({conversationId:(0,u.Vj)()});const e=ye(fe.API_INIT),t=Et(Gn),n=function(){const e=new Promise((e=>{const t=at.createInner();t.onload=()=>{e(t)}})),t=new Promise((e=>{const t=at.createResponder();t.onload=()=>{e(t)}}));return Promise.all([e,t])}().then(jn).then(Kn),o=Promise.race([n,t]).then((()=>new Promise((n=>{((0,u.U2)(V(),"debug")||{}).tealiumDebug&&ee.then((e=>e.message("inner","turnOnDebugTealiumTracking")));const o=ce()||"PROD",r=V()||{},{clientId:i}=r,a=r.langPref,c=wn[o];var l;l={clientId:`${i}-${o}`,endpoint:c,language:a},Qe={...Qe,...l},Ln({name:"INITIALIZATION",onComplete:function(){t.cancel(),s.debug("OneID initialization complete"),e.send();const o=We("guest"),r={loggedIn:!!(o||{}).token,guest:o||null};var i;De(wt.INIT,r),Ye(),i=r.loggedIn,s.log("SessionTimer#startTimer"),He("loggedIn",i),Un(),r.loggedIn&&Nn(),n(r)}.bind(this)})})))).catch((({errorCodes:t,errorCategory:n})=>(e.send({[fe.ERROR_CATEGORY]:n||ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:t||nt.NOT_INITIALIZED}),De(wt.ERROR,`${nt.NOT_INITIALIZED}: ${t}`),Promise.reject(`${nt.NOT_INITIALIZED}: ${t}`))));if(window.ONEID_WEB_SDK_MIGRATION){const e=bn().defer();return o.then((t=>e.resolve(t))).catch((t=>e.reject(t))),e.promise}return o}function jn([e,t]=frames){return new Promise(((n,o)=>{const r={frames:{outer:{window,origin:window.origin||window.location&&window.location.origin,channels:["inner","responder"]},inner:{window:e.contentWindow,origin:new URL(e.src).origin,channels:["outer","responder"]},responder:{window:t.contentWindow,origin:new URL(t.src).origin,channels:["inner","outer"]}}};Promise.all([z(r),ee]).then((()=>{s.debug("Cross frame communication initialized"),n()})).catch((()=>o({errorCodes:nt.CROSS_FRAME_COMMUNICATION_TIMEOUT})))}))}function Kn(){return Mn}Mn=new Promise((e=>Vn=e)),Fn=!1;const Hn={doNotDisturb:ao({preConditions:[Jn],method:function([e]){if("boolean"!==typeof e)return Promise.reject({errorCodes:nt.INVALID_ARGUMENT});return Ft(e),Promise.resolve()},actionName:fe.API_SET_DO_NOT_DISTURB,logInfoKey:"flag"}),forceTokenRefresh:ao({preConditions:[Jn,Qn],method:function([e]){qe("tokenRefreshResponse"),me(e);const t=ut(),n=new Promise((e=>{Ln({name:"TOKEN_REFRESH",step:"forceRefresh",onComplete:()=>{const t=We("tokenRefreshResponse"),n=(0,u.U2)(t,"data.token"),o=(0,u.U2)(t,"error.keyCategory")||"",r=[];((0,u.U2)(t,"error.errors")||[]).forEach((e=>{r.includes(e.code)||r.push(e.code)})),qe("tokenRefreshResponse"),e({errorCategory:o,errorCodes:r,newTokens:n})}})}));return Promise.race([n,t]).then((({errorCategory:e,errorCodes:n,newTokens:o})=>(t.cancel(),o?Promise.resolve(o):e||n.length?Promise.reject({errorCategory:e,errorCodes:n.join(",")}):(Le({[fe.ACTION_NAME]:fe.LOG_APPLICATION_ERROR,[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.INFO]:"api(forceTokenRefresh),data(missing_tokens,no_errors)"}),Promise.reject({errorCategory:ot.FAILURE_BY_DESIGN,errorCodes:ot.UNKNOWN_ERROR})))))},actionName:fe.API_FORCE_TOKEN_REFRESH}),getEditableProfileFields:ao({preConditions:[Jn,Qn],method:function([e]){me(e);const t=ut(),n=dt().then(Rt).then((t=>t.profile&&0===Object.keys(t.profile).length?Promise.reject({errorCodes:nt.NO_PROFILE}):new Promise((n=>{Ln({name:"GET_EDITABLE_AND_REQUIRED_FIELDS",workflowOptions:_t(e,t),onComplete:n})})))).then((()=>{const e=We("editableFields");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve()}));return Promise.race([n,t]).then((()=>{t.cancel();const e=We("editableFields");return Promise.resolve(e)}))},actionName:fe.API_GET_PPC}),getGuest:ao({preConditions:[Jn,Qn],method:function(e){const[t=!1,n={}]=e,o=!0===t;me(n);const r=ut(),s=dt().then((()=>new Promise(((e,t)=>{const r={forceRefresh:(0,u.U2)(n,"forceRefresh")||!1,fullPayloadRequested:!!o};Ln({name:"GET_GUEST",workflowOptions:_t(n,r),onComplete:()=>{const n=We("getGuestResponse");if(qe("getGuestResponse"),n){const o=(0,u.U2)(n,"error.keyCategory")||"FAILURE_BY_DESIGN";let s=[];return(0,u.U2)(n,"error.errors")&&(0,u.U2)(n,"error.errors").forEach((function(e){-1===s.indexOf(e.code)&&s.push(e.code)})),s=s.length?s.join(","):"UNABLE_TO_RETRIEVE_GUEST_DATA",r.localCopyReturned=!1,We("logoutType")?t({errorCodes:s,errorCategory:o,[fe.INFO]:r}):(0,u.U2)(n,"data.profile")?e(We("guest")||null):t({errorCodes:s,errorCategory:o,[fe.INFO]:r})}e(We("guest")||null)}})}))));return Promise.race([s,r]).then((e=>(r.cancel(),Promise.resolve(e))))},actionName:fe.API_GET_GUEST_DATA,logInfoKey:"fullPayload"}),getGuestNewsletters:ao({preConditions:[Jn,Qn],method:function([e]){me(e);const t=ut(),n=Rt().then((e=>(0,u.U2)(e,"marketing")||null));return Promise.race([n,t]).then((e=>(t.cancel(),Promise.resolve(e))))},actionName:fe.API_GET_GUEST_NEWSLETTERS}),getInlineNewsletters:ao({preConditions:[Jn],method:function(e){const[t,n]=e;me(n);const o=ut(),r=ve().then((e=>e?lt(e,t)?Promise.resolve():Promise.reject({errorCodes:nt.NO_VALID_CAMPAIGN}):Promise.reject({errorCodes:nt.NO_SITE_CONFIG}))).then((()=>new Promise((e=>{He("promotionID",t),Ln({name:"GET_INLINE_NEWSLETTERS",workflowOptions:_t(n),onComplete:e})})))).then((()=>{const e=We("responsePayload");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve()})).finally((()=>{qe("promotionID")}));return Promise.race([r,o]).then((()=>{o.cancel();const e=We("responsePayload");return Promise.resolve(e)}))},actionName:fe.API_GET_INLINE_NEWSLETTERS,logInfoKey:"promotionId"}),getTrustStateStatus:ao({preConditions:[Jn,Qn],method:function([e]){me(e);const t=ut();let n;const o=Kt().then((({state:e})=>n=e));return Promise.race([o,t]).then((()=>(t.cancel(),Promise.resolve(n))))},actionName:fe.API_GET_TRUST_STATE_STATUS}),init:$n,getConfig:function(){return Wn},getLicensePlateDataBag:ao({preConditions:[Jn],method:function([e={},t]){me(t);const{pairingCode:n=""}=e;if(!n||0===n.length)return Promise.reject({errorCodes:nt.MISSING_PAIRING_CODE});return He("workflowOptions",_t(t)),rt(n)},actionName:fe.API_GET_LICENSE_PLATE_DATA_BAG}),getLoggedInStatus:ao({preConditions:[()=>Mn],method:eo,actionName:fe.API_GET_LOGGED_IN_STATUS}),launchEmailVerification:ao({preConditions:[Jn,Qn],method:function([e]){return me(e),new Promise(((t,n)=>{const o="EMAIL_ALREADY_VERIFIED";dt().then(Rt).then((t=>{if(t.profile.emailVerified)throw new Error(o);return ee.then((n=>n.call("inner","runWorkflow",{apiCallback:{name:yn.EMAIL_VERIFICATION_CALLBACK},guest:t,name:zt.EMAIL_VERIFICATION,workflowOptions:_t(e)})))})).then((()=>{S(yn.EMAIL_VERIFICATION_CALLBACK,(({errorCategory:e,errorCodes:o,wasSuccess:r})=>{y(yn.EMAIL_VERIFICATION_CALLBACK),r?t():n({errorCategory:e,errorCodes:o})})),at.showLightbox()})).catch((e=>{y(yn.EMAIL_VERIFICATION_CALLBACK),e.message!==o?n(new Error(ot.UNKNOWN_ERROR)):t()}))}))},actionName:fe.API_LAUNCH_EMAILVERIFICATION,newRelicFlowName:(0,u.hK)(zt.EMAIL_VERIFICATION)}),launchGuestFlow:ao({preConditions:[Jn,Xn],method:function([e,t]){me(t);const n=ut(),o=new Promise((n=>{Ln({name:"GUEST_FLOW",workflowOptions:_t(t,{guestFlowEmail:e}),onComplete:n})}));return Promise.race([o,n]).then((()=>{const e=`SUCCESS_LAUNCH_${We("guestFlowName")}_${We("guestFlowEmail")?"WITH":"WITH_OUT"}_EMAIL`;return n.cancel(),qe("guestFlowCode"),qe("guestFlowName"),qe("guestFlowEmail"),Promise.resolve(e)}))},actionName:fe.API_LAUNCH_GUESTFLOW}),launchIdentityFlow:ao({preConditions:[Jn,Xn],method:function([e,t]){me(t);const n=ut(),o=dt().then((()=>{const n=_t(t),o={name:zt.IDENTITY_FLOW,workflowOptions:n},r=(0,u.U2)(t,"optionalConfigs.providedProfile");return r&&(o.guestChanges={profile:r}),o.workflowData={isIdentityFlow:!0},e&&(o.workflowData.loginValue=e,o.workflowData.skipPrompt=!0),ee.then((e=>e.call("inner","runWorkflow",o)))}));return Promise.race([o,n]).then((()=>(n.cancel(),at.showLightbox(),Promise.resolve())))},actionName:fe.API_LAUNCH_IDENTITYFLOW,newRelicFlowName:(0,u.hK)(zt.IDENTITY_FLOW)}),launchLicensePlate:ao({preConditions:[Jn],method:function([e={}]){me(e);const{pairingCode:t="",authenticationFlow:n,deviceName:o,isLicensePlateLaunched:r=!0,showSuccessScreen:s}=e;if(!t||0===t.length)return Promise.reject({errorCodes:nt.MISSING_PAIRING_CODE});return new Promise(((i,a)=>{Dn(),dt().then(Rt).then((i=>ee.then((a=>a.call("inner","runWorkflow",{apiCallback:{name:yn.LICENSE_PLATE_CALLBACK},guest:i,name:zt.LICENSE_PLATE,workflowData:{authenticationFlow:n,deviceName:o,isLicensePlateLaunched:r,pairingCode:t,showSuccessScreen:s},workflowOptions:_t(e)}))))).then((()=>{S(yn.LICENSE_PLATE_CALLBACK,(({errorCodes:e=be.UNKNOWN_ERROR,wasSuccess:t=!1})=>{if(y(yn.LICENSE_PLATE_CALLBACK),eo().then((e=>vn(e))),t)return i();a({errorCategory:Me.FAILURE_BY_DESIGN,errorCodes:e})})),at.showLightbox()})).catch((()=>{eo().then((e=>vn(e))),a(new Error(ot.UNKNOWN_ERROR))}))}))},actionName:fe.API_LAUNCH_LICENSE_PLATE,sendAfterPreconditions:!0,newRelicFlowName:(0,u.hK)(zt.LICENSE_PLATE)}),launchLogin:ao({preConditions:[Jn,Xn],method:function([e]){me(e);const t=ut(),n=dt().then((()=>{const t=_t(e),n={name:zt.LOGIN,workflowOptions:t},o=(0,u.U2)(e,"optionalConfigs.email");return o&&(n.workflowData={loginValue:o}),ee.then((e=>e.call("inner","runWorkflow",n)))}));return Promise.race([n,t]).then((()=>(t.cancel(),at.showLightbox(),Promise.resolve())))},actionName:fe.API_LAUNCH_LOGIN,newRelicFlowName:(0,u.hK)(zt.LOGIN)}),launchNewsletters:ao({preConditions:[Jn],method:function(e){const[t,n]=e;me(n);const o=ut();let r;const s=Rt().then((e=>(r=e,ve()))).then((e=>e?lt(e,t)?Promise.resolve(t):Promise.reject({errorCodes:nt.INVALID_ARGUMENT}):Promise.reject({errorCodes:nt.NO_SITE_CONFIG}))).then((e=>ee.then((t=>{const o=_t(n,{promotionId:e});t.call("inner","runWorkflow",{guest:r,name:zt.NEWSLETTERS,workflowOptions:o})}))));return Promise.race([s,o]).then((()=>(o.cancel(),at.showLightbox(),Promise.resolve())))},actionName:fe.API_LAUNCH_NEWSLETTERS,logInfoKey:"promotionId",newRelicFlowName:(0,u.hK)(zt.NEWSLETTERS)}),launchProfile:ao({preConditions:[Jn,Qn],method:function([e]){me(e);const t=ut(),n=_t(e),o=dt().then(Rt).then((e=>ee.then((t=>t.call("inner","runWorkflow",{guest:e,name:zt.UPDATE_PROFILE,workflowOptions:n})))));return Promise.race([o,t]).then((()=>(t.cancel(),at.showLightbox(),Promise.resolve())))},actionName:fe.API_LAUNCH_PROFILE,newRelicFlowName:(0,u.hK)(zt.UPDATE_PROFILE)}),launchReauth:ao({preConditions:[Jn,Qn],method:function([e]){return me(e),new Promise(((t,n)=>{dt().then(Rt).then((t=>ee.then((n=>n.call("inner","runWorkflow",{apiCallback:{name:yn.REAUTH_CALLBACK},guest:t,name:zt.REAUTH,workflowOptions:_t(e)}))))).then((()=>{S(yn.REAUTH_CALLBACK,(({errorCodes:e=be.UNKNOWN_ERROR,wasSuccess:o=!1})=>{if(y(yn.REAUTH_CALLBACK),o)return qe("tokenData"),Rt().then((e=>t(e)));n({errorCategory:Me.FAILURE_BY_DESIGN,errorCodes:e})})),at.showLightbox()})).catch((()=>n(new Error(ot.UNKNOWN_ERROR))))}))},actionName:fe.API_LAUNCH_REAUTH,sendAfterPreconditions:!0,newRelicFlowName:(0,u.hK)(zt.REAUTH)}),launchRegistration:ao({preConditions:[Jn,Xn],method:so,actionName:fe.API_LAUNCH_REGISTRATION,newRelicFlowName:(0,u.hK)(zt.REGISTRATION)}),logout:ao({preConditions:[Jn,eo],method:function(){const{clientId:e}=V(),t=ce(),n=ut();mn(),Dn();const o=Rt().then((n=>{Ye();const o=(0,u.U2)(n,"profile.swid"),r=(0,u.U2)(n,"token");return Tt(),o&&r?(ze().then((e=>{const{s2CookieName:t,s2Domain:n}=e,o=T.getCookieDomain();O(t,n,"/"),o&&O(t,o,"/")})),Lt(o,r).then((()=>ee.then((n=>(n.message("inner","guest.logout"),x((0,u.Vj)()),n.call("responder","guest.logout",`${e}-${t}`))))))):(Le({[fe.ACTION_NAME]:fe.LOG_MISSING_GUEST_DATA_ON_LOGOUT,[fe.INFO]:`swid(${o?"present":"missing"}),tokens(${r?"present":"missing"})`}),ee.then((n=>(n.message("inner","guest.logout"),x((0,u.Vj)()),n.call("responder","guest.logout",`${e}-${t}`)))))}));return Promise.race([o,n]).then((()=>(vn(!1),n.cancel(),Pt(Ct.API),Promise.resolve())))},actionName:fe.API_LOGOUT}),on:S,off:y,setEditableProfileFields:ao({preConditions:[Jn,Qn],method:function(e){const[t,n]=e;if(me(n),0===e.length||t&&0===Object.keys(t).length)return Promise.reject({errorCodes:nt.NO_DATA});const o=/^phone\.mobile/;if(Object.keys(t).find((e=>o.test(e))))return Promise.reject({errorCodes:nt.PROFILE_UPDATE_INVALID});const r=ut(),s=dt().then(Rt).then((e=>e.profile&&0===Object.keys(e.profile).length?Promise.reject({errorCodes:nt.NO_PROFILE}):(He("workflowData",{guestData:t,guest:e}),new Promise((e=>{Ln({name:"SET_PPC",onComplete:e})}))))).then((()=>{const e=We("workflowErrors")||[];return e.length?Promise.reject({errorCodes:e[0].code}):Promise.resolve()}));return Promise.race([s,r]).then((()=>{r.cancel();const{guest:e}=We("workflowData");return St({guest:e,token:e.token},!0),{data:e}})).finally((()=>{qe("workflowErrors")}))},actionName:fe.API_SET_PPC}),setInlineNewsletters:ao({preConditions:[Jn],method:function(e){const[t,n]=e;if(me(n),!e||!t)return Promise.reject({errorCodes:nt.NO_DATA});const o=ut(),r=ve().then((e=>e?lt(e,t.campaignId)?new Promise((e=>{Ln({name:"SET_INLINE_NEWSLETTERS",workflowOptions:_t(n,{buData:t}),onComplete:e})})):Promise.reject({errorCodes:Jt.NO_VALID_CAMPAIGN}):Promise.reject({errorCodes:nt.NO_SITE_CONFIG}))).then((()=>{const e=We("responsePayload");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve(e)}));return Promise.race([r,o]).then((()=>(o.cancel(),Promise.resolve())))},actionName:fe.API_SET_INLINE_NEWSLETTERS}),redeemSessionTransferKey:ao({preConditions:[Jn,Xn],method:function([e,t]){if(me(t),!e)return Promise.reject({errorCodes:nt.INVALID_ARGUMENT});return new Promise(((n,o)=>{dt().then((()=>{He("workflowData",{sessionTransferKey:e});Ln({name:"REDEEM_SESSION_TRANSFER",workflowOptions:_t(t),onComplete:()=>{const e=We("redeemSuccess")||!1,t=We("redeemResponse");if(!(0,u.U2)(t,"data.profile")){const e=(0,u.U2)(t,"error.keyCategory")||ot.FAILURE_BY_DESIGN;let n=[];return(0,u.U2)(t,"error.errors")&&(0,u.U2)(t,"error.errors").forEach((function(e){n.includes(e.code)||n.push(e.code)})),n=n.length?n.join(","):be.UNKNOWN_ERROR,o({errorCategory:e,errorCodes:n})}if(e)return n({data:t.data});o({errorCategory:ot.FAILURE_BY_DESIGN,errorCodes:be.UNKNOWN_ERROR})}})})).catch((()=>{o(new Error(ot.UNKNOWN_ERROR))}))}))},actionName:fe.API_REDEEM_SESSION_TRANSFER,newRelicFlowName:(0,u.hK)(zt.REDEEM_SESSION_TRANSFER)}),launchOTP:ao({preConditions:[Jn,Qn],method:function([e,t,n=!0]){return me(t),new Promise(((o,r)=>{dt().then((()=>ee.then((o=>o.call("inner","runWorkflow",{apiCallback:{name:yn.LAUNCH_OTP_CALLBACK},name:zt.LAUNCH_OTP,step:"chooseOTPMethod",workflowData:{onDemandOTP:{reason:e,forceOTP:n}},workflowOptions:_t(t)}))))).then((()=>{S(yn.LAUNCH_OTP_CALLBACK,(({errorCodes:e=be.UNKNOWN_ERROR,wasSuccess:t=!1,recoveryToken:n})=>{if(y(yn.LAUNCH_OTP_CALLBACK),t&&n)return o(n);r({errorCategory:Me.FAILURE_BY_DESIGN,errorCodes:e})})),at.showLightbox()})).catch((()=>{r(new Error(ot.UNKNOWN_ERROR))}))}))},actionName:fe.API_LAUNCH_OTP_ONDEMAND,newRelicFlowName:(0,u.hK)(zt.LAUNCH_OTP)}),displayViewPreview:ao({preConditions:[Jn],method:function([e,t={},n={}]){const o=ut(),r=dt().then((()=>ee.then((o=>o.call("inner","displayViewPreview",{viewID:e,guest:t,workflowData:n})))));return Promise.race([r,o]).then((()=>(o.cancel(),at.showLightbox(),Promise.resolve())))}}),setLogLevel:function(t,n){if("string"!==typeof t||!e[t.toUpperCase()])return void s.warn(nt.INVALID_ARGUMENT);const o=e[t.toUpperCase()];i(o),ee.then((e=>e.broadcast("config.setLogLevel",o))),n&&o!==e.OFF?g(I.LOG_LEVEL,t,null,"/"):n&&o!==e.OFF||O(I.LOG_LEVEL,null,"/")}};let Wn;const qn={get:no},Yn={get:(Zn=no,zn=nt.DISNEYID_DEPRECATED,"function"===typeof Zn?function(...e){return s.warn(zn),Zn.apply(this,e)}:Zn)};var Zn,zn;function Qn(){return new Promise(((e,t)=>{eo().then((n=>{if(n)return e();t({errorCategory:ot.FAILURE_BY_DESIGN,errorCodes:nt.SESSION_NOT_ESTABLISHED})}))}))}function Xn(){return new Promise(((e,t)=>{eo().then((n=>{if(!n)return e();t({errorCategory:ot.FAILURE_BY_DESIGN,errorCodes:nt.SESSION_ESTABLISHED})}))}))}function Jn(){return new Promise(((e,t)=>{if(Bn())return e();t({errorCategory:ot.FAILURE_BY_DESIGN,errorCodes:nt.NOT_INITIALIZED})}))}function eo(){return le().then((e=>!!e&&!q(e))).catch((()=>!1))}function to(e){return"string"!==typeof e||!e.length}function no(e){s.debug("JS SDK get() was called with the following configuration:",e);const t=!!V(),n=(0,u.d9)(e),o=[];if(n&&t)throw new Error(nt.CONFIG_SET);if(!t){if(!n||!Object.keys(n).length)throw new Error(nt.NO_CONFIG_OPTIONS);if(!n.clientId||"string"!==typeof n.clientId)throw new Error(nt.NO_CLIENT_ID);if(!n.responderPage)throw new Error(nt.NO_RESPONDER_PAGE);let e="";try{e=new URL(n.responderPage)}catch(e){throw new Error(`${nt.INVALID_ARGUMENT}: responderPage`)}const t=(0,u.KT)(window.location.hostname),c=(0,u.KT)(e.hostname);t!==c&&(s.warn("responder page domain does not match the top window domain. responder domain:",c),o.push("responderPage")),n.hasOwnProperty("langPref")&&(to(a=n.langPref)||!_.test(a))&&(s.warn("invalid config.langPref passed to get(config) - it is being ignored."),o.push("langPref"),delete n.langPref),n.cssOverride&&("string"!==typeof(i=n.cssOverride)||!i.startsWith("http")&&0!==i.length)&&(s.warn("invalid config.cssOverride passed to get(config) - it is being ignored."),o.push("cssOverride"),delete n.cssOverride),n.hasOwnProperty("experience")&&(to(r=n.experience)||!/^[A-Z0-9.\-_]+.EXP$/.test(r))&&(s.warn("invalid config.experience passed to get(config) - it is being ignored."),o.push("experience"),delete n.experience),f.test(n.clientId)&&(s.warn("passing environment as part of the Client ID is deprecated - it is being ignored."),o.push("clientId"),n.clientId=n.clientId.replace(f,"")),function(e){G=(0,u._A)((0,u.d9)({...M,...e}))}(n),Wn=(0,u._A)((0,u.d9)(n)),function(e){let t=(0,u.U2)(e,"optionalConfigs.reporting"),n=(0,u.U2)(e,"experience");t&&!we(t)&&(s.warn("optionalConfigs.reporting does not pass validation, values will be ignored"),t=null),n&&!Pe(n)&&(s.warn("experience does not pass validation, values will be ignored"),n=null),(t||n)&&(ge={reporting:t,...n&&{experience:n}})}(Wn),n.initialize&&$n(),o.length&&Le({[fe.ACTION_NAME]:fe.LOG_INVALID_OID_CONFIG,[fe.INFO]:o.join(",")})}var r,i,a;window.ONEID_WEB_SDK_MIGRATION&&(Hn.launchSocialRegistration=ao({preConditions:[Jn,Xn],method:so,actionName:fe.API_LAUNCH_SOCIAL_REGISTRATION}),Hn.getInlineNewsletters=oo,Hn.setInlineNewsletters=ro);const c=(0,u.d9)(Hn),{clientId:l}=V(),d=(0,u.U2)(V(),"debug.launchOTPEnabled")||!1,E=(0,u.U2)(V(),"debug.displayViewPreviewEnabled")||!1;return s.debug(`Is LaunchOTP Enabled ${d} for client-id ${l}?`),d||delete c.launchOTP,s.debug(`Is LaunchCustomFlow Enabled ${E} for client-id ${l}?`),E||delete c.displayViewPreview,S(wt.ERROR,(e=>s.error(e))),c}function oo(e,t){const n=ye(fe.API_GET_INLINE_NEWSLETTERS),o=`promotionId(${e})`;if(me(t),!Bn())return n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.NOT_INITIALIZED,[fe.INFO]:o}),De(wt.ERROR,nt.NOT_INITIALIZED),Promise.reject({data:{},error_codes:nt.NOT_INITIALIZED});const r=co(n,o,nt.INNER_APP_TIMEOUT),s=ve().then((t=>t?lt(t,e)?Promise.resolve():(n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.NO_VALID_CAMPAIGN,[fe.INFO]:o}),De(wt.ERROR,nt.NO_VALID_CAMPAIGN),Promise.reject({data:{},error_codes:Jt.NO_VALID_CAMPAIGN})):(n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.NO_SITE_CONFIG,[fe.INFO]:o}),De(wt.ERROR,nt.NO_SITE_CONFIG),Promise.reject({data:{},error_codes:nt.NO_SITE_CONFIG})))).then((()=>new Promise((n=>{Ln({name:"GET_INLINE_NEWSLETTERS",workflowOptions:_t(t,{promotionId:e}),onComplete:n})})))).then((()=>{const e=We("responsePayload");return e.error_codes&&e.error_codes.length>0?(n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:e.error_codes,[fe.INFO]:o}),De(wt.ERROR,e.error_codes),e.data={},Promise.reject(e)):Promise.resolve()}));return Promise.race([s,r]).then((()=>{r.cancel(),n.send({[fe.INFO]:o});const e=We("responsePayload");return Promise.resolve(e)}))}function ro(e,t){const n=ye(fe.API_SET_INLINE_NEWSLETTERS);if(me(t),!Bn())return n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.NOT_INITIALIZED}),De(wt.ERROR,nt.NOT_INITIALIZED),Promise.reject({data:{},error_codes:nt.NOT_INITIALIZED});if(!e)return n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.NO_DATA}),De(wt.ERROR,nt.NO_DATA),Promise.reject({data:{},error_codes:Jt.NO_DATA});const o=co(n,void 0,{data:{},error_codes:nt.INNER_APP_TIMEOUT}),r=ve().then((t=>t?lt(t,e.campaignId)?Promise.resolve():(n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:Jt.NO_VALID_CAMPAIGN}),Promise.reject({data:{},error_codes:Jt.NO_VALID_CAMPAIGN})):(n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.NO_SITE_CONFIG}),De(wt.ERROR,nt.NO_SITE_CONFIG),Promise.reject({data:{},error_codes:nt.NO_SITE_CONFIG})))).then((()=>new Promise((n=>{Ln({name:"SET_INLINE_NEWSLETTERS",workflowOptions:_t(t,{buData:e}),onComplete:n})})))).then((()=>{const e=We("responsePayload");return e.error_codes&&e.error_codes.length>0?(n.send({[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:e.error_codes}),De(wt.ERROR,e.error_codes),Promise.reject(e)):Promise.resolve(e)}));return Promise.race([r,o]).then((()=>{o.cancel();const e=We("responsePayload");return Promise.resolve(e)}))}function so(e){const[t]=e;me(t);const n=ut(),o=_t(t),r={name:zt.REGISTRATION,workflowOptions:o},s=(0,u.U2)(t,"optionalConfigs.providedProfile");s&&(r.guestChanges={profile:s});const i=dt().then((()=>ee.then((e=>{e.call("inner","runWorkflow",r)}))));return Promise.race([i,n]).then((()=>(n.cancel(),at.showLightbox(),Promise.resolve())))}function io(e){return(0,e[0])().then((()=>{if(e.shift(),e.length)return io(e)}))}function ao({preConditions:e=[()=>Promise.resolve()],method:t,actionName:n,newRelicFlowName:o,logInfoKey:r="",sendAfterPreconditions:s=!1}){return(...i)=>{const a=ye(n),c={};o&&(c[fe.FLOW]=o),r&&(c[fe.INFO]=`${r}(${i[0]})`);const l=new Promise(((n,o)=>{io((0,u.d9)(e)).then((()=>{s&&a.send(c),t(i).then((e=>{s||a.send(c),n(e)})).catch((({errorCategory:e,errorCodes:t})=>{s||a.send({[fe.ERROR_CATEGORY]:e||ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:t,...c}),De(wt.ERROR,t),o(t)}))})).catch((({errorCategory:e,errorCodes:t})=>{a.send({[fe.ERROR_CATEGORY]:e,[fe.ERROR_CODES]:t,...c}),De(wt.ERROR,t),o(t)}))}));if(window.ONEID_WEB_SDK_MIGRATION){const e=bn().defer();return l.then((t=>e.resolve(t))).catch((t=>e.reject(t))),e.promise}return l}}function co(e,t,n){let o;const r=new Promise(((r,s)=>{o=setTimeout((()=>{const o={[fe.ERROR_CATEGORY]:ot.FAILURE_BY_DESIGN,[fe.ERROR_CODES]:nt.INNER_APP_TIMEOUT};t&&(o[fe.INFO]=t),e.send(o),s(n)}),ue.LAUNCH_METHOD_TIMEOUT)}));return r.cancel=()=>(clearTimeout(o),this),r}function uo(e){if(!e)return null;const t=localStorage.getItem(e);try{const n=JSON.parse(t);if(!n._expiry)return n;const o=new Date(n._expiry);if(delete n._expiry,o>new Date)return n;localStorage.removeItem(e)}catch(e){return t}}function lo({key:e,value:t,expires:n}){const o=JSON.stringify({...t,_expiry:n},function(){const e=new Map;return(t,n)=>n?"object"!==typeof n?n:e.has(n)?void 0:(e.set(n,!0),n):n}());localStorage.setItem(e,o)}function Eo(){He("loggedIn",!0),Nn()}function _o(){He("loggedIn",!1)}function po({key:e,value:t,expires:n,secure:o=!1}){g(e,t,T.getCookieDomain(),"/",n,o)}window.ONEID_WEB_SDK_VERSION="4.3.215",window.ONEID_WEB_SDK_MIGRATION=!1,i(e[A(I.LOG_LEVEL)]||e.INFO),s.debug("MOUI (outer) initializing..."),ee.then((e=>{e.addHandler("ui.hideLightbox",at.hideLightbox),e.addHandler("ui.showLightbox",at.showLightbox),e.addHandler("init.setInitialized",xn),e.addHandler("get.localStorage",uo),e.addHandler("set.localStorage",lo),e.addHandler("get.cookie",A),e.addHandler("set.cookie",po),e.addHandler("newRelic.send",(e=>{Le({...e,...Ie})})),e.addHandler("api.callback",(e=>{const{name:t,...n}=e;C(t,n)})),e.addHandler("api.emitEvent",(({eventName:e,eventPayload:t,additionalInfo:n})=>De(e,t,n))),e.addHandler("guest.write",(e=>St(e,!0))),e.addHandler("guest.read",Rt),e.addHandler("session.loggedIn",Eo),e.addHandler("session.loggedOut",_o),e.addHandler("set.s2cookie",Ze)})),window.OneID||(window.OneID=qn),window.DisneyID||(window.DisneyID=Yn),function(e="outer"){const t="outer"===e?(document.querySelector('script[src*="/OneID.js"]')||document.querySelector('script[src*="/OneIDMigrate.js"]')||document.querySelector('script[src*="/DisneyID.js"]')||{}).src:window.location.href,n=!!document.querySelector('script[src*="/DisneyID.js"]'),{href:o,host:r}=new URL(t);ae=n?"outer"===e?o.replace(/^(.*)\/v2\/outer\/DisneyID\.js(?:.+)?/,"$1/v4"):o.split("/bundle")[0]:"outer"===e?o.replace(/^(.*)\/OneID(?:Migrate)?\.js/,"$1"):o.split("/bundle")[0],ne.test(r.toLowerCase())?ie=se.STG:oe.test(r.toLowerCase())?ie=se.QA:re.test(r.toLowerCase())&&(ie=se.VAL)}()})()})();